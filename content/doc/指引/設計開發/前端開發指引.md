# å‰ç«¯é–‹ç™¼æŒ‡å¼•

## æ–‡ä»¶è³‡è¨Š
- **ç‰ˆæœ¬**: 1.0.0
- **å»ºç«‹æ—¥æœŸ**: 2025-08-11
- **é©ç”¨å°ˆæ¡ˆ**: å¤§å‹é‡‘èç´š Web å°ˆæ¡ˆ
- **æŠ€è¡“æ£§**: Vue 3.x + TypeScript + Tailwind CSS

---

## ç›®éŒ„
1. [å°ˆæ¡ˆç›®éŒ„èˆ‡æª”æ¡ˆçµæ§‹è¦ç¯„](#1-å°ˆæ¡ˆç›®éŒ„èˆ‡æª”æ¡ˆçµæ§‹è¦ç¯„)
2. [å‘½åè¦ç¯„](#2-å‘½åè¦ç¯„)
3. [ç¨‹å¼æ’°å¯«é¢¨æ ¼èˆ‡ Lint è¨­å®š](#3-ç¨‹å¼æ’°å¯«é¢¨æ ¼èˆ‡-lint-è¨­å®š)
4. [å…ƒä»¶é–‹ç™¼è¦ç¯„](#4-å…ƒä»¶é–‹ç™¼è¦ç¯„)
5. [æ¨£å¼èˆ‡ Tailwind CSS è¦ç¯„](#5-æ¨£å¼èˆ‡-tailwind-css-è¦ç¯„)
6. [API ä¸²æ¥èˆ‡è³‡æ–™å­˜å–è¦ç¯„](#6-api-ä¸²æ¥èˆ‡è³‡æ–™å­˜å–è¦ç¯„)
7. [ç‹€æ…‹ç®¡ç†è¦ç¯„](#7-ç‹€æ…‹ç®¡ç†è¦ç¯„)
8. [å¤šèªç³»è™•ç†è¦ç¯„](#8-å¤šèªç³»è™•ç†è¦ç¯„)
9. [æ¸¬è©¦è¦ç¯„](#9-æ¸¬è©¦è¦ç¯„)
10. [å®‰å…¨æ€§è€ƒé‡](#10-å®‰å…¨æ€§è€ƒé‡)
11. [æ•ˆèƒ½å„ªåŒ–è¦ç¯„](#11-æ•ˆèƒ½å„ªåŒ–è¦ç¯„)
12. [ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„](#12-ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„)
13. [ç‰ˆæœ¬æ§åˆ¶èˆ‡åˆ†æ”¯ç­–ç•¥](#13-ç‰ˆæœ¬æ§åˆ¶èˆ‡åˆ†æ”¯ç­–ç•¥)
14. [å°ˆæ¡ˆå»ºç½®èˆ‡éƒ¨ç½²æµç¨‹](#14-å°ˆæ¡ˆå»ºç½®èˆ‡éƒ¨ç½²æµç¨‹)
15. [ç¨‹å¼ç¢¼å¯©æŸ¥è¦ç¯„](#15-ç¨‹å¼ç¢¼å¯©æŸ¥è¦ç¯„)
16. [å¸¸è¦‹éŒ¯èª¤è™•ç†èˆ‡ Debug æµç¨‹](#16-å¸¸è¦‹éŒ¯èª¤è™•ç†èˆ‡-debug-æµç¨‹)
17. [é–‹ç™¼å·¥å…·èˆ‡ç’°å¢ƒè¨­å®š](#17-é–‹ç™¼å·¥å…·èˆ‡ç’°å¢ƒè¨­å®š)
18. [åœ˜éšŠå”ä½œèˆ‡æºé€šè¦ç¯„](#18-åœ˜éšŠå”ä½œèˆ‡æºé€šè¦ç¯„)

---

## 1. å°ˆæ¡ˆç›®éŒ„èˆ‡æª”æ¡ˆçµæ§‹è¦ç¯„

### 1.1 æ¨™æº–å°ˆæ¡ˆçµæ§‹

```
frontend-project/
â”œâ”€â”€ public/                     # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ manifest.json
â”œâ”€â”€ src/                        # åŸå§‹ç¢¼
â”‚   â”œâ”€â”€ api/                    # API ç›¸é—œ
â”‚   â”‚   â”œâ”€â”€ modules/            # ä¾åŠŸèƒ½æ¨¡çµ„åˆ†é¡
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ interceptors/       # æ””æˆªå™¨
â”‚   â”‚   â””â”€â”€ types/              # API å‹åˆ¥å®šç¾©
â”‚   â”œâ”€â”€ assets/                 # éœæ…‹è³‡æº
â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ icons/
â”‚   â”‚   â””â”€â”€ fonts/
â”‚   â”œâ”€â”€ components/             # å…±ç”¨å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ base/               # åŸºç¤å…ƒä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ BaseButton.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ BaseInput.vue
â”‚   â”‚   â”‚   â””â”€â”€ BaseModal.vue
â”‚   â”‚   â”œâ”€â”€ business/           # æ¥­å‹™å…ƒä»¶
â”‚   â”‚   â””â”€â”€ layout/             # ç‰ˆé¢å…ƒä»¶
â”‚   â”‚       â”œâ”€â”€ Header.vue
â”‚   â”‚       â”œâ”€â”€ Sidebar.vue
â”‚   â”‚       â””â”€â”€ Footer.vue
â”‚   â”œâ”€â”€ composables/            # Vue 3 Composition API
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ useApi.ts
â”‚   â”‚   â””â”€â”€ useLocalStorage.ts
â”‚   â”œâ”€â”€ constants/              # å¸¸æ•¸å®šç¾©
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ routes.ts
â”‚   â”‚   â””â”€â”€ config.ts
â”‚   â”œâ”€â”€ directives/             # è‡ªå®šç¾©æŒ‡ä»¤
â”‚   â”œâ”€â”€ i18n/                   # å¤šèªç³»
â”‚   â”‚   â”œâ”€â”€ locales/
â”‚   â”‚   â”‚   â”œâ”€â”€ zh-TW.json
â”‚   â”‚   â”‚   â”œâ”€â”€ en-US.json
â”‚   â”‚   â”‚   â””â”€â”€ ja-JP.json
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ layouts/                # ç‰ˆé¢é…ç½®
â”‚   â”‚   â”œâ”€â”€ DefaultLayout.vue
â”‚   â”‚   â”œâ”€â”€ AuthLayout.vue
â”‚   â”‚   â””â”€â”€ EmptyLayout.vue
â”‚   â”œâ”€â”€ middleware/             # ä¸­é–“ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ permission.ts
â”‚   â”œâ”€â”€ pages/                  # é é¢å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ Login.vue
â”‚   â”‚   â”‚   â””â”€â”€ Register.vue
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ user/
â”‚   â”œâ”€â”€ plugins/                # æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ axios.ts
â”‚   â”‚   â”œâ”€â”€ i18n.ts
â”‚   â”‚   â””â”€â”€ router.ts
â”‚   â”œâ”€â”€ router/                 # è·¯ç”±è¨­å®š
â”‚   â”‚   â”œâ”€â”€ modules/            # è·¯ç”±æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ dashboard.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ stores/                 # Pinia ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ user.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ styles/                 # æ¨£å¼æª”æ¡ˆ
â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â”œâ”€â”€ variables.css
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”œâ”€â”€ types/                  # TypeScript å‹åˆ¥å®šç¾©
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â””â”€â”€ global.ts
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½å¼
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â””â”€â”€ storage.ts
â”‚   â”œâ”€â”€ App.vue                 # æ ¹å…ƒä»¶
â”‚   â””â”€â”€ main.ts                 # æ‡‰ç”¨ç¨‹å¼é€²å…¥é»
â”œâ”€â”€ tests/                      # æ¸¬è©¦æª”æ¡ˆ
â”‚   â”œâ”€â”€ unit/                   # å–®å…ƒæ¸¬è©¦
â”‚   â”œâ”€â”€ e2e/                    # E2E æ¸¬è©¦
â”‚   â””â”€â”€ __mocks__/              # Mock æª”æ¡ˆ
â”œâ”€â”€ .env                        # ç’°å¢ƒè®Šæ•¸
â”œâ”€â”€ .env.development
â”œâ”€â”€ .env.production
â”œâ”€â”€ .eslintrc.js                # ESLint è¨­å®š
â”œâ”€â”€ .prettierrc                 # Prettier è¨­å®š
â”œâ”€â”€ tailwind.config.js          # Tailwind CSS è¨­å®š
â”œâ”€â”€ vite.config.ts              # Vite è¨­å®š
â”œâ”€â”€ tsconfig.json               # TypeScript è¨­å®š
â””â”€â”€ package.json                # å¥—ä»¶ç®¡ç†
```

### 1.2 æª”æ¡ˆå‘½ååŸå‰‡

#### æª”æ¡ˆé¡å‹å°æ‡‰å‘½åæ–¹å¼
- **Vue å…ƒä»¶**: PascalCase (å¦‚ `UserProfile.vue`)
- **TypeScript æª”æ¡ˆ**: camelCase (å¦‚ `userService.ts`)
- **CSS/SCSS æª”æ¡ˆ**: kebab-case (å¦‚ `user-profile.scss`)
- **æ¸¬è©¦æª”æ¡ˆ**: èˆ‡è¢«æ¸¬æª”æ¡ˆåŒå + `.test` æˆ– `.spec` (å¦‚ `UserProfile.test.ts`)
- **å‹åˆ¥å®šç¾©æª”æ¡ˆ**: camelCase + `.d.ts` (å¦‚ `userTypes.d.ts`)

#### ç‰¹æ®Šæª”æ¡ˆå‘½å
- **é é¢å…ƒä»¶**: PascalCaseï¼Œé€šå¸¸ä»¥é é¢åŠŸèƒ½å‘½å (å¦‚ `UserManagement.vue`)
- **Layout å…ƒä»¶**: PascalCase + Layout å¾Œç¶´ (å¦‚ `DashboardLayout.vue`)
- **Store æª”æ¡ˆ**: camelCaseï¼Œä»¥æ¥­å‹™é ˜åŸŸå‘½å (å¦‚ `userStore.ts`)
- **API æª”æ¡ˆ**: camelCaseï¼Œä»¥ API æœå‹™å‘½å (å¦‚ `userApi.ts`)

---

## 2. å‘½åè¦ç¯„

### 2.1 æª”æ¡ˆèˆ‡è³‡æ–™å¤¾å‘½å

#### è³‡æ–™å¤¾å‘½å
- ä½¿ç”¨ **kebab-case** (å°å¯«å­—æ¯ + é€£å­—è™Ÿ)
- åç¨±æ‡‰ç°¡æ½”ä¸”å…·æè¿°æ€§

```
âœ… æ­£ç¢ºç¯„ä¾‹
user-management/
auth-service/
api-client/

âŒ éŒ¯èª¤ç¯„ä¾‹
UserManagement/
authService/
API_Client/
```

#### æª”æ¡ˆå‘½å
- **Vue å…ƒä»¶æª”æ¡ˆ**: PascalCase
- **JavaScript/TypeScript æª”æ¡ˆ**: camelCase
- **æ¨£å¼æª”æ¡ˆ**: kebab-case
- **è¨­å®šæª”æ¡ˆ**: kebab-case æˆ– camelCase (ä¾æ…£ä¾‹)

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹
UserProfile.vue
userService.ts
user-profile.scss
vite.config.ts

// âŒ éŒ¯èª¤ç¯„ä¾‹
userprofile.vue
UserService.ts
user_profile.scss
vite_config.ts
```

### 2.2 è®Šæ•¸èˆ‡å‡½å¼å‘½å

#### JavaScript/TypeScript è®Šæ•¸
- ä½¿ç”¨ **camelCase**
- å¸¸æ•¸ä½¿ç”¨ **UPPER_SNAKE_CASE**
- ç§æœ‰è®Šæ•¸ä»¥ `_` é–‹é ­
- å¸ƒæ—å€¼è®Šæ•¸ä½¿ç”¨ `is`ã€`has`ã€`can`ã€`should` ç­‰å‰ç¶´

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹
const userName = 'John Doe';
const API_BASE_URL = 'https://api.example.com';
const _privateVariable = 'private';
const isLoggedIn = true;
const hasPermission = false;
const canEdit = true;
const shouldUpdate = false;

// âŒ éŒ¯èª¤ç¯„ä¾‹
const user_name = 'John Doe';
const apiBaseUrl = 'https://api.example.com'; // å¸¸æ•¸æ‡‰ä½¿ç”¨å¤§å¯«
const privateVariable = 'private'; // ç§æœ‰è®Šæ•¸ç¼ºå°‘å‰ç¶´
const loggedIn = true; // å¸ƒæ—å€¼ç¼ºå°‘å‰ç¶´
```

#### å‡½å¼å‘½å
- ä½¿ç”¨ **camelCase**
- å‹•è©é–‹é ­ï¼Œæè¿°å‡½å¼çš„å‹•ä½œ
- äº‹ä»¶è™•ç†å™¨ä½¿ç”¨ `handle` å‰ç¶´
- å–å¾—è³‡æ–™ä½¿ç”¨ `get`ã€`fetch` å‰ç¶´
- è¨­å®šè³‡æ–™ä½¿ç”¨ `set`ã€`update` å‰ç¶´

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹
function getUserData() { }
function handleButtonClick() { }
function validateEmail() { }
function formatCurrency() { }
function updateUserProfile() { }
function fetchUserList() { }

// âŒ éŒ¯èª¤ç¯„ä¾‹
function userData() { } // ç¼ºå°‘å‹•è©
function buttonClick() { } // äº‹ä»¶è™•ç†å™¨ç¼ºå°‘ handle å‰ç¶´
function email() { } // ä¸æ˜ç¢ºçš„å‘½å
function currency() { } // ä¸æ˜ç¢ºçš„å‘½å
```

### 2.3 Vue å…ƒä»¶å‘½å

#### å…ƒä»¶åç¨±
- ä½¿ç”¨ **PascalCase**
- å¤šå€‹å–®å­—çµ„åˆï¼Œé¿å…å–®ä¸€å–®å­—
- åŸºç¤å…ƒä»¶ä½¿ç”¨ `Base` å‰ç¶´
- æ¥­å‹™å…ƒä»¶ä½¿ç”¨å…·é«”çš„æ¥­å‹™é ˜åŸŸå‘½å

```vue
<!-- âœ… æ­£ç¢ºç¯„ä¾‹ -->
<script setup lang="ts">
// å…ƒä»¶æª”æ¡ˆ: UserProfile.vue
</script>

<script setup lang="ts">
// å…ƒä»¶æª”æ¡ˆ: BaseButton.vue
</script>

<script setup lang="ts">
// å…ƒä»¶æª”æ¡ˆ: PaymentForm.vue
</script>

<!-- âŒ éŒ¯èª¤ç¯„ä¾‹ -->
<script setup lang="ts">
// å…ƒä»¶æª”æ¡ˆ: user.vue - å‘½åå¤ªç°¡çŸ­
</script>

<script setup lang="ts">
// å…ƒä»¶æª”æ¡ˆ: button.vue - æ‡‰ä½¿ç”¨ BaseButton
</script>
```

#### Props å‘½å
- å®šç¾©æ™‚ä½¿ç”¨ **camelCase**
- HTML æ¨¡æ¿ä¸­ä½¿ç”¨ **kebab-case**

```vue
<script setup lang="ts">
// âœ… æ­£ç¢ºç¯„ä¾‹
interface Props {
  userName: string;
  isVisible: boolean;
  maxLength?: number;
}

const props = withDefaults(defineProps<Props>(), {
  maxLength: 100
});
</script>

<template>
  <!-- HTML æ¨¡æ¿ä¸­ä½¿ç”¨ kebab-case -->
  <UserProfile
    :user-name="currentUser"
    :is-visible="showProfile"
    :max-length="200"
  />
</template>
```

#### Event å‘½å
- ä½¿ç”¨ **kebab-case**
- å‹•è©é–‹é ­ï¼Œæè¿°äº‹ä»¶çš„å‹•ä½œ

```vue
<script setup lang="ts">
// âœ… æ­£ç¢ºç¯„ä¾‹
const emit = defineEmits<{
  'update:modelValue': [value: string];
  'user-created': [user: User];
  'form-submitted': [data: FormData];
  'item-selected': [item: Item];
}>();

// è§¸ç™¼äº‹ä»¶
emit('user-created', newUser);
emit('form-submitted', formData);
</script>
```

---

## 3. ç¨‹å¼æ’°å¯«é¢¨æ ¼èˆ‡ Lint è¨­å®š

### 3.1 ESLint è¨­å®š

#### eslint.config.js ç¯„ä¾‹

```javascript
import { defineConfig } from 'eslint-define-config';
import vue from 'eslint-plugin-vue';
import typescript from '@typescript-eslint/eslint-plugin';
import typescriptParser from '@typescript-eslint/parser';
import prettier from 'eslint-plugin-prettier';

export default defineConfig([
  {
    files: ['**/*.{js,ts,vue}'],
    languageOptions: {
      parser: typescriptParser,
      parserOptions: {
        ecmaVersion: 2022,
        sourceType: 'module',
        extraFileExtensions: ['.vue']
      }
    },
    plugins: {
      vue,
      '@typescript-eslint': typescript,
      prettier
    },
    rules: {
      // Vue è¦å‰‡
      'vue/multi-word-component-names': 'error',
      'vue/component-name-in-template-casing': ['error', 'PascalCase'],
      'vue/no-unused-vars': 'error',
      'vue/no-multiple-template-root': 'off', // Vue 3 æ”¯æ´å¤šå€‹æ ¹å…ƒç´ 
      'vue/script-setup-uses-vars': 'error',
      
      // TypeScript è¦å‰‡
      '@typescript-eslint/no-unused-vars': 'error',
      '@typescript-eslint/no-explicit-any': 'warn',
      '@typescript-eslint/explicit-function-return-type': 'off',
      '@typescript-eslint/no-non-null-assertion': 'warn',
      
      // é€šç”¨è¦å‰‡
      'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'warn',
      'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'warn',
      'prefer-const': 'error',
      'no-var': 'error',
      'object-shorthand': 'error',
      'prefer-template': 'error',
      
      // Prettier è¦å‰‡
      'prettier/prettier': 'error'
    }
  }
]);
```

### 3.2 Prettier è¨­å®š

#### .prettierrc ç¯„ä¾‹

```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false,
  "bracketSpacing": true,
  "bracketSameLine": false,
  "arrowParens": "avoid",
  "endOfLine": "lf",
  "vueIndentScriptAndStyle": true,
  "htmlWhitespaceSensitivity": "css"
}
```

### 3.3 TypeScript æ’°å¯«è¦ç¯„

#### å‹åˆ¥å®šç¾©è¦ç¯„

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - ä½¿ç”¨ interface å®šç¾©ç‰©ä»¶å‹åˆ¥
interface User {
  id: number;
  name: string;
  email: string;
  isActive: boolean;
  createdAt: Date;
  updatedAt?: Date; // é¸æ“‡æ€§å±¬æ€§
}

// âœ… æ­£ç¢ºç¯„ä¾‹ - ä½¿ç”¨ type å®šç¾©è¯åˆå‹åˆ¥
type Status = 'pending' | 'approved' | 'rejected';
type Theme = 'light' | 'dark' | 'auto';

// âœ… æ­£ç¢ºç¯„ä¾‹ - æ³›å‹ä½¿ç”¨
interface ApiResponse<T> {
  data: T;
  message: string;
  success: boolean;
  code: number;
}

// âœ… æ­£ç¢ºç¯„ä¾‹ - å‡½å¼å‹åˆ¥å®šç¾©
type EventHandler<T = Event> = (event: T) => void;
type AsyncFunction<T> = () => Promise<T>;
```

#### å‡½å¼æ’°å¯«è¦ç¯„

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - æ˜ç¢ºçš„åƒæ•¸å’Œå›å‚³å‹åˆ¥
async function fetchUserData(userId: number): Promise<User | null> {
  try {
    const response = await api.get<ApiResponse<User>>(`/users/${userId}`);
    return response.data.data;
  } catch (error) {
    console.error('Failed to fetch user data:', error);
    return null;
  }
}

// âœ… æ­£ç¢ºç¯„ä¾‹ - ç®­é ­å‡½å¼èˆ‡å‹åˆ¥æ¨æ–·
const formatCurrency = (amount: number, currency = 'TWD'): string => {
  return new Intl.NumberFormat('zh-TW', {
    style: 'currency',
    currency,
  }).format(amount);
};

// âœ… æ­£ç¢ºç¯„ä¾‹ - é«˜éšå‡½å¼
const createValidator = <T>(
  validator: (value: T) => boolean,
  errorMessage: string
) => {
  return (value: T): ValidationResult => ({
    isValid: validator(value),
    message: validator(value) ? '' : errorMessage,
  });
};
```

### 3.4 Vue 3 Composition API æ’°å¯«è¦ç¯„

#### `<script setup>` çµæ§‹è¦ç¯„

```vue
<script setup lang="ts">
// 1. å°å…¥ Vue ç›¸é—œ API
import { ref, computed, watch, onMounted } from 'vue';

// 2. å°å…¥ Composables
import { useAuth } from '@/composables/useAuth';
import { useApi } from '@/composables/useApi';

// 3. å°å…¥å…¶ä»–æ¨¡çµ„
import { formatDate } from '@/utils/format';
import type { User } from '@/types/user';

// 4. å®šç¾© Props ä»‹é¢
interface Props {
  userId: number;
  isEditable?: boolean;
}

// 5. å®šç¾© Emits ä»‹é¢
interface Emits {
  'user-updated': [user: User];
  'error': [error: string];
}

// 6. å®£å‘Š Props å’Œ Emits
const props = withDefaults(defineProps<Props>(), {
  isEditable: false,
});

const emit = defineEmits<Emits>();

// 7. éŸ¿æ‡‰å¼è³‡æ–™
const user = ref<User | null>(null);
const loading = ref(false);
const error = ref<string>('');

// 8. è¨ˆç®—å±¬æ€§
const displayName = computed(() => {
  return user.value ? `${user.value.firstName} ${user.value.lastName}` : '';
});

const canEdit = computed(() => {
  return props.isEditable && user.value?.isActive;
});

// 9. ç›£è½å™¨
watch(
  () => props.userId,
  async (newUserId) => {
    if (newUserId) {
      await loadUser();
    }
  },
  { immediate: true }
);

// 10. æ–¹æ³•
const loadUser = async (): Promise<void> => {
  loading.value = true;
  error.value = '';
  
  try {
    const userData = await fetchUserData(props.userId);
    user.value = userData;
  } catch (err) {
    error.value = 'è¼‰å…¥ä½¿ç”¨è€…è³‡æ–™å¤±æ•—';
    emit('error', error.value);
  } finally {
    loading.value = false;
  }
};

const updateUser = async (userData: Partial<User>): Promise<void> => {
  if (!user.value) return;
  
  try {
    const updatedUser = await updateUserData(user.value.id, userData);
    user.value = updatedUser;
    emit('user-updated', updatedUser);
  } catch (err) {
    error.value = 'æ›´æ–°ä½¿ç”¨è€…è³‡æ–™å¤±æ•—';
    emit('error', error.value);
  }
};

// 11. ç”Ÿå‘½é€±æœŸé‰¤å­
onMounted(() => {
  console.log('Component mounted');
});

// 12. æš´éœ²çµ¦çˆ¶å…ƒä»¶çš„æ–¹æ³•/å±¬æ€§ (å¦‚éœ€è¦)
defineExpose({
  loadUser,
  updateUser,
});
</script>
```

### 3.5 ç¨‹å¼ç¢¼å“è³ªè¦ç¯„

#### è¨»è§£æ’°å¯«è¦ç¯„

```typescript
/**
 * ä½¿ç”¨è€…è³‡æ–™æœå‹™é¡åˆ¥
 * 
 * æä¾›ä½¿ç”¨è€…ç›¸é—œçš„ API æ“ä½œæ–¹æ³•ï¼ŒåŒ…å«ï¼š
 * - å–å¾—ä½¿ç”¨è€…è³‡æ–™
 * - æ›´æ–°ä½¿ç”¨è€…è³‡æ–™
 * - åˆªé™¤ä½¿ç”¨è€…
 * 
 * @example
 * ```typescript
 * const userService = new UserService();
 * const user = await userService.getUser(123);
 * ```
 */
export class UserService {
  /**
   * æ ¹æ“š ID å–å¾—ä½¿ç”¨è€…è³‡æ–™
   * 
   * @param userId - ä½¿ç”¨è€… ID
   * @returns ä½¿ç”¨è€…è³‡æ–™ï¼Œå¦‚æœæ‰¾ä¸åˆ°å‰‡å›å‚³ null
   * @throws {ApiError} ç•¶ API è«‹æ±‚å¤±æ•—æ™‚æ‹‹å‡ºéŒ¯èª¤
   * 
   * @example
   * ```typescript
   * const user = await userService.getUser(123);
   * if (user) {
   *   console.log(user.name);
   * }
   * ```
   */
  async getUser(userId: number): Promise<User | null> {
    // TODO: å¯¦ä½œå¿«å–æ©Ÿåˆ¶
    // FIXME: è™•ç†ç¶²è·¯éŒ¯èª¤é‡è©¦é‚è¼¯
    
    try {
      const response = await this.api.get(`/users/${userId}`);
      return response.data;
    } catch (error) {
      // è¨˜éŒ„éŒ¯èª¤ä½†ä¸æ‹‹å‡ºï¼Œè®“å‘¼å«æ–¹æ±ºå®šå¦‚ä½•è™•ç†
      console.error(`Failed to fetch user ${userId}:`, error);
      return null;
    }
  }
}
```

#### éŒ¯èª¤è™•ç†è¦ç¯„

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - çµ±ä¸€çš„éŒ¯èª¤è™•ç†
export class ApiError extends Error {
  constructor(
    message: string,
    public status: number,
    public code?: string
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

// âœ… æ­£ç¢ºç¯„ä¾‹ - éŒ¯èª¤é‚Šç•Œè™•ç†
const handleApiError = (error: unknown): never => {
  if (error instanceof ApiError) {
    switch (error.status) {
      case 401:
        // é‡æ–°å°å‘åˆ°ç™»å…¥é é¢
        router.push('/login');
        break;
      case 403:
        // é¡¯ç¤ºæ¬Šé™ä¸è¶³è¨Šæ¯
        showErrorMessage('æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ');
        break;
      case 500:
        // é¡¯ç¤ºä¼ºæœå™¨éŒ¯èª¤è¨Šæ¯
        showErrorMessage('ä¼ºæœå™¨ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
        break;
      default:
        showErrorMessage(error.message);
    }
  } else {
    // æœªçŸ¥éŒ¯èª¤
    console.error('Unexpected error:', error);
    showErrorMessage('ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤');
  }
  
  throw error;
};
```

---

## 4. å…ƒä»¶é–‹ç™¼è¦ç¯„

### 4.1 Vue å–®æª”å…ƒä»¶ (SFC) çµæ§‹

#### æ¨™æº– SFC çµæ§‹é †åº

```vue
<!-- 1. æ¨¡æ¿å€åŸŸ -->
<template>
  <div class="user-profile">
    <!-- å…§å®¹ -->
  </div>
</template>

<!-- 2. é‚è¼¯å€åŸŸ -->
<script setup lang="ts">
// é‚è¼¯ä»£ç¢¼
</script>

<!-- 3. æ¨£å¼å€åŸŸ -->
<style scoped lang="scss">
// æ¨£å¼ä»£ç¢¼
</style>
```

#### å®Œæ•´å…ƒä»¶ç¯„ä¾‹

```vue
<template>
  <div class="user-card" :class="cardClasses">
    <!-- é ­åƒå€åŸŸ -->
    <div class="user-card__avatar">
      <img
        :src="user.avatar || defaultAvatar"
        :alt="`${user.name} çš„é ­åƒ`"
        class="user-card__avatar-img"
        @error="handleImageError"
      />
      <div v-if="showStatus" class="user-card__status" :class="statusClass">
        {{ statusText }}
      </div>
    </div>

    <!-- ä½¿ç”¨è€…è³‡è¨Š -->
    <div class="user-card__content">
      <h3 class="user-card__name">{{ user.name }}</h3>
      <p class="user-card__email">{{ user.email }}</p>
      
      <!-- æ¨™ç±¤ -->
      <div v-if="user.tags?.length" class="user-card__tags">
        <span
          v-for="tag in user.tags"
          :key="tag"
          class="user-card__tag"
        >
          {{ tag }}
        </span>
      </div>

      <!-- å‹•ä½œæŒ‰éˆ• -->
      <div class="user-card__actions">
        <BaseButton
          variant="primary"
          size="small"
          :disabled="loading"
          @click="handleEdit"
        >
          ç·¨è¼¯
        </BaseButton>
        <BaseButton
          variant="secondary"
          size="small"
          :disabled="loading"
          @click="handleView"
        >
          æŸ¥çœ‹
        </BaseButton>
      </div>
    </div>

    <!-- è¼‰å…¥ç‹€æ…‹ -->
    <div v-if="loading" class="user-card__loading">
      <LoadingSpinner size="small" />
    </div>
  </div>
</template>

<script setup lang="ts">
import { computed, ref } from 'vue';
import BaseButton from '@/components/base/BaseButton.vue';
import LoadingSpinner from '@/components/base/LoadingSpinner.vue';
import { useI18n } from 'vue-i18n';
import type { User } from '@/types/user';

// Props å®šç¾©
interface Props {
  user: User;
  variant?: 'default' | 'compact' | 'detailed';
  showStatus?: boolean;
  interactive?: boolean;
}

// Emits å®šç¾©
interface Emits {
  edit: [user: User];
  view: [user: User];
  'avatar-error': [user: User];
}

const props = withDefaults(defineProps<Props>(), {
  variant: 'default',
  showStatus: true,
  interactive: true,
});

const emit = defineEmits<Emits>();

// Composables
const { t } = useI18n();

// éŸ¿æ‡‰å¼è³‡æ–™
const loading = ref(false);
const defaultAvatar = '/images/default-avatar.png';

// è¨ˆç®—å±¬æ€§
const cardClasses = computed(() => ({
  [`user-card--${props.variant}`]: true,
  'user-card--interactive': props.interactive,
  'user-card--loading': loading.value,
}));

const statusClass = computed(() => ({
  'user-card__status--online': props.user.isOnline,
  'user-card__status--offline': !props.user.isOnline,
}));

const statusText = computed(() => {
  return props.user.isOnline ? t('common.online') : t('common.offline');
});

// æ–¹æ³•
const handleEdit = (): void => {
  if (!props.interactive || loading.value) return;
  emit('edit', props.user);
};

const handleView = (): void => {
  if (!props.interactive || loading.value) return;
  emit('view', props.user);
};

const handleImageError = (): void => {
  emit('avatar-error', props.user);
};
</script>

<style scoped lang="scss">
.user-card {
  @apply bg-white rounded-lg shadow-md p-4 transition-all duration-200;

  &--interactive {
    @apply hover:shadow-lg cursor-pointer;
  }

  &--loading {
    @apply opacity-50 pointer-events-none;
  }

  &__avatar {
    @apply relative flex-shrink-0;
  }

  &__avatar-img {
    @apply w-12 h-12 rounded-full object-cover;
  }

  &__status {
    @apply absolute -bottom-1 -right-1 px-2 py-1 text-xs rounded-full text-white;

    &--online {
      @apply bg-green-500;
    }

    &--offline {
      @apply bg-gray-400;
    }
  }

  &__content {
    @apply flex-1 ml-4;
  }

  &__name {
    @apply text-lg font-semibold text-gray-900 mb-1;
  }

  &__email {
    @apply text-sm text-gray-600 mb-2;
  }

  &__tags {
    @apply flex flex-wrap gap-1 mb-3;
  }

  &__tag {
    @apply px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded;
  }

  &__actions {
    @apply flex gap-2;
  }

  &__loading {
    @apply absolute inset-0 flex items-center justify-center bg-white bg-opacity-75;
  }

  // è®Šé«”æ¨£å¼
  &--compact {
    @apply p-2;

    .user-card__avatar-img {
      @apply w-8 h-8;
    }

    .user-card__name {
      @apply text-base;
    }
  }

  &--detailed {
    @apply p-6;

    .user-card__avatar-img {
      @apply w-16 h-16;
    }
  }
}
</style>
```

### 4.2 Props è¨­è¨ˆè¦ç¯„

#### Props å‹åˆ¥å®šç¾©

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - å®Œæ•´çš„ Props ä»‹é¢
interface ButtonProps {
  // å¿…è¦å±¬æ€§
  label: string;
  
  // é¸æ“‡æ€§å±¬æ€§with default values
  variant?: 'primary' | 'secondary' | 'danger' | 'ghost';
  size?: 'small' | 'medium' | 'large';
  disabled?: boolean;
  loading?: boolean;
  
  // è¤‡é›œå‹åˆ¥
  icon?: {
    name: string;
    position: 'left' | 'right';
  };
  
  // å‡½å¼å‹åˆ¥
  onClick?: (event: MouseEvent) => void;
}

const props = withDefaults(defineProps<ButtonProps>(), {
  variant: 'primary',
  size: 'medium',
  disabled: false,
  loading: false,
});
```

#### Props é©—è­‰

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - åŸ·è¡Œæ™‚é©—è­‰
interface FormInputProps {
  modelValue: string;
  type?: 'text' | 'email' | 'password' | 'number';
  placeholder?: string;
  required?: boolean;
  maxLength?: number;
  pattern?: string;
  validator?: (value: string) => boolean | string;
}

const props = withDefaults(defineProps<FormInputProps>(), {
  type: 'text',
  required: false,
});

// è‡ªå®šç¾©é©—è­‰é‚è¼¯
const isValid = computed(() => {
  if (props.required && !props.modelValue) {
    return false;
  }
  
  if (props.maxLength && props.modelValue.length > props.maxLength) {
    return false;
  }
  
  if (props.pattern && !new RegExp(props.pattern).test(props.modelValue)) {
    return false;
  }
  
  if (props.validator) {
    const result = props.validator(props.modelValue);
    return result === true;
  }
  
  return true;
});
```

### 4.3 Emits äº‹ä»¶è¦ç¯„

#### äº‹ä»¶å®šç¾©èˆ‡è§¸ç™¼

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹ - å‹åˆ¥å®‰å…¨çš„äº‹ä»¶å®šç¾©
interface FormEmits {
  // v-model é›™å‘ç¶å®š
  'update:modelValue': [value: string];
  
  // è¡¨å–®äº‹ä»¶
  submit: [data: FormData];
  cancel: [];
  
  // é©—è­‰äº‹ä»¶
  'validation-error': [errors: ValidationError[]];
  'validation-success': [];
  
  // ä½¿ç”¨è€…äº’å‹•äº‹ä»¶
  'field-focus': [fieldName: string];
  'field-blur': [fieldName: string, value: string];
}

const emit = defineEmits<FormEmits>();

// äº‹ä»¶è§¸ç™¼ç¯„ä¾‹
const handleSubmit = (formData: FormData): void => {
  // é©—è­‰è¡¨å–®
  const errors = validateForm(formData);
  
  if (errors.length > 0) {
    emit('validation-error', errors);
    return;
  }
  
  emit('validation-success');
  emit('submit', formData);
};

const handleCancel = (): void => {
  emit('cancel');
};

// v-model å¯¦ä½œ
const updateValue = (newValue: string): void => {
  emit('update:modelValue', newValue);
};
```

### 4.4 Slots ä½¿ç”¨è¦ç¯„

#### å…·åæ’æ§½è¨­è¨ˆ

```vue
<template>
  <div class="card">
    <!-- æ¨™é¡Œæ’æ§½ -->
    <header v-if="$slots.header" class="card__header">
      <slot name="header" :title="title" :subtitle="subtitle" />
    </header>

    <!-- é è¨­å…§å®¹æ’æ§½ -->
    <main class="card__content">
      <slot :data="data" :loading="loading" />
    </main>

    <!-- å‹•ä½œæŒ‰éˆ•æ’æ§½ -->
    <footer v-if="$slots.actions" class="card__actions">
      <slot
        name="actions"
        :save="handleSave"
        :cancel="handleCancel"
        :canSave="canSave"
      />
    </footer>

    <!-- æ¢ä»¶å¼æ’æ§½ -->
    <div v-if="$slots.sidebar" class="card__sidebar">
      <slot name="sidebar" />
    </div>
  </div>
</template>

<script setup lang="ts">
interface Props {
  title?: string;
  subtitle?: string;
  data: any;
  loading?: boolean;
}

const props = defineProps<Props>();

// è¨ˆç®—å±¬æ€§
const canSave = computed(() => {
  return !props.loading && isDataValid(props.data);
});

// æä¾›çµ¦æ’æ§½çš„æ–¹æ³•
const handleSave = (): void => {
  // å„²å­˜é‚è¼¯
};

const handleCancel = (): void => {
  // å–æ¶ˆé‚è¼¯
};
</script>
```

#### æ’æ§½ä½¿ç”¨ç¯„ä¾‹

```vue
<template>
  <Card :data="userData" :loading="loading">
    <!-- æ¨™é¡Œæ’æ§½ -->
    <template #header="{ title, subtitle }">
      <h2>{{ title || 'ä½¿ç”¨è€…è³‡æ–™' }}</h2>
      <p v-if="subtitle">{{ subtitle }}</p>
    </template>

    <!-- é è¨­å…§å®¹æ’æ§½ -->
    <template #default="{ data, loading }">
      <div v-if="!loading">
        <UserForm :user="data" @update="handleUserUpdate" />
      </div>
      <LoadingSpinner v-else />
    </template>

    <!-- å‹•ä½œæ’æ§½ -->
    <template #actions="{ save, cancel, canSave }">
      <BaseButton
        variant="primary"
        :disabled="!canSave"
        @click="save"
      >
        å„²å­˜
      </BaseButton>
      <BaseButton
        variant="secondary"
        @click="cancel"
      >
        å–æ¶ˆ
      </BaseButton>
    </template>
  </Card>
</template>
```

### 4.5 å…ƒä»¶çµ„åˆèˆ‡è¤‡ç”¨

#### é«˜éšå…ƒä»¶ (HOC) æ¨¡å¼

```vue
<!-- withLoading.vue - é«˜éšå…ƒä»¶ -->
<template>
  <div class="with-loading">
    <div v-if="loading" class="loading-overlay">
      <LoadingSpinner :size="loadingSize" />
      <p v-if="loadingText">{{ loadingText }}</p>
    </div>
    
    <div :class="{ 'is-loading': loading }">
      <slot :loading="loading" />
    </div>
  </div>
</template>

<script setup lang="ts">
interface Props {
  loading: boolean;
  loadingText?: string;
  loadingSize?: 'small' | 'medium' | 'large';
}

withDefaults(defineProps<Props>(), {
  loadingSize: 'medium',
});
</script>
```

#### çµ„åˆå¼å…ƒä»¶ä½¿ç”¨

```vue
<template>
  <WithLoading :loading="isLoading" loading-text="è¼‰å…¥ä½¿ç”¨è€…è³‡æ–™ä¸­...">
    <UserProfile
      :user="userData"
      @edit="handleEdit"
      @delete="handleDelete"
    />
  </WithLoading>
</template>

<script setup lang="ts">
import WithLoading from '@/components/hoc/WithLoading.vue';
import UserProfile from '@/components/UserProfile.vue';

const isLoading = ref(false);
const userData = ref(null);

const handleEdit = (user: User): void => {
  // ç·¨è¼¯é‚è¼¯
};

const handleDelete = (user: User): void => {
  // åˆªé™¤é‚è¼¯
};
</script>
```

---

## 5. æ¨£å¼èˆ‡ Tailwind CSS è¦ç¯„

### 5.1 Tailwind CSS è¨­å®š

#### tailwind.config.js ç¯„ä¾‹

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    './index.html',
    './src/**/*.{vue,js,ts,jsx,tsx}',
  ],
  theme: {
    extend: {
      // é¡è‰²ç³»çµ±
      colors: {
        primary: {
          50: '#eff6ff',
          100: '#dbeafe',
          200: '#bfdbfe',
          300: '#93c5fd',
          400: '#60a5fa',
          500: '#3b82f6', // ä¸»è¦å“ç‰Œè‰²
          600: '#2563eb',
          700: '#1d4ed8',
          800: '#1e40af',
          900: '#1e3a8a',
          950: '#172554',
        },
        secondary: {
          50: '#f8fafc',
          500: '#64748b',
          900: '#0f172a',
        },
        success: {
          50: '#f0fdf4',
          500: '#22c55e',
          900: '#14532d',
        },
        warning: {
          50: '#fffbeb',
          500: '#f59e0b',
          900: '#78350f',
        },
        danger: {
          50: '#fef2f2',
          500: '#ef4444',
          900: '#7f1d1d',
        },
      },
      
      // å­—å‹è¨­å®š
      fontFamily: {
        sans: [
          'Noto Sans TC',
          'Microsoft JhengHei',
          'PingFang TC',
          'Helvetica Neue',
          'Arial',
          'sans-serif',
        ],
      },
      
      // éŸ¿æ‡‰å¼æ–·é»
      screens: {
        'xs': '475px',
        'sm': '640px',
        'md': '768px',
        'lg': '1024px',
        'xl': '1280px',
        '2xl': '1536px',
      },
    },
  },
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography'),
  ],
};
```

### 5.2 RWD éŸ¿æ‡‰å¼è¨­è¨ˆåŸå‰‡

#### Mobile-First è¨­è¨ˆç­–ç•¥

```vue
<template>
  <!-- éŸ¿æ‡‰å¼ç¶²æ ¼ç³»çµ± -->
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      <div v-for="item in items" :key="item.id" class="card">
        <!-- éŸ¿æ‡‰å¼åœ–ç‰‡ -->
        <img
          :src="item.image"
          :alt="item.title"
          class="w-full h-32 sm:h-40 lg:h-48 object-cover"
        />
        
        <!-- éŸ¿æ‡‰å¼æ–‡å­— -->
        <div class="p-4">
          <h3 class="text-lg sm:text-xl lg:text-2xl font-semibold">
            {{ item.title }}
          </h3>
          <p class="text-sm sm:text-base text-gray-600">
            {{ item.description }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- éŸ¿æ‡‰å¼å°èˆª -->
  <nav class="bg-white shadow">
    <!-- æ¡Œé¢ç‰ˆå°èˆª -->
    <div class="hidden lg:flex items-center space-x-8 px-6 py-4">
      <a v-for="link in navLinks" :key="link.path" :href="link.path">
        {{ link.title }}
      </a>
    </div>
    
    <!-- è¡Œå‹•ç‰ˆé¸å–® -->
    <div class="lg:hidden">
      <button @click="toggleMobileMenu" class="p-4">
        <MenuIcon class="w-6 h-6" />
      </button>
    </div>
  </nav>
</template>
```

### 5.3 é¡è‰²èˆ‡ä¸»é¡Œè¨­è¨ˆ

#### CSS è®Šæ•¸ä¸»é¡Œç³»çµ±

```css
:root {
  /* å“ç‰Œè‰² */
  --color-primary: #3b82f6;
  --color-secondary: #64748b;
  
  /* èªæ„åŒ–é¡è‰² */
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-danger: #ef4444;
  
  /* èƒŒæ™¯è‰² */
  --bg-primary: #ffffff;
  --bg-secondary: #f8fafc;
  
  /* æ–‡å­—è‰² */
  --text-primary: #111827;
  --text-secondary: #4b5563;
}

/* æš—è‰²ä¸»é¡Œ */
[data-theme="dark"] {
  --bg-primary: #111827;
  --bg-secondary: #1f2937;
  --text-primary: #f9fafb;
  --text-secondary: #d1d5db;
}
```

### 5.4 å…±ç”¨æ¨£å¼å…ƒä»¶

#### åŸºç¤å…ƒä»¶æ¨£å¼

```css
@layer components {
  /* æŒ‰éˆ•æ¨£å¼ */
  .btn {
    @apply inline-flex items-center px-4 py-2 text-sm font-medium 
           rounded-md transition-colors focus:outline-none focus:ring-2;
  }
  
  .btn-primary {
    @apply btn bg-primary-500 text-white hover:bg-primary-600;
  }
  
  .btn-secondary {
    @apply btn bg-gray-200 text-gray-900 hover:bg-gray-300;
  }
  
  /* è¡¨å–®æ¨£å¼ */
  .form-input {
    @apply w-full px-3 py-2 border border-gray-300 rounded-md 
           focus:ring-1 focus:ring-primary-500 focus:border-primary-500;
  }
  
  /* å¡ç‰‡æ¨£å¼ */
  .card {
    @apply bg-white rounded-lg shadow-md p-4;
  }
}
```

---

## ç¸½çµ

æœ¬å‰ç«¯é–‹ç™¼æŒ‡å¼•æä¾›äº†å®Œæ•´çš„é–‹ç™¼è¦ç¯„ï¼Œæ¶µè“‹äº†å°ˆæ¡ˆçµæ§‹ã€å‘½åè¦ç¯„ã€ç¨‹å¼æ’°å¯«é¢¨æ ¼ã€å…ƒä»¶é–‹ç™¼å’Œæ¨£å¼è¨­è¨ˆç­‰æ ¸å¿ƒé¢å‘ã€‚è«‹é–‹ç™¼åœ˜éšŠåš´æ ¼éµå¾ªé€™äº›è¦ç¯„ï¼Œä»¥ç¢ºä¿ç¨‹å¼ç¢¼å“è³ªå’Œå°ˆæ¡ˆçš„å¯ç¶­è­·æ€§ã€‚

### é‡è¦æé†’

1. **ä¿æŒä¸€è‡´æ€§**: æ•´å€‹åœ˜éšŠéƒ½æ‡‰éµå¾ªç›¸åŒçš„è¦ç¯„
2. **å®šæœŸæ›´æ–°**: éš¨è‘—æŠ€è¡“ç™¼å±•å’Œå°ˆæ¡ˆéœ€æ±‚è®ŠåŒ–ï¼Œé©æ™‚æ›´æ–°è¦ç¯„
3. **ç¨‹å¼ç¢¼å¯©æŸ¥**: åœ¨ Pull Request ä¸­ç¢ºä¿æ‰€æœ‰ç¨‹å¼ç¢¼éƒ½ç¬¦åˆè¦ç¯„
4. **å·¥å…·è¼”åŠ©**: å–„ç”¨ ESLintã€Prettier ç­‰å·¥å…·è‡ªå‹•åŒ–æª¢æŸ¥

---

## 6. API ä¸²æ¥èˆ‡è³‡æ–™å­˜å–è¦ç¯„

### 6.1 Axios è¨­å®šèˆ‡å¯¦ä¾‹åŒ–

#### åŸºç¤ Axios è¨­å®š

```typescript
// src/api/client.ts
import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios';
import { useAuthStore } from '@/stores/auth';
import { showErrorMessage } from '@/utils/message';

// API åŸºç¤è¨­å®š
const API_CONFIG = {
  baseURL: import.meta.env.VITE_API_BASE_URL || 'https://api.example.com',
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
    'Accept': 'application/json',
  },
};

// å»ºç«‹ Axios å¯¦ä¾‹
const apiClient: AxiosInstance = axios.create(API_CONFIG);

// è«‹æ±‚æ””æˆªå™¨
apiClient.interceptors.request.use(
  (config) => {
    // æ·»åŠ èªè­‰ Token
    const authStore = useAuthStore();
    if (authStore.token) {
      config.headers.Authorization = `Bearer ${authStore.token}`;
    }

    // æ·»åŠ è«‹æ±‚ ID (ç”¨æ–¼è¿½è¹¤)
    config.headers['X-Request-ID'] = generateRequestId();

    // è¨˜éŒ„è«‹æ±‚è³‡è¨Š
    console.log(`ğŸš€ API Request: ${config.method?.toUpperCase()} ${config.url}`, {
      params: config.params,
      data: config.data,
    });

    return config;
  },
  (error) => {
    console.error('âŒ Request Error:', error);
    return Promise.reject(error);
  }
);

// å›æ‡‰æ””æˆªå™¨
apiClient.interceptors.response.use(
  (response: AxiosResponse) => {
    // è¨˜éŒ„æˆåŠŸå›æ‡‰
    console.log(`âœ… API Response: ${response.config.method?.toUpperCase()} ${response.config.url}`, {
      status: response.status,
      data: response.data,
    });

    return response;
  },
  async (error) => {
    const { config, response } = error;

    // è¨˜éŒ„éŒ¯èª¤å›æ‡‰
    console.error(`âŒ API Error: ${config?.method?.toUpperCase()} ${config?.url}`, {
      status: response?.status,
      data: response?.data,
    });

    // çµ±ä¸€éŒ¯èª¤è™•ç†
    if (response?.status === 401) {
      // Token éæœŸï¼Œé‡æ–°ç™»å…¥
      const authStore = useAuthStore();
      await authStore.logout();
      window.location.href = '/login';
      return Promise.reject(new Error('ç™»å…¥å·²éæœŸï¼Œè«‹é‡æ–°ç™»å…¥'));
    }

    if (response?.status === 403) {
      showErrorMessage('æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ');
      return Promise.reject(new Error('æ¬Šé™ä¸è¶³'));
    }

    if (response?.status >= 500) {
      showErrorMessage('ä¼ºæœå™¨ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
      return Promise.reject(new Error('ä¼ºæœå™¨éŒ¯èª¤'));
    }

    if (response?.status === 422) {
      // è¡¨å–®é©—è­‰éŒ¯èª¤
      const validationErrors = response.data.errors || {};
      return Promise.reject(new ValidationError('è¡¨å–®é©—è­‰å¤±æ•—', validationErrors));
    }

    // å…¶ä»–éŒ¯èª¤
    const message = response?.data?.message || error.message || 'ç¶²è·¯é€£ç·šå¤±æ•—';
    showErrorMessage(message);
    return Promise.reject(new Error(message));
  }
);

export default apiClient;
```

#### è‡ªå®šç¾©éŒ¯èª¤é¡åˆ¥

```typescript
// src/api/errors.ts
export class ApiError extends Error {
  constructor(
    message: string,
    public status?: number,
    public code?: string,
    public data?: any
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

export class ValidationError extends Error {
  constructor(
    message: string,
    public errors: Record<string, string[]>
  ) {
    super(message);
    this.name = 'ValidationError';
  }
}

export class NetworkError extends Error {
  constructor(message: string = 'ç¶²è·¯é€£ç·šå¤±æ•—') {
    super(message);
    this.name = 'NetworkError';
  }
}
```

### 6.2 API æ¨¡çµ„åŒ–è¨­è¨ˆ

#### åŸºç¤ API æœå‹™é¡åˆ¥

```typescript
// src/api/base.ts
import apiClient from './client';
import type { AxiosResponse } from 'axios';

export interface ApiResponse<T = any> {
  data: T;
  message: string;
  success: boolean;
  code: number;
  meta?: {
    current_page: number;
    last_page: number;
    per_page: number;
    total: number;
  };
}

export interface PaginationParams {
  page?: number;
  per_page?: number;
  sort_by?: string;
  sort_order?: 'asc' | 'desc';
}

export abstract class BaseApiService {
  protected abstract baseURL: string;

  protected async get<T>(
    endpoint: string,
    params?: Record<string, any>
  ): Promise<ApiResponse<T>> {
    const response: AxiosResponse<ApiResponse<T>> = await apiClient.get(
      `${this.baseURL}${endpoint}`,
      { params }
    );
    return response.data;
  }

  protected async post<T>(
    endpoint: string,
    data?: any
  ): Promise<ApiResponse<T>> {
    const response: AxiosResponse<ApiResponse<T>> = await apiClient.post(
      `${this.baseURL}${endpoint}`,
      data
    );
    return response.data;
  }

  protected async put<T>(
    endpoint: string,
    data?: any
  ): Promise<ApiResponse<T>> {
    const response: AxiosResponse<ApiResponse<T>> = await apiClient.put(
      `${this.baseURL}${endpoint}`,
      data
    );
    return response.data;
  }

  protected async patch<T>(
    endpoint: string,
    data?: any
  ): Promise<ApiResponse<T>> {
    const response: AxiosResponse<ApiResponse<T>> = await apiClient.patch(
      `${this.baseURL}${endpoint}`,
      data
    );
    return response.data;
  }

  protected async delete<T>(
    endpoint: string
  ): Promise<ApiResponse<T>> {
    const response: AxiosResponse<ApiResponse<T>> = await apiClient.delete(
      `${this.baseURL}${endpoint}`
    );
    return response.data;
  }

  protected buildQueryParams(params: Record<string, any>): string {
    const searchParams = new URLSearchParams();
    
    Object.entries(params).forEach(([key, value]) => {
      if (value !== null && value !== undefined && value !== '') {
        if (Array.isArray(value)) {
          value.forEach(item => searchParams.append(`${key}[]`, item));
        } else {
          searchParams.append(key, value.toString());
        }
      }
    });

    return searchParams.toString();
  }
}
```

#### ä½¿ç”¨è€… API æœå‹™ç¯„ä¾‹

```typescript
// src/api/modules/user.ts
import { BaseApiService } from '../base';
import type { ApiResponse, PaginationParams } from '../base';

export interface User {
  id: number;
  name: string;
  email: string;
  avatar?: string;
  role: string;
  is_active: boolean;
  created_at: string;
  updated_at: string;
}

export interface CreateUserDto {
  name: string;
  email: string;
  password: string;
  role: string;
}

export interface UpdateUserDto {
  name?: string;
  email?: string;
  avatar?: string;
  role?: string;
  is_active?: boolean;
}

export interface UserListParams extends PaginationParams {
  search?: string;
  role?: string;
  is_active?: boolean;
}

export class UserApiService extends BaseApiService {
  protected baseURL = '/users';

  /**
   * å–å¾—ä½¿ç”¨è€…åˆ—è¡¨
   */
  async getUsers(params: UserListParams = {}): Promise<ApiResponse<User[]>> {
    return this.get<User[]>('', params);
  }

  /**
   * æ ¹æ“š ID å–å¾—ä½¿ç”¨è€…è©³ç´°è³‡æ–™
   */
  async getUser(id: number): Promise<ApiResponse<User>> {
    return this.get<User>(`/${id}`);
  }

  /**
   * å»ºç«‹æ–°ä½¿ç”¨è€…
   */
  async createUser(userData: CreateUserDto): Promise<ApiResponse<User>> {
    return this.post<User>('', userData);
  }

  /**
   * æ›´æ–°ä½¿ç”¨è€…è³‡æ–™
   */
  async updateUser(id: number, userData: UpdateUserDto): Promise<ApiResponse<User>> {
    return this.put<User>(`/${id}`, userData);
  }

  /**
   * åˆªé™¤ä½¿ç”¨è€…
   */
  async deleteUser(id: number): Promise<ApiResponse<void>> {
    return this.delete<void>(`/${id}`);
  }

  /**
   * ä¸Šå‚³ä½¿ç”¨è€…é ­åƒ
   */
  async uploadAvatar(id: number, file: File): Promise<ApiResponse<{ avatar_url: string }>> {
    const formData = new FormData();
    formData.append('avatar', file);

    return this.post<{ avatar_url: string }>(`/${id}/avatar`, formData);
  }

  /**
   * æ‰¹æ¬¡æ“ä½œä½¿ç”¨è€…
   */
  async batchUpdateUsers(
    userIds: number[],
    action: 'activate' | 'deactivate' | 'delete'
  ): Promise<ApiResponse<void>> {
    return this.post<void>('/batch', {
      user_ids: userIds,
      action,
    });
  }

  /**
   * åŒ¯å‡ºä½¿ç”¨è€…è³‡æ–™
   */
  async exportUsers(params: UserListParams = {}): Promise<Blob> {
    const queryString = this.buildQueryParams(params);
    const response = await apiClient.get(`${this.baseURL}/export?${queryString}`, {
      responseType: 'blob',
    });
    return response.data;
  }
}

// åŒ¯å‡ºå–®ä¾‹å¯¦ä¾‹
export const userApi = new UserApiService();
```

### 6.3 Composables è³‡æ–™ç®¡ç†

#### useApi Composable

```typescript
// src/composables/useApi.ts
import { ref, computed, type Ref } from 'vue';
import type { ApiResponse } from '@/api/base';

export interface UseApiOptions<T> {
  immediate?: boolean;
  initialData?: T;
  onSuccess?: (data: T) => void;
  onError?: (error: Error) => void;
}

export interface UseApiReturn<T> {
  data: Ref<T | null>;
  loading: Ref<boolean>;
  error: Ref<Error | null>;
  execute: (...args: any[]) => Promise<T>;
  refresh: () => Promise<T>;
  reset: () => void;
}

export function useApi<T>(
  apiFunction: (...args: any[]) => Promise<ApiResponse<T>>,
  options: UseApiOptions<T> = {}
): UseApiReturn<T> {
  const {
    immediate = false,
    initialData = null,
    onSuccess,
    onError,
  } = options;

  const data = ref<T | null>(initialData);
  const loading = ref(false);
  const error = ref<Error | null>(null);
  const lastArgs = ref<any[]>([]);

  const execute = async (...args: any[]): Promise<T> => {
    try {
      loading.value = true;
      error.value = null;
      lastArgs.value = args;

      const response = await apiFunction(...args);
      data.value = response.data;

      onSuccess?.(response.data);
      return response.data;
    } catch (err) {
      const errorInstance = err instanceof Error ? err : new Error(String(err));
      error.value = errorInstance;
      onError?.(errorInstance);
      throw errorInstance;
    } finally {
      loading.value = false;
    }
  };

  const refresh = (): Promise<T> => {
    return execute(...lastArgs.value);
  };

  const reset = (): void => {
    data.value = initialData;
    loading.value = false;
    error.value = null;
    lastArgs.value = [];
  };

  // ç«‹å³åŸ·è¡Œ
  if (immediate) {
    execute();
  }

  return {
    data,
    loading,
    error,
    execute,
    refresh,
    reset,
  };
}
```

#### ä½¿ç”¨è€…è³‡æ–™ç®¡ç† Composable

```typescript
// src/composables/useUsers.ts
import { ref, computed } from 'vue';
import { userApi, type User, type UserListParams } from '@/api/modules/user';
import { useApi } from './useApi';

export function useUsers() {
  const users = ref<User[]>([]);
  const currentUser = ref<User | null>(null);
  const pagination = ref({
    current_page: 1,
    last_page: 1,
    per_page: 10,
    total: 0,
  });

  // å–å¾—ä½¿ç”¨è€…åˆ—è¡¨
  const {
    data: userListData,
    loading: loadingUsers,
    error: usersError,
    execute: fetchUsers,
  } = useApi(userApi.getUsers, {
    onSuccess: (response) => {
      users.value = response.data;
      if (response.meta) {
        pagination.value = response.meta;
      }
    },
  });

  // å–å¾—å–®ä¸€ä½¿ç”¨è€…
  const {
    data: userData,
    loading: loadingUser,
    error: userError,
    execute: fetchUser,
  } = useApi(userApi.getUser, {
    onSuccess: (data) => {
      currentUser.value = data;
    },
  });

  // å»ºç«‹ä½¿ç”¨è€…
  const {
    loading: creatingUser,
    error: createError,
    execute: createUser,
  } = useApi(userApi.createUser, {
    onSuccess: (data) => {
      users.value.unshift(data);
      pagination.value.total += 1;
    },
  });

  // æ›´æ–°ä½¿ç”¨è€…
  const {
    loading: updatingUser,
    error: updateError,
    execute: updateUser,
  } = useApi(userApi.updateUser, {
    onSuccess: (data) => {
      const index = users.value.findIndex(u => u.id === data.id);
      if (index !== -1) {
        users.value[index] = data;
      }
      if (currentUser.value?.id === data.id) {
        currentUser.value = data;
      }
    },
  });

  // åˆªé™¤ä½¿ç”¨è€…
  const {
    loading: deletingUser,
    error: deleteError,
    execute: deleteUser,
  } = useApi(userApi.deleteUser, {
    onSuccess: (_, userId: number) => {
      users.value = users.value.filter(u => u.id !== userId);
      pagination.value.total -= 1;
      if (currentUser.value?.id === userId) {
        currentUser.value = null;
      }
    },
  });

  // è¨ˆç®—å±¬æ€§
  const activeUsers = computed(() => 
    users.value.filter(user => user.is_active)
  );

  const totalPages = computed(() => pagination.value.last_page);

  const isLoading = computed(() => 
    loadingUsers.value || loadingUser.value || 
    creatingUser.value || updatingUser.value || deletingUser.value
  );

  const hasError = computed(() => 
    usersError.value || userError.value || 
    createError.value || updateError.value || deleteError.value
  );

  // æœå°‹ä½¿ç”¨è€…
  const searchUsers = async (params: UserListParams): Promise<void> => {
    await fetchUsers(params);
  };

  // é‡æ–°æ•´ç†ä½¿ç”¨è€…åˆ—è¡¨
  const refreshUsers = async (): Promise<void> => {
    await fetchUsers();
  };

  // æ¸…é™¤éŒ¯èª¤
  const clearErrors = (): void => {
    usersError.value = null;
    userError.value = null;
    createError.value = null;
    updateError.value = null;
    deleteError.value = null;
  };

  return {
    // ç‹€æ…‹
    users,
    currentUser,
    pagination,
    activeUsers,
    totalPages,
    isLoading,
    hasError,

    // æ–¹æ³•
    fetchUsers,
    fetchUser,
    createUser,
    updateUser,
    deleteUser,
    searchUsers,
    refreshUsers,
    clearErrors,

    // å€‹åˆ¥è¼‰å…¥ç‹€æ…‹
    loadingUsers,
    loadingUser,
    creatingUser,
    updatingUser,
    deletingUser,

    // å€‹åˆ¥éŒ¯èª¤ç‹€æ…‹
    usersError,
    userError,
    createError,
    updateError,
    deleteError,
  };
}
```

### 6.4 å¿«å–ç­–ç•¥

#### ç°¡å–®è¨˜æ†¶é«”å¿«å–

```typescript
// src/utils/cache.ts
interface CacheItem<T> {
  data: T;
  timestamp: number;
  ttl: number;
}

class MemoryCache {
  private cache = new Map<string, CacheItem<any>>();

  set<T>(key: string, data: T, ttl: number = 300000): void { // é è¨­ 5 åˆ†é˜
    this.cache.set(key, {
      data,
      timestamp: Date.now(),
      ttl,
    });
  }

  get<T>(key: string): T | null {
    const item = this.cache.get(key);
    
    if (!item) {
      return null;
    }

    const now = Date.now();
    if (now - item.timestamp > item.ttl) {
      this.cache.delete(key);
      return null;
    }

    return item.data;
  }

  has(key: string): boolean {
    return this.get(key) !== null;
  }

  delete(key: string): void {
    this.cache.delete(key);
  }

  clear(): void {
    this.cache.clear();
  }

  size(): number {
    // æ¸…ç†éæœŸé …ç›®
    const now = Date.now();
    for (const [key, item] of this.cache.entries()) {
      if (now - item.timestamp > item.ttl) {
        this.cache.delete(key);
      }
    }
    return this.cache.size;
  }
}

export const memoryCache = new MemoryCache();
```

#### å¸¶å¿«å–çš„ API Composable

```typescript
// src/composables/useCachedApi.ts
import { useApi, type UseApiOptions } from './useApi';
import { memoryCache } from '@/utils/cache';
import type { ApiResponse } from '@/api/base';

export interface UseCachedApiOptions<T> extends UseApiOptions<T> {
  cacheKey?: string;
  cacheTTL?: number;
  skipCache?: boolean;
}

export function useCachedApi<T>(
  apiFunction: (...args: any[]) => Promise<ApiResponse<T>>,
  options: UseCachedApiOptions<T> = {}
) {
  const {
    cacheKey,
    cacheTTL = 300000, // 5 åˆ†é˜
    skipCache = false,
    ...apiOptions
  } = options;

  const originalApiFunction = apiFunction;

  // åŒ…è£ API å‡½å¼ä»¥æ”¯æ´å¿«å–
  const cachedApiFunction = async (...args: any[]): Promise<ApiResponse<T>> => {
    const key = cacheKey || `${apiFunction.name}_${JSON.stringify(args)}`;

    // å¦‚æœä¸è·³éå¿«å–ä¸”æœ‰å¿«å–è³‡æ–™ï¼Œå‰‡è¿”å›å¿«å–
    if (!skipCache && memoryCache.has(key)) {
      const cachedData = memoryCache.get<T>(key);
      return {
        data: cachedData,
        message: 'success',
        success: true,
        code: 200,
      };
    }

    // å‘¼å«åŸå§‹ API
    const response = await originalApiFunction(...args);

    // å„²å­˜åˆ°å¿«å–
    if (!skipCache) {
      memoryCache.set(key, response.data, cacheTTL);
    }

    return response;
  };

  const api = useApi(cachedApiFunction, apiOptions);

  // æ¸…é™¤å¿«å–çš„æ–¹æ³•
  const clearCache = (): void => {
    if (cacheKey) {
      memoryCache.delete(cacheKey);
    }
  };

  return {
    ...api,
    clearCache,
  };
}
```

---

## 7. ç‹€æ…‹ç®¡ç†è¦ç¯„

### 7.1 Pinia Store çµæ§‹è¨­è¨ˆ

#### åŸºç¤ Store æ¨¡æ¿

```typescript
// src/stores/base.ts
import { defineStore } from 'pinia';
import { ref, computed, type Ref } from 'vue';

export interface BaseState {
  loading: boolean;
  error: string | null;
  lastUpdated: Date | null;
}

export interface BaseActions {
  setLoading: (loading: boolean) => void;
  setError: (error: string | null) => void;
  clearError: () => void;
  reset: () => void;
}

export function createBaseStore(storeName: string) {
  return defineStore(storeName, () => {
    // åŸºç¤ç‹€æ…‹
    const loading = ref(false);
    const error = ref<string | null>(null);
    const lastUpdated = ref<Date | null>(null);

    // åŸºç¤ Getters
    const isLoading = computed(() => loading.value);
    const hasError = computed(() => error.value !== null);
    const isInitialized = computed(() => lastUpdated.value !== null);

    // åŸºç¤ Actions
    const setLoading = (value: boolean): void => {
      loading.value = value;
    };

    const setError = (errorMessage: string | null): void => {
      error.value = errorMessage;
      loading.value = false;
    };

    const clearError = (): void => {
      error.value = null;
    };

    const updateTimestamp = (): void => {
      lastUpdated.value = new Date();
    };

    const reset = (): void => {
      loading.value = false;
      error.value = null;
      lastUpdated.value = null;
    };

    return {
      // State
      loading,
      error,
      lastUpdated,

      // Getters
      isLoading,
      hasError,
      isInitialized,

      // Actions
      setLoading,
      setError,
      clearError,
      updateTimestamp,
      reset,
    };
  });
}
```

#### ä½¿ç”¨è€…èªè­‰ Store

```typescript
// src/stores/auth.ts
import { defineStore } from 'pinia';
import { ref, computed } from 'vue';
import { authApi, type LoginCredentials, type User } from '@/api/modules/auth';
import { router } from '@/router';

export interface AuthState {
  user: User | null;
  token: string | null;
  refreshToken: string | null;
  isAuthenticated: boolean;
  permissions: string[];
  lastLoginTime: Date | null;
}

export const useAuthStore = defineStore('auth', () => {
  // State
  const user = ref<User | null>(null);
  const token = ref<string | null>(localStorage.getItem('auth_token'));
  const refreshToken = ref<string | null>(localStorage.getItem('refresh_token'));
  const permissions = ref<string[]>([]);
  const lastLoginTime = ref<Date | null>(null);
  const loading = ref(false);
  const error = ref<string | null>(null);

  // Getters
  const isAuthenticated = computed(() => Boolean(token.value && user.value));
  const userRole = computed(() => user.value?.role);
  const userName = computed(() => user.value?.name);
  const userEmail = computed(() => user.value?.email);
  const hasPermission = computed(() => (permission: string) => 
    permissions.value.includes(permission) || permissions.value.includes('*')
  );

  // Actions
  const login = async (credentials: LoginCredentials): Promise<void> => {
    try {
      loading.value = true;
      error.value = null;

      const response = await authApi.login(credentials);
      const { user: userData, token: accessToken, refresh_token, permissions: userPermissions } = response.data;

      // æ›´æ–°ç‹€æ…‹
      user.value = userData;
      token.value = accessToken;
      refreshToken.value = refresh_token;
      permissions.value = userPermissions;
      lastLoginTime.value = new Date();

      // å„²å­˜åˆ° localStorage
      localStorage.setItem('auth_token', accessToken);
      localStorage.setItem('refresh_token', refresh_token);
      localStorage.setItem('user_data', JSON.stringify(userData));

      // é‡å®šå‘åˆ°é¦–é 
      await router.push('/dashboard');
    } catch (err) {
      error.value = err instanceof Error ? err.message : 'ç™»å…¥å¤±æ•—';
      throw err;
    } finally {
      loading.value = false;
    }
  };

  const logout = async (): Promise<void> => {
    try {
      loading.value = true;

      // å‘¼å«ç™»å‡º API
      if (token.value) {
        await authApi.logout();
      }
    } catch (err) {
      console.error('ç™»å‡º API å‘¼å«å¤±æ•—:', err);
    } finally {
      // æ¸…é™¤ç‹€æ…‹
      user.value = null;
      token.value = null;
      refreshToken.value = null;
      permissions.value = [];
      lastLoginTime.value = null;
      error.value = null;

      // æ¸…é™¤ localStorage
      localStorage.removeItem('auth_token');
      localStorage.removeItem('refresh_token');
      localStorage.removeItem('user_data');

      loading.value = false;

      // é‡å®šå‘åˆ°ç™»å…¥é 
      await router.push('/login');
    }
  };

  const refreshAccessToken = async (): Promise<string> => {
    if (!refreshToken.value) {
      throw new Error('æ²’æœ‰ refresh token');
    }

    try {
      const response = await authApi.refreshToken(refreshToken.value);
      const { token: newToken, refresh_token: newRefreshToken } = response.data;

      token.value = newToken;
      refreshToken.value = newRefreshToken;

      localStorage.setItem('auth_token', newToken);
      localStorage.setItem('refresh_token', newRefreshToken);

      return newToken;
    } catch (err) {
      // Refresh token ç„¡æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å…¥
      await logout();
      throw new Error('ç™»å…¥å·²éæœŸï¼Œè«‹é‡æ–°ç™»å…¥');
    }
  };

  const updateProfile = async (profileData: Partial<User>): Promise<void> => {
    if (!user.value) {
      throw new Error('ä½¿ç”¨è€…æœªç™»å…¥');
    }

    try {
      loading.value = true;
      error.value = null;

      const response = await authApi.updateProfile(profileData);
      user.value = response.data;

      // æ›´æ–° localStorage
      localStorage.setItem('user_data', JSON.stringify(user.value));
    } catch (err) {
      error.value = err instanceof Error ? err.message : 'æ›´æ–°å€‹äººè³‡æ–™å¤±æ•—';
      throw err;
    } finally {
      loading.value = false;
    }
  };

  const initializeFromStorage = (): void => {
    const storedUser = localStorage.getItem('user_data');
    const storedToken = localStorage.getItem('auth_token');
    const storedRefreshToken = localStorage.getItem('refresh_token');

    if (storedUser && storedToken) {
      try {
        user.value = JSON.parse(storedUser);
        token.value = storedToken;
        refreshToken.value = storedRefreshToken;
      } catch (err) {
        console.error('è§£æå„²å­˜çš„ä½¿ç”¨è€…è³‡æ–™å¤±æ•—:', err);
        logout();
      }
    }
  };

  const checkPermission = (permission: string): boolean => {
    return hasPermission.value(permission);
  };

  const hasAnyPermission = (permissionList: string[]): boolean => {
    return permissionList.some(permission => checkPermission(permission));
  };

  const hasAllPermissions = (permissionList: string[]): boolean => {
    return permissionList.every(permission => checkPermission(permission));
  };

  // åˆå§‹åŒ–
  initializeFromStorage();

  return {
    // State
    user,
    token,
    refreshToken,
    permissions,
    lastLoginTime,
    loading,
    error,

    // Getters
    isAuthenticated,
    userRole,
    userName,
    userEmail,
    hasPermission,

    // Actions
    login,
    logout,
    refreshAccessToken,
    updateProfile,
    initializeFromStorage,
    checkPermission,
    hasAnyPermission,
    hasAllPermissions,
  };
});
```

#### æ‡‰ç”¨ç¨‹å¼è¨­å®š Store

```typescript
// src/stores/app.ts
import { defineStore } from 'pinia';
import { ref, computed, watch } from 'vue';

export type Theme = 'light' | 'dark' | 'auto';
export type Language = 'zh-TW' | 'zh-CN' | 'en-US';

export interface AppSettings {
  theme: Theme;
  language: Language;
  sidebarCollapsed: boolean;
  pageSize: number;
  dateFormat: string;
  timeFormat: string;
  currency: string;
  timezone: string;
}

export const useAppStore = defineStore('app', () => {
  // State
  const theme = ref<Theme>('auto');
  const language = ref<Language>('zh-TW');
  const sidebarCollapsed = ref(false);
  const pageSize = ref(10);
  const dateFormat = ref('YYYY-MM-DD');
  const timeFormat = ref('HH:mm:ss');
  const currency = ref('TWD');
  const timezone = ref('Asia/Taipei');
  const isOnline = ref(navigator.onLine);
  const windowWidth = ref(window.innerWidth);
  const windowHeight = ref(window.innerHeight);

  // Getters
  const currentTheme = computed(() => {
    if (theme.value === 'auto') {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    return theme.value;
  });

  const isMobile = computed(() => windowWidth.value < 768);
  const isTablet = computed(() => windowWidth.value >= 768 && windowWidth.value < 1024);
  const isDesktop = computed(() => windowWidth.value >= 1024);

  const deviceType = computed(() => {
    if (isMobile.value) return 'mobile';
    if (isTablet.value) return 'tablet';
    return 'desktop';
  });

  // Actions
  const setTheme = (newTheme: Theme): void => {
    theme.value = newTheme;
    applyTheme();
    saveToStorage();
  };

  const setLanguage = (newLanguage: Language): void => {
    language.value = newLanguage;
    saveToStorage();
  };

  const toggleSidebar = (): void => {
    sidebarCollapsed.value = !sidebarCollapsed.value;
    saveToStorage();
  };

  const setSidebarCollapsed = (collapsed: boolean): void => {
    sidebarCollapsed.value = collapsed;
    saveToStorage();
  };

  const updateSettings = (settings: Partial<AppSettings>): void => {
    if (settings.theme !== undefined) theme.value = settings.theme;
    if (settings.language !== undefined) language.value = settings.language;
    if (settings.sidebarCollapsed !== undefined) sidebarCollapsed.value = settings.sidebarCollapsed;
    if (settings.pageSize !== undefined) pageSize.value = settings.pageSize;
    if (settings.dateFormat !== undefined) dateFormat.value = settings.dateFormat;
    if (settings.timeFormat !== undefined) timeFormat.value = settings.timeFormat;
    if (settings.currency !== undefined) currency.value = settings.currency;
    if (settings.timezone !== undefined) timezone.value = settings.timezone;

    applyTheme();
    saveToStorage();
  };

  const applyTheme = (): void => {
    const root = document.documentElement;
    root.setAttribute('data-theme', currentTheme.value);
    
    if (currentTheme.value === 'dark') {
      root.classList.add('dark');
    } else {
      root.classList.remove('dark');
    }
  };

  const saveToStorage = (): void => {
    const settings: AppSettings = {
      theme: theme.value,
      language: language.value,
      sidebarCollapsed: sidebarCollapsed.value,
      pageSize: pageSize.value,
      dateFormat: dateFormat.value,
      timeFormat: timeFormat.value,
      currency: currency.value,
      timezone: timezone.value,
    };

    localStorage.setItem('app_settings', JSON.stringify(settings));
  };

  const loadFromStorage = (): void => {
    const stored = localStorage.getItem('app_settings');
    if (stored) {
      try {
        const settings: AppSettings = JSON.parse(stored);
        updateSettings(settings);
      } catch (err) {
        console.error('è§£ææ‡‰ç”¨ç¨‹å¼è¨­å®šå¤±æ•—:', err);
      }
    }
  };

  const updateWindowSize = (): void => {
    windowWidth.value = window.innerWidth;
    windowHeight.value = window.innerHeight;
  };

  const setOnlineStatus = (online: boolean): void => {
    isOnline.value = online;
  };

  const resetSettings = (): void => {
    theme.value = 'auto';
    language.value = 'zh-TW';
    sidebarCollapsed.value = false;
    pageSize.value = 10;
    dateFormat.value = 'YYYY-MM-DD';
    timeFormat.value = 'HH:mm:ss';
    currency.value = 'TWD';
    timezone.value = 'Asia/Taipei';

    applyTheme();
    saveToStorage();
  };

  // ç›£è½è¦–çª—å¤§å°è®ŠåŒ–
  window.addEventListener('resize', updateWindowSize);

  // ç›£è½ç¶²è·¯ç‹€æ…‹
  window.addEventListener('online', () => setOnlineStatus(true));
  window.addEventListener('offline', () => setOnlineStatus(false));

  // ç›£è½ç³»çµ±ä¸»é¡Œè®ŠåŒ–
  const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
  mediaQuery.addEventListener('change', () => {
    if (theme.value === 'auto') {
      applyTheme();
    }
  });

  // è‡ªå‹•å„²å­˜è¨­å®š
  watch(
    [theme, language, sidebarCollapsed, pageSize, dateFormat, timeFormat, currency, timezone],
    () => {
      saveToStorage();
    },
    { deep: true }
  );

  // åˆå§‹åŒ–
  loadFromStorage();
  applyTheme();

  return {
    // State
    theme,
    language,
    sidebarCollapsed,
    pageSize,
    dateFormat,
    timeFormat,
    currency,
    timezone,
    isOnline,
    windowWidth,
    windowHeight,

    // Getters
    currentTheme,
    isMobile,
    isTablet,
    isDesktop,
    deviceType,

    // Actions
    setTheme,
    setLanguage,
    toggleSidebar,
    setSidebarCollapsed,
    updateSettings,
    resetSettings,
    updateWindowSize,
    setOnlineStatus,
    loadFromStorage,
    saveToStorage,
  };
});
```

### 7.2 æ¨¡çµ„åŒ– Store ç®¡ç†

#### Store å·¥å» å‡½å¼

```typescript
// src/stores/factory.ts
import { defineStore } from 'pinia';
import { ref, computed } from 'vue';
import type { ApiResponse } from '@/api/base';

export interface CrudState<T> {
  items: T[];
  currentItem: T | null;
  loading: boolean;
  error: string | null;
  pagination: {
    current_page: number;
    last_page: number;
    per_page: number;
    total: number;
  };
}

export interface CrudApi<T, CreateDto, UpdateDto> {
  getList: (params?: any) => Promise<ApiResponse<T[]>>;
  getById: (id: number) => Promise<ApiResponse<T>>;
  create: (data: CreateDto) => Promise<ApiResponse<T>>;
  update: (id: number, data: UpdateDto) => Promise<ApiResponse<T>>;
  delete: (id: number) => Promise<ApiResponse<void>>;
}

export function createCrudStore<T extends { id: number }, CreateDto, UpdateDto>(
  storeName: string,
  api: CrudApi<T, CreateDto, UpdateDto>
) {
  return defineStore(storeName, () => {
    // State
    const items = ref<T[]>([]);
    const currentItem = ref<T | null>(null);
    const loading = ref(false);
    const error = ref<string | null>(null);
    const pagination = ref({
      current_page: 1,
      last_page: 1,
      per_page: 10,
      total: 0,
    });

    // Getters
    const itemCount = computed(() => items.value.length);
    const hasItems = computed(() => items.value.length > 0);
    const isLoading = computed(() => loading.value);
    const hasError = computed(() => error.value !== null);

    // Actions
    const setLoading = (value: boolean): void => {
      loading.value = value;
    };

    const setError = (errorMessage: string | null): void => {
      error.value = errorMessage;
    };

    const clearError = (): void => {
      error.value = null;
    };

    const fetchItems = async (params?: any): Promise<void> => {
      try {
        setLoading(true);
        clearError();

        const response = await api.getList(params);
        items.value = response.data;

        if (response.meta) {
          pagination.value = response.meta;
        }
      } catch (err) {
        setError(err instanceof Error ? err.message : 'å–å¾—è³‡æ–™å¤±æ•—');
        throw err;
      } finally {
        setLoading(false);
      }
    };

    const fetchItem = async (id: number): Promise<void> => {
      try {
        setLoading(true);
        clearError();

        const response = await api.getById(id);
        currentItem.value = response.data;
      } catch (err) {
        setError(err instanceof Error ? err.message : 'å–å¾—è³‡æ–™å¤±æ•—');
        throw err;
      } finally {
        setLoading(false);
      }
    };

    const createItem = async (data: CreateDto): Promise<T> => {
      try {
        setLoading(true);
        clearError();

        const response = await api.create(data);
        items.value.unshift(response.data);
        pagination.value.total += 1;

        return response.data;
      } catch (err) {
        setError(err instanceof Error ? err.message : 'å»ºç«‹è³‡æ–™å¤±æ•—');
        throw err;
      } finally {
        setLoading(false);
      }
    };

    const updateItem = async (id: number, data: UpdateDto): Promise<T> => {
      try {
        setLoading(true);
        clearError();

        const response = await api.update(id, data);
        const index = items.value.findIndex(item => item.id === id);

        if (index !== -1) {
          items.value[index] = response.data;
        }

        if (currentItem.value?.id === id) {
          currentItem.value = response.data;
        }

        return response.data;
      } catch (err) {
        setError(err instanceof Error ? err.message : 'æ›´æ–°è³‡æ–™å¤±æ•—');
        throw err;
      } finally {
        setLoading(false);
      }
    };

    const deleteItem = async (id: number): Promise<void> => {
      try {
        setLoading(true);
        clearError();

        await api.delete(id);
        items.value = items.value.filter(item => item.id !== id);
        pagination.value.total -= 1;

        if (currentItem.value?.id === id) {
          currentItem.value = null;
        }
      } catch (err) {
        setError(err instanceof Error ? err.message : 'åˆªé™¤è³‡æ–™å¤±æ•—');
        throw err;
      } finally {
        setLoading(false);
      }
    };

    const findItemById = (id: number): T | undefined => {
      return items.value.find(item => item.id === id);
    };

    const reset = (): void => {
      items.value = [];
      currentItem.value = null;
      loading.value = false;
      error.value = null;
      pagination.value = {
        current_page: 1,
        last_page: 1,
        per_page: 10,
        total: 0,
      };
    };

    return {
      // State
      items,
      currentItem,
      loading,
      error,
      pagination,

      // Getters
      itemCount,
      hasItems,
      isLoading,
      hasError,

      // Actions
      fetchItems,
      fetchItem,
      createItem,
      updateItem,
      deleteItem,
      findItemById,
      setLoading,
      setError,
      clearError,
      reset,
    };
  });
}
```

#### ä½¿ç”¨å·¥å» å‡½å¼å»ºç«‹ç‰¹å®š Store

```typescript
// src/stores/product.ts
import { createCrudStore } from './factory';
import { productApi, type Product, type CreateProductDto, type UpdateProductDto } from '@/api/modules/product';

export const useProductStore = createCrudStore<Product, CreateProductDto, UpdateProductDto>(
  'product',
  productApi
);

// æ“´å±•ç‰¹å®šåŠŸèƒ½
export const useEnhancedProductStore = defineStore('enhancedProduct', () => {
  const baseStore = useProductStore();

  // æ“´å±•çš„è¨ˆç®—å±¬æ€§
  const activeProducts = computed(() => 
    baseStore.items.filter(product => product.is_active)
  );

  const productsByCategory = computed(() => {
    const groups: Record<string, Product[]> = {};
    baseStore.items.forEach(product => {
      if (!groups[product.category]) {
        groups[product.category] = [];
      }
      groups[product.category].push(product);
    });
    return groups;
  });

  // æ“´å±•çš„æ–¹æ³•
  const toggleProductStatus = async (id: number): Promise<void> => {
    const product = baseStore.findItemById(id);
    if (product) {
      await baseStore.updateItem(id, { is_active: !product.is_active });
    }
  };

  const searchProducts = async (query: string): Promise<void> => {
    await baseStore.fetchItems({ search: query });
  };

  return {
    ...baseStore,
    activeProducts,
    productsByCategory,
    toggleProductStatus,
    searchProducts,
  };
});
```

### 7.3 Store ä¹‹é–“çš„é€šè¨Š

#### è·¨ Store é€šè¨Šæ¨¡å¼

```typescript
// src/stores/notification.ts
import { defineStore } from 'pinia';
import { ref } from 'vue';

export interface Notification {
  id: string;
  type: 'success' | 'error' | 'warning' | 'info';
  title: string;
  message: string;
  duration?: number;
  actions?: Array<{
    label: string;
    action: () => void;
  }>;
  timestamp: Date;
}

export const useNotificationStore = defineStore('notification', () => {
  const notifications = ref<Notification[]>([]);

  const addNotification = (notification: Omit<Notification, 'id' | 'timestamp'>): string => {
    const id = `notification_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    const newNotification: Notification = {
      ...notification,
      id,
      timestamp: new Date(),
      duration: notification.duration ?? 5000,
    };

    notifications.value.push(newNotification);

    // è‡ªå‹•ç§»é™¤é€šçŸ¥
    if (newNotification.duration && newNotification.duration > 0) {
      setTimeout(() => {
        removeNotification(id);
      }, newNotification.duration);
    }

    return id;
  };

  const removeNotification = (id: string): void => {
    const index = notifications.value.findIndex(n => n.id === id);
    if (index !== -1) {
      notifications.value.splice(index, 1);
    }
  };

  const clearAll = (): void => {
    notifications.value = [];
  };

  // ä¾¿åˆ©æ–¹æ³•
  const success = (title: string, message: string, options?: Partial<Notification>): string => {
    return addNotification({ ...options, type: 'success', title, message });
  };

  const error = (title: string, message: string, options?: Partial<Notification>): string => {
    return addNotification({ ...options, type: 'error', title, message });
  };

  const warning = (title: string, message: string, options?: Partial<Notification>): string => {
    return addNotification({ ...options, type: 'warning', title, message });
  };

  const info = (title: string, message: string, options?: Partial<Notification>): string => {
    return addNotification({ ...options, type: 'info', title, message });
  };

  return {
    notifications,
    addNotification,
    removeNotification,
    clearAll,
    success,
    error,
    warning,
    info,
  };
});
```

#### Store çµ„åˆæ¨¡å¼

```typescript
// src/stores/dashboard.ts
import { defineStore } from 'pinia';
import { computed } from 'vue';
import { useAuthStore } from './auth';
import { useUserStore } from './user';
import { useProductStore } from './product';
import { useNotificationStore } from './notification';

export const useDashboardStore = defineStore('dashboard', () => {
  const authStore = useAuthStore();
  const userStore = useUserStore();
  const productStore = useProductStore();
  const notificationStore = useNotificationStore();

  // çµ„åˆå¤šå€‹ store çš„è³‡æ–™
  const dashboardData = computed(() => ({
    user: authStore.user,
    totalUsers: userStore.itemCount,
    totalProducts: productStore.itemCount,
    recentNotifications: notificationStore.notifications.slice(0, 5),
  }));

  const initializeDashboard = async (): Promise<void> => {
    try {
      // ä¸¦è¡Œè¼‰å…¥å¤šå€‹è³‡æº
      await Promise.all([
        userStore.fetchItems({ per_page: 5, sort_by: 'created_at', sort_order: 'desc' }),
        productStore.fetchItems({ per_page: 10, is_active: true }),
      ]);

      notificationStore.success('å„€è¡¨æ¿', 'è³‡æ–™è¼‰å…¥å®Œæˆ');
    } catch (error) {
      notificationStore.error('å„€è¡¨æ¿', 'è³‡æ–™è¼‰å…¥å¤±æ•—');
      throw error;
    }
  };

  const refreshDashboard = async (): Promise<void> => {
    await initializeDashboard();
  };

  return {
    dashboardData,
    initializeDashboard,
    refreshDashboard,
  };
});
```

---

## 8. å¤šèªç³»è™•ç†è¦ç¯„

### 8.1 Vue I18n è¨­å®š

#### åŸºç¤ i18n è¨­å®š

```typescript
// src/i18n/index.ts
import { createI18n } from 'vue-i18n';
import { useAppStore } from '@/stores/app';

// èªè¨€æ¨¡çµ„
import zhTW from './locales/zh-TW.json';
import zhCN from './locales/zh-CN.json';
import enUS from './locales/en-US.json';

export type MessageSchema = typeof zhTW;

export const SUPPORTED_LOCALES = [
  { code: 'zh-TW', name: 'ç¹é«”ä¸­æ–‡', flag: 'ğŸ‡¹ğŸ‡¼' },
  { code: 'zh-CN', name: 'ç®€ä½“ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },
  { code: 'en-US', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
] as const;

export type SupportedLocale = typeof SUPPORTED_LOCALES[number]['code'];

// å‰µå»º i18n å¯¦ä¾‹
export const i18n = createI18n<[MessageSchema], SupportedLocale>({
  legacy: false, // ä½¿ç”¨ Composition API
  locale: 'zh-TW', // é è¨­èªè¨€
  fallbackLocale: 'zh-TW', // å›é€€èªè¨€
  globalInjection: true, // å…¨åŸŸæ³¨å…¥ $t
  messages: {
    'zh-TW': zhTW,
    'zh-CN': zhCN,
    'en-US': enUS,
  },
  numberFormats: {
    'zh-TW': {
      currency: {
        style: 'currency',
        currency: 'TWD',
        notation: 'standard',
      },
      decimal: {
        style: 'decimal',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      },
      percent: {
        style: 'percent',
        useGrouping: false,
      },
    },
    'zh-CN': {
      currency: {
        style: 'currency',
        currency: 'CNY',
        notation: 'standard',
      },
      decimal: {
        style: 'decimal',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      },
      percent: {
        style: 'percent',
        useGrouping: false,
      },
    },
    'en-US': {
      currency: {
        style: 'currency',
        currency: 'USD',
        notation: 'standard',
      },
      decimal: {
        style: 'decimal',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      },
      percent: {
        style: 'percent',
        useGrouping: false,
      },
    },
  },
  datetimeFormats: {
    'zh-TW': {
      short: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
      },
      long: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        weekday: 'short',
        hour: 'numeric',
        minute: 'numeric',
      },
      date: {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
      },
      time: {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
      },
    },
    'zh-CN': {
      short: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
      },
      long: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        weekday: 'short',
        hour: 'numeric',
        minute: 'numeric',
      },
      date: {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
      },
      time: {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
      },
    },
    'en-US': {
      short: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
      },
      long: {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        weekday: 'short',
        hour: 'numeric',
        minute: 'numeric',
      },
      date: {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
      },
      time: {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
      },
    },
  },
});

// è¨­å®šèªè¨€åˆ‡æ›å‡½å¼
export const setLocale = (locale: SupportedLocale): void => {
  i18n.global.locale.value = locale;
  document.documentElement.lang = locale;
  
  // æ›´æ–° store ä¸­çš„èªè¨€è¨­å®š
  const appStore = useAppStore();
  appStore.setLanguage(locale);
};

// å–å¾—ç€è¦½å™¨åå¥½èªè¨€
export const getBrowserLocale = (): SupportedLocale => {
  const navigatorLocale = navigator.language;
  const supportedCodes = SUPPORTED_LOCALES.map(locale => locale.code);
  
  if (supportedCodes.includes(navigatorLocale as SupportedLocale)) {
    return navigatorLocale as SupportedLocale;
  }

  // æª¢æŸ¥èªè¨€å‰ç¶´
  const langPrefix = navigatorLocale.split('-')[0];
  const matchedLocale = supportedCodes.find(code => code.startsWith(langPrefix));
  
  return (matchedLocale as SupportedLocale) || 'zh-TW';
};

// åˆå§‹åŒ–èªè¨€è¨­å®š
export const initializeLocale = (): void => {
  const appStore = useAppStore();
  const savedLocale = appStore.language;
  
  if (savedLocale && SUPPORTED_LOCALES.some(locale => locale.code === savedLocale)) {
    setLocale(savedLocale);
  } else {
    const browserLocale = getBrowserLocale();
    setLocale(browserLocale);
  }
};
```

### 8.2 ç¿»è­¯æª”æ¡ˆçµæ§‹

#### ç¹é«”ä¸­æ–‡ç¿»è­¯æª”æ¡ˆ

```json
// src/i18n/locales/zh-TW.json
{
  "common": {
    "ok": "ç¢ºå®š",
    "cancel": "å–æ¶ˆ",
    "save": "å„²å­˜",
    "edit": "ç·¨è¼¯",
    "delete": "åˆªé™¤",
    "add": "æ–°å¢",
    "search": "æœå°‹",
    "loading": "è¼‰å…¥ä¸­...",
    "noData": "æš«ç„¡è³‡æ–™",
    "confirm": "ç¢ºèª",
    "back": "è¿”å›",
    "next": "ä¸‹ä¸€æ­¥",
    "previous": "ä¸Šä¸€æ­¥",
    "submit": "æäº¤",
    "reset": "é‡è¨­",
    "close": "é—œé–‰",
    "view": "æª¢è¦–",
    "download": "ä¸‹è¼‰",
    "upload": "ä¸Šå‚³",
    "refresh": "é‡æ–°æ•´ç†",
    "filter": "ç¯©é¸",
    "sort": "æ’åº",
    "export": "åŒ¯å‡º",
    "import": "åŒ¯å…¥"
  },
  "auth": {
    "login": "ç™»å…¥",
    "logout": "ç™»å‡º",
    "register": "è¨»å†Š",
    "forgotPassword": "å¿˜è¨˜å¯†ç¢¼",
    "resetPassword": "é‡è¨­å¯†ç¢¼",
    "changePassword": "è®Šæ›´å¯†ç¢¼",
    "email": "é›»å­éƒµä»¶",
    "password": "å¯†ç¢¼",
    "confirmPassword": "ç¢ºèªå¯†ç¢¼",
    "rememberMe": "è¨˜ä½æˆ‘",
    "loginSuccess": "ç™»å…¥æˆåŠŸ",
    "loginFailed": "ç™»å…¥å¤±æ•—",
    "logoutSuccess": "ç™»å‡ºæˆåŠŸ",
    "invalidCredentials": "å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤",
    "passwordTooWeak": "å¯†ç¢¼å¼·åº¦ä¸è¶³",
    "emailExists": "é›»å­éƒµä»¶å·²å­˜åœ¨",
    "accountNotFound": "æ‰¾ä¸åˆ°æ­¤å¸³è™Ÿ",
    "accountDisabled": "å¸³è™Ÿå·²è¢«åœç”¨"
  },
  "nav": {
    "dashboard": "å„€è¡¨æ¿",
    "users": "ä½¿ç”¨è€…ç®¡ç†",
    "products": "ç”¢å“ç®¡ç†",
    "orders": "è¨‚å–®ç®¡ç†",
    "reports": "å ±è¡¨åˆ†æ",
    "settings": "ç³»çµ±è¨­å®š",
    "profile": "å€‹äººè³‡æ–™",
    "help": "èªªæ˜",
    "about": "é—œæ–¼æˆ‘å€‘"
  },
  "user": {
    "title": "ä½¿ç”¨è€…ç®¡ç†",
    "name": "å§“å",
    "email": "é›»å­éƒµä»¶",
    "role": "è§’è‰²",
    "status": "ç‹€æ…‹",
    "active": "å•Ÿç”¨",
    "inactive": "åœç”¨",
    "createdAt": "å»ºç«‹æ™‚é–“",
    "updatedAt": "æ›´æ–°æ™‚é–“",
    "lastLogin": "æœ€å¾Œç™»å…¥",
    "actions": "æ“ä½œ",
    "addUser": "æ–°å¢ä½¿ç”¨è€…",
    "editUser": "ç·¨è¼¯ä½¿ç”¨è€…",
    "deleteUser": "åˆªé™¤ä½¿ç”¨è€…",
    "userDetails": "ä½¿ç”¨è€…è©³æƒ…",
    "avatar": "é ­åƒ",
    "permissions": "æ¬Šé™",
    "assignRole": "æŒ‡æ´¾è§’è‰²",
    "changeStatus": "è®Šæ›´ç‹€æ…‹",
    "resetPassword": "é‡è¨­å¯†ç¢¼",
    "sendInvitation": "ç™¼é€é‚€è«‹",
    "bulkActions": "æ‰¹æ¬¡æ“ä½œ",
    "selectedUsers": "å·²é¸æ“‡ {count} ä½ä½¿ç”¨è€…",
    "confirmDelete": "ç¢ºå®šè¦åˆªé™¤é€™ä½ä½¿ç”¨è€…å—ï¼Ÿ",
    "deleteSuccess": "ä½¿ç”¨è€…åˆªé™¤æˆåŠŸ",
    "createSuccess": "ä½¿ç”¨è€…å»ºç«‹æˆåŠŸ",
    "updateSuccess": "ä½¿ç”¨è€…æ›´æ–°æˆåŠŸ"
  },
  "product": {
    "title": "ç”¢å“ç®¡ç†",
    "name": "ç”¢å“åç¨±",
    "category": "åˆ†é¡",
    "price": "åƒ¹æ ¼",
    "stock": "åº«å­˜",
    "description": "æè¿°",
    "images": "åœ–ç‰‡",
    "status": "ç‹€æ…‹",
    "featured": "ç²¾é¸",
    "published": "å·²ç™¼å¸ƒ",
    "draft": "è‰ç¨¿",
    "outOfStock": "ç¼ºè²¨",
    "lowStock": "åº«å­˜ä¸è¶³",
    "sku": "å•†å“ç·¨è™Ÿ",
    "weight": "é‡é‡",
    "dimensions": "å°ºå¯¸",
    "tags": "æ¨™ç±¤",
    "seo": "SEO è¨­å®š",
    "metaTitle": "æ¨™é¡Œ",
    "metaDescription": "æè¿°",
    "addProduct": "æ–°å¢ç”¢å“",
    "editProduct": "ç·¨è¼¯ç”¢å“",
    "deleteProduct": "åˆªé™¤ç”¢å“",
    "duplicateProduct": "è¤‡è£½ç”¢å“",
    "viewProduct": "æª¢è¦–ç”¢å“",
    "manageInventory": "åº«å­˜ç®¡ç†",
    "priceHistory": "åƒ¹æ ¼æ­·å²",
    "salesReport": "éŠ·å”®å ±è¡¨"
  },
  "form": {
    "validation": {
      "required": "æ­¤æ¬„ä½ç‚ºå¿…å¡«",
      "email": "è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€",
      "minLength": "æœ€å°‘éœ€è¦ {min} å€‹å­—å…ƒ",
      "maxLength": "æœ€å¤šåªèƒ½ {max} å€‹å­—å…ƒ",
      "min": "æœ€å°å€¼ç‚º {min}",
      "max": "æœ€å¤§å€¼ç‚º {max}",
      "pattern": "æ ¼å¼ä¸æ­£ç¢º",
      "sameAs": "è¼¸å…¥ä¸ä¸€è‡´",
      "phone": "è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»è©±è™Ÿç¢¼",
      "url": "è«‹è¼¸å…¥æœ‰æ•ˆçš„ç¶²å€",
      "numeric": "è«‹è¼¸å…¥æ•¸å­—",
      "alpha": "åªèƒ½è¼¸å…¥å­—æ¯",
      "alphaNum": "åªèƒ½è¼¸å…¥å­—æ¯å’Œæ•¸å­—"
    },
    "placeholder": {
      "search": "è«‹è¼¸å…¥æœå°‹é—œéµå­—...",
      "email": "è«‹è¼¸å…¥é›»å­éƒµä»¶",
      "password": "è«‹è¼¸å…¥å¯†ç¢¼",
      "name": "è«‹è¼¸å…¥å§“å",
      "phone": "è«‹è¼¸å…¥é›»è©±è™Ÿç¢¼",
      "address": "è«‹è¼¸å…¥åœ°å€",
      "remark": "è«‹è¼¸å…¥å‚™è¨»"
    }
  },
  "message": {
    "success": {
      "saved": "å„²å­˜æˆåŠŸ",
      "updated": "æ›´æ–°æˆåŠŸ",
      "deleted": "åˆªé™¤æˆåŠŸ",
      "uploaded": "ä¸Šå‚³æˆåŠŸ",
      "sent": "ç™¼é€æˆåŠŸ",
      "copied": "è¤‡è£½æˆåŠŸ"
    },
    "error": {
      "general": "æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦",
      "network": "ç¶²è·¯é€£ç·šå¤±æ•—",
      "timeout": "è«‹æ±‚é€¾æ™‚",
      "unauthorized": "æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ",
      "notFound": "æ‰¾ä¸åˆ°è«‹æ±‚çš„è³‡æº",
      "serverError": "ä¼ºæœå™¨ç™¼ç”ŸéŒ¯èª¤",
      "validationFailed": "è³‡æ–™é©—è­‰å¤±æ•—",
      "fileUploadFailed": "æª”æ¡ˆä¸Šå‚³å¤±æ•—",
      "fileTooLarge": "æª”æ¡ˆå¤§å°è¶…éé™åˆ¶",
      "unsupportedFileType": "ä¸æ”¯æ´çš„æª”æ¡ˆé¡å‹"
    },
    "confirm": {
      "delete": "ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚",
      "logout": "ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ",
      "unsavedChanges": "æ‚¨æœ‰æœªå„²å­˜çš„è®Šæ›´ï¼Œç¢ºå®šè¦é›¢é–‹å—ï¼Ÿ",
      "resetForm": "ç¢ºå®šè¦é‡è¨­è¡¨å–®å—ï¼Ÿ",
      "clearData": "ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è³‡æ–™å—ï¼Ÿ"
    }
  },
  "date": {
    "today": "ä»Šå¤©",
    "yesterday": "æ˜¨å¤©",
    "tomorrow": "æ˜å¤©",
    "thisWeek": "æœ¬é€±",
    "lastWeek": "ä¸Šé€±",
    "thisMonth": "æœ¬æœˆ",
    "lastMonth": "ä¸Šæœˆ",
    "thisYear": "ä»Šå¹´",
    "lastYear": "å»å¹´",
    "custom": "è‡ªè¨‚ç¯„åœ",
    "selectDate": "é¸æ“‡æ—¥æœŸ",
    "selectTime": "é¸æ“‡æ™‚é–“",
    "selectDateTime": "é¸æ“‡æ—¥æœŸæ™‚é–“"
  },
  "pagination": {
    "showing": "é¡¯ç¤ºç¬¬ {from} åˆ° {to} ç­†ï¼Œå…± {total} ç­†è¨˜éŒ„",
    "itemsPerPage": "æ¯é é¡¯ç¤º",
    "firstPage": "ç¬¬ä¸€é ",
    "lastPage": "æœ€å¾Œä¸€é ",
    "previousPage": "ä¸Šä¸€é ",
    "nextPage": "ä¸‹ä¸€é ",
    "page": "ç¬¬ {page} é ",
    "of": "å…± {total} é "
  }
}
```

#### è‹±æ–‡ç¿»è­¯æª”æ¡ˆç¯„ä¾‹

```json
// src/i18n/locales/en-US.json
{
  "common": {
    "ok": "OK",
    "cancel": "Cancel",
    "save": "Save",
    "edit": "Edit",
    "delete": "Delete",
    "add": "Add",
    "search": "Search",
    "loading": "Loading...",
    "noData": "No data available",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next",
    "previous": "Previous",
    "submit": "Submit",
    "reset": "Reset",
    "close": "Close",
    "view": "View",
    "download": "Download",
    "upload": "Upload",
    "refresh": "Refresh",
    "filter": "Filter",
    "sort": "Sort",
    "export": "Export",
    "import": "Import"
  },
  "auth": {
    "login": "Login",
    "logout": "Logout",
    "register": "Register",
    "forgotPassword": "Forgot Password",
    "resetPassword": "Reset Password",
    "changePassword": "Change Password",
    "email": "Email",
    "password": "Password",
    "confirmPassword": "Confirm Password",
    "rememberMe": "Remember Me",
    "loginSuccess": "Login successful",
    "loginFailed": "Login failed",
    "logoutSuccess": "Logout successful",
    "invalidCredentials": "Invalid email or password",
    "passwordTooWeak": "Password is too weak",
    "emailExists": "Email already exists",
    "accountNotFound": "Account not found",
    "accountDisabled": "Account has been disabled"
  }
  // ... å…¶ä»–ç¿»è­¯å…§å®¹
}
```

### 8.3 Composables å¤šèªç³»åŠŸèƒ½

#### useI18n Composable

```typescript
// src/composables/useI18n.ts
import { computed } from 'vue';
import { useI18n as useVueI18n } from 'vue-i18n';
import { useAppStore } from '@/stores/app';
import { setLocale, type SupportedLocale, SUPPORTED_LOCALES } from '@/i18n';

export function useI18n() {
  const { t, n, d, tm, rt, locale } = useVueI18n();
  const appStore = useAppStore();

  // ç•¶å‰èªè¨€è³‡è¨Š
  const currentLocale = computed(() => locale.value);
  const currentLanguage = computed(() => 
    SUPPORTED_LOCALES.find(lang => lang.code === locale.value)
  );

  // å¯ç”¨èªè¨€åˆ—è¡¨
  const availableLocales = computed(() => SUPPORTED_LOCALES);

  // åˆ‡æ›èªè¨€
  const switchLocale = (newLocale: SupportedLocale): void => {
    setLocale(newLocale);
  };

  // æ ¼å¼åŒ–æ—¥æœŸæ™‚é–“
  const formatDate = (date: Date | string | number, format: string = 'date'): string => {
    const dateObj = typeof date === 'string' || typeof date === 'number' ? new Date(date) : date;
    return d(dateObj, format);
  };

  const formatDateTime = (date: Date | string | number): string => {
    return formatDate(date, 'long');
  };

  const formatTime = (date: Date | string | number): string => {
    return formatDate(date, 'time');
  };

  // æ ¼å¼åŒ–æ•¸å­—
  const formatNumber = (value: number, format: string = 'decimal'): string => {
    return n(value, format);
  };

  const formatCurrency = (value: number): string => {
    return formatNumber(value, 'currency');
  };

  const formatPercent = (value: number): string => {
    return formatNumber(value / 100, 'percent');
  };

  // è¤‡æ•¸å½¢å¼è™•ç†
  const plural = (count: number, key: string): string => {
    return t(key, count);
  };

  // ç¿»è­¯é¸é …åˆ—è¡¨
  const translateOptions = (options: Array<{ value: any; labelKey: string }>): Array<{ value: any; label: string }> => {
    return options.map(option => ({
      value: option.value,
      label: t(option.labelKey),
    }));
  };

  // å–å¾—ç¿»è­¯ç‰©ä»¶
  const getTranslations = (key: string): any => {
    return tm(key);
  };

  // æª¢æŸ¥ç¿»è­¯éµæ˜¯å¦å­˜åœ¨
  const hasTranslation = (key: string): boolean => {
    try {
      const translation = t(key);
      return translation !== key && translation !== '';
    } catch {
      return false;
    }
  };

  // å‹•æ…‹è¼‰å…¥ç¿»è­¯
  const loadLocaleMessages = async (locale: SupportedLocale): Promise<void> => {
    try {
      const messages = await import(`@/i18n/locales/${locale}.json`);
      const { setLocaleMessage } = useVueI18n();
      setLocaleMessage(locale, messages.default);
    } catch (error) {
      console.error(`Failed to load locale messages for ${locale}:`, error);
    }
  };

  // æ‰¹æ¬¡ç¿»è­¯
  const translateBatch = (keys: string[]): Record<string, string> => {
    const result: Record<string, string> = {};
    keys.forEach(key => {
      result[key] = t(key);
    });
    return result;
  };

  return {
    // åŸºç¤ç¿»è­¯åŠŸèƒ½
    t,
    n,
    d,
    tm,
    rt,

    // èªè¨€è³‡è¨Š
    currentLocale,
    currentLanguage,
    availableLocales,

    // èªè¨€åˆ‡æ›
    switchLocale,

    // æ ¼å¼åŒ–åŠŸèƒ½
    formatDate,
    formatDateTime,
    formatTime,
    formatNumber,
    formatCurrency,
    formatPercent,

    // é€²éšåŠŸèƒ½
    plural,
    translateOptions,
    getTranslations,
    hasTranslation,
    loadLocaleMessages,
    translateBatch,
  };
}
```

#### useFormValidation å¤šèªç³»é©—è­‰

```typescript
// src/composables/useFormValidation.ts
import { computed } from 'vue';
import { useI18n } from './useI18n';

export interface ValidationRule {
  required?: boolean;
  minLength?: number;
  maxLength?: number;
  min?: number;
  max?: number;
  pattern?: RegExp;
  email?: boolean;
  phone?: boolean;
  url?: boolean;
  numeric?: boolean;
  alpha?: boolean;
  alphaNum?: boolean;
  sameAs?: string;
  custom?: (value: any) => boolean | string;
}

export function useFormValidation() {
  const { t } = useI18n();

  const createValidator = (rules: ValidationRule) => {
    return (value: any, formData?: Record<string, any>): string | true => {
      // Required é©—è­‰
      if (rules.required && (!value || value === '' || value === null || value === undefined)) {
        return t('form.validation.required');
      }

      // å¦‚æœå€¼ç‚ºç©ºä¸”ä¸æ˜¯å¿…å¡«ï¼Œå‰‡é€šéé©—è­‰
      if (!value && !rules.required) {
        return true;
      }

      const stringValue = String(value);

      // æœ€å°é•·åº¦é©—è­‰
      if (rules.minLength && stringValue.length < rules.minLength) {
        return t('form.validation.minLength', { min: rules.minLength });
      }

      // æœ€å¤§é•·åº¦é©—è­‰
      if (rules.maxLength && stringValue.length > rules.maxLength) {
        return t('form.validation.maxLength', { max: rules.maxLength });
      }

      // æœ€å°å€¼é©—è­‰
      if (rules.min !== undefined && Number(value) < rules.min) {
        return t('form.validation.min', { min: rules.min });
      }

      // æœ€å¤§å€¼é©—è­‰
      if (rules.max !== undefined && Number(value) > rules.max) {
        return t('form.validation.max', { max: rules.max });
      }

      // æ­£è¦è¡¨é”å¼é©—è­‰
      if (rules.pattern && !rules.pattern.test(stringValue)) {
        return t('form.validation.pattern');
      }

      // é›»å­éƒµä»¶é©—è­‰
      if (rules.email) {
        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailPattern.test(stringValue)) {
          return t('form.validation.email');
        }
      }

      // é›»è©±è™Ÿç¢¼é©—è­‰
      if (rules.phone) {
        const phonePattern = /^[\d\s\-\+\(\)]+$/;
        if (!phonePattern.test(stringValue)) {
          return t('form.validation.phone');
        }
      }

      // URL é©—è­‰
      if (rules.url) {
        try {
          new URL(stringValue);
        } catch {
          return t('form.validation.url');
        }
      }

      // æ•¸å­—é©—è­‰
      if (rules.numeric && isNaN(Number(value))) {
        return t('form.validation.numeric');
      }

      // å­—æ¯é©—è­‰
      if (rules.alpha && !/^[a-zA-Z]+$/.test(stringValue)) {
        return t('form.validation.alpha');
      }

      // å­—æ¯æ•¸å­—é©—è­‰
      if (rules.alphaNum && !/^[a-zA-Z0-9]+$/.test(stringValue)) {
        return t('form.validation.alphaNum');
      }

      // ç›¸åŒå€¼é©—è­‰
      if (rules.sameAs && formData && value !== formData[rules.sameAs]) {
        return t('form.validation.sameAs');
      }

      // è‡ªå®šç¾©é©—è­‰
      if (rules.custom) {
        const result = rules.custom(value);
        if (result !== true) {
          return typeof result === 'string' ? result : t('form.validation.pattern');
        }
      }

      return true;
    };
  };

  // å¸¸ç”¨é©—è­‰è¦å‰‡
  const commonRules = computed(() => ({
    required: createValidator({ required: true }),
    email: createValidator({ required: true, email: true }),
    phone: createValidator({ phone: true }),
    password: createValidator({ required: true, minLength: 8 }),
    confirmPassword: (confirmField: string) => createValidator({ 
      required: true, 
      sameAs: confirmField 
    }),
    numeric: createValidator({ numeric: true }),
    positiveNumber: createValidator({ numeric: true, min: 0 }),
    url: createValidator({ url: true }),
  }));

  return {
    createValidator,
    commonRules,
  };
}
```

### 8.4 èªè¨€åˆ‡æ›çµ„ä»¶

#### èªè¨€é¸æ“‡å™¨çµ„ä»¶

```vue
<!-- src/components/common/LanguageSwitcher.vue -->
<template>
  <div class="language-switcher">
    <AppDropdown
      :model-value="currentLanguage"
      :options="languageOptions"
      :placeholder="$t('nav.selectLanguage')"
      option-label="name"
      option-value="code"
      @update:model-value="handleLanguageChange"
    >
      <template #value="{ value }">
        <div v-if="value" class="flex items-center gap-2">
          <span class="text-lg">{{ getLanguageFlag(value) }}</span>
          <span class="hidden sm:inline">{{ getLanguageName(value) }}</span>
        </div>
      </template>

      <template #option="{ option }">
        <div class="flex items-center gap-2 w-full">
          <span class="text-lg">{{ option.flag }}</span>
          <span>{{ option.name }}</span>
        </div>
      </template>
    </AppDropdown>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue';
import { useI18n } from '@/composables/useI18n';
import AppDropdown from '@/components/ui/AppDropdown.vue';

const { currentLocale, availableLocales, switchLocale } = useI18n();

// èªè¨€é¸é …
const languageOptions = computed(() => availableLocales.value);

// ç•¶å‰èªè¨€
const currentLanguage = computed(() => currentLocale.value);

// å–å¾—èªè¨€æ——å¹Ÿ
const getLanguageFlag = (code: string): string => {
  const language = availableLocales.value.find(lang => lang.code === code);
  return language?.flag || 'ğŸŒ';
};

// å–å¾—èªè¨€åç¨±
const getLanguageName = (code: string): string => {
  const language = availableLocales.value.find(lang => lang.code === code);
  return language?.name || code;
};

// è™•ç†èªè¨€è®Šæ›´
const handleLanguageChange = (locale: string): void => {
  switchLocale(locale as any);
};
</script>

<style scoped>
.language-switcher {
  @apply min-w-[120px];
}

@media (max-width: 640px) {
  .language-switcher {
    @apply min-w-[60px];
  }
}
</style>
```

#### ç¿»è­¯è¼”åŠ©çµ„ä»¶

```vue
<!-- src/components/common/TranslationHelper.vue -->
<template>
  <div v-if="showHelper" class="translation-helper">
    <div class="fixed bottom-4 right-4 z-50">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg border p-4 max-w-sm">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold text-sm">{{ $t('dev.translationHelper') }}</h3>
          <button
            @click="closeHelper"
            class="text-gray-500 hover:text-gray-700 dark:text-gray-400"
          >
            <XMarkIcon class="h-4 w-4" />
          </button>
        </div>
        
        <div class="space-y-2 text-xs">
          <div>
            <span class="font-medium">{{ $t('dev.currentLocale') }}:</span>
            <span class="ml-1">{{ currentLocale }}</span>
          </div>
          
          <div v-if="missingKeys.length > 0">
            <span class="font-medium text-red-600">{{ $t('dev.missingKeys') }}:</span>
            <ul class="mt-1 space-y-1">
              <li
                v-for="key in missingKeys.slice(0, 5)"
                :key="key"
                class="text-red-600 font-mono break-all"
              >
                {{ key }}
              </li>
              <li v-if="missingKeys.length > 5" class="text-gray-500">
                ... {{ missingKeys.length - 5 }} more
              </li>
            </ul>
          </div>

          <div class="pt-2 border-t">
            <button
              @click="exportMissingKeys"
              class="text-blue-600 hover:text-blue-800 underline"
            >
              {{ $t('dev.exportMissingKeys') }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, onUnmounted } from 'vue';
import { XMarkIcon } from '@heroicons/vue/24/outline';
import { useI18n } from '@/composables/useI18n';

const { currentLocale } = useI18n();

const showHelper = ref(false);
const missingKeys = ref<string[]>([]);

// é–‹ç™¼æ¨¡å¼ä¸‹æ‰é¡¯ç¤º
const isDevelopment = computed(() => import.meta.env.DEV);

// ç›£è½ç¿»è­¯éŒ¯èª¤
const handleI18nError = (error: any) => {
  if (error && error.key) {
    if (!missingKeys.value.includes(error.key)) {
      missingKeys.value.push(error.key);
    }
  }
};

// åŒ¯å‡ºç¼ºå¤±çš„ç¿»è­¯éµ
const exportMissingKeys = (): void => {
  const data = {
    locale: currentLocale.value,
    missingKeys: missingKeys.value,
    timestamp: new Date().toISOString(),
  };

  const blob = new Blob([JSON.stringify(data, null, 2)], {
    type: 'application/json',
  });

  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = `missing-translations-${currentLocale.value}-${Date.now()}.json`;
  link.click();
  URL.revokeObjectURL(url);
};

// é—œé–‰åŠ©æ‰‹
const closeHelper = (): void => {
  showHelper.value = false;
  localStorage.setItem('translation-helper-hidden', 'true');
};

onMounted(() => {
  if (isDevelopment.value) {
    const hidden = localStorage.getItem('translation-helper-hidden');
    showHelper.value = !hidden;

    // ç›£è½ç¿»è­¯éŒ¯èª¤ï¼ˆé€™éœ€è¦æ ¹æ“šå¯¦éš›çš„ i18n è¨­å®šä¾†èª¿æ•´ï¼‰
    window.addEventListener('i18n-missing', handleI18nError);

    // å¿«æ·éµé–‹å•ŸåŠ©æ‰‹
    const handleKeydown = (e: KeyboardEvent) => {
      if (e.ctrlKey && e.shiftKey && e.key === 'T') {
        showHelper.value = !showHelper.value;
      }
    };
    window.addEventListener('keydown', handleKeydown);

    onUnmounted(() => {
      window.removeEventListener('i18n-missing', handleI18nError);
      window.removeEventListener('keydown', handleKeydown);
    });
  }
});
</script>
```

---

## 9. æ¸¬è©¦è¦ç¯„

### 9.1 æ¸¬è©¦ç’°å¢ƒè¨­å®š

#### Vitest è¨­å®š

```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  plugins: [vue()],
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./src/test/setup.ts'],
    include: ['src/**/*.{test,spec}.{js,ts,vue}'],
    exclude: [
      'node_modules',
      'dist',
      'e2e',
      'cypress',
      '**/*.d.ts',
    ],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: [
        'node_modules/',
        'src/test/',
        '**/*.d.ts',
        '**/*.config.{js,ts}',
        '**/index.ts',
        'src/main.ts',
      ],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80,
        },
      },
    },
    deps: {
      inline: ['@vue', '@vueuse'],
    },
  },
  resolve: {
    alias: {
      '@': resolve(__dirname, './src'),
    },
  },
});
```

#### æ¸¬è©¦è¨­å®šæª”æ¡ˆ

```typescript
// src/test/setup.ts
import { beforeAll, afterEach, vi } from 'vitest';
import { cleanup } from '@testing-library/vue';
import '@testing-library/jest-dom';

// å…¨åŸŸè¨­å®š
beforeAll(() => {
  // Mock IntersectionObserver
  global.IntersectionObserver = vi.fn().mockImplementation(() => ({
    observe: vi.fn(),
    unobserve: vi.fn(),
    disconnect: vi.fn(),
  }));

  // Mock ResizeObserver
  global.ResizeObserver = vi.fn().mockImplementation(() => ({
    observe: vi.fn(),
    unobserve: vi.fn(),
    disconnect: vi.fn(),
  }));

  // Mock matchMedia
  Object.defineProperty(window, 'matchMedia', {
    writable: true,
    value: vi.fn().mockImplementation(query => ({
      matches: false,
      media: query,
      onchange: null,
      addListener: vi.fn(),
      removeListener: vi.fn(),
      addEventListener: vi.fn(),
      removeEventListener: vi.fn(),
      dispatchEvent: vi.fn(),
    })),
  });

  // Mock localStorage
  const localStorageMock = {
    getItem: vi.fn(),
    setItem: vi.fn(),
    removeItem: vi.fn(),
    clear: vi.fn(),
  };
  vi.stubGlobal('localStorage', localStorageMock);

  // Mock sessionStorage
  const sessionStorageMock = {
    getItem: vi.fn(),
    setItem: vi.fn(),
    removeItem: vi.fn(),
    clear: vi.fn(),
  };
  vi.stubGlobal('sessionStorage', sessionStorageMock);

  // Mock fetch
  global.fetch = vi.fn();

  // Mock console methods for cleaner test output
  vi.spyOn(console, 'warn').mockImplementation(() => {});
  vi.spyOn(console, 'error').mockImplementation(() => {});
});

// æ¸…ç†
afterEach(() => {
  cleanup();
  vi.clearAllMocks();
});
```

#### æ¸¬è©¦å·¥å…·å‡½å¼

```typescript
// src/test/utils.ts
import { render, type RenderOptions } from '@testing-library/vue';
import { createTestingPinia } from '@pinia/testing';
import { vi } from 'vitest';
import { createI18n } from 'vue-i18n';
import type { Component } from 'vue';

// å»ºç«‹æ¸¬è©¦ç”¨çš„ i18n å¯¦ä¾‹
export const createTestI18n = (locale = 'zh-TW', messages = {}) => {
  const defaultMessages = {
    'zh-TW': {
      common: {
        ok: 'ç¢ºå®š',
        cancel: 'å–æ¶ˆ',
        save: 'å„²å­˜',
        edit: 'ç·¨è¼¯',
        delete: 'åˆªé™¤',
      },
      form: {
        validation: {
          required: 'æ­¤æ¬„ä½ç‚ºå¿…å¡«',
          email: 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€',
        },
      },
    },
    'en-US': {
      common: {
        ok: 'OK',
        cancel: 'Cancel',
        save: 'Save',
        edit: 'Edit',
        delete: 'Delete',
      },
      form: {
        validation: {
          required: 'This field is required',
          email: 'Please enter a valid email address',
        },
      },
    },
  };

  return createI18n({
    legacy: false,
    locale,
    messages: { ...defaultMessages, ...messages },
  });
};

// å»ºç«‹æ¸¬è©¦ç”¨çš„ Pinia å¯¦ä¾‹
export const createTestPinia = (options: any = {}) => {
  return createTestingPinia({
    createSpy: vi.fn,
    stubActions: false,
    ...options,
  });
};

// è‡ªå®šç¾© render å‡½å¼
export const renderWithProviders = (
  component: Component,
  options: RenderOptions & {
    piniaOptions?: any;
    i18nOptions?: any;
    routerOptions?: any;
  } = {}
) => {
  const { piniaOptions, i18nOptions, routerOptions, ...renderOptions } = options;

  const globalPlugins = [];

  // åŠ å…¥ Pinia
  globalPlugins.push([createTestPinia(piniaOptions), {}]);

  // åŠ å…¥ i18n
  globalPlugins.push([createTestI18n('zh-TW', i18nOptions), {}]);

  // åŠ å…¥ Router (å¦‚æœéœ€è¦)
  if (routerOptions) {
    const { createRouter, createWebHistory } = require('vue-router');
    const router = createRouter({
      history: createWebHistory(),
      routes: routerOptions.routes || [],
    });
    globalPlugins.push([router, {}]);
  }

  const defaultOptions: RenderOptions = {
    global: {
      plugins: globalPlugins,
      ...renderOptions.global,
    },
    ...renderOptions,
  };

  return render(component, defaultOptions);
};

// Mock API å›æ‡‰
export const createMockApiResponse = <T>(data: T, options: any = {}) => {
  return {
    data: data,
    message: options.message || 'success',
    success: options.success !== false,
    code: options.code || 200,
    meta: options.meta,
  };
};

// Mock Promise
export const createMockPromise = <T>(data: T, delay = 0, shouldReject = false) => {
  return new Promise<T>((resolve, reject) => {
    setTimeout(() => {
      if (shouldReject) {
        reject(new Error('Mock error'));
      } else {
        resolve(data);
      }
    }, delay);
  });
};

// ç­‰å¾… DOM æ›´æ–°
export const waitForNextTick = () => {
  return new Promise(resolve => setTimeout(resolve, 0));
};

// è§¸ç™¼äº‹ä»¶
export const triggerEvent = (element: Element, eventType: string, eventData: any = {}) => {
  const event = new CustomEvent(eventType, {
    bubbles: true,
    cancelable: true,
    detail: eventData,
  });
  element.dispatchEvent(event);
};

// æ¨¡æ“¬ç”¨æˆ¶è¼¸å…¥
export const simulateUserInput = async (element: HTMLInputElement, value: string) => {
  element.focus();
  element.value = value;
  element.dispatchEvent(new Event('input', { bubbles: true }));
  element.dispatchEvent(new Event('change', { bubbles: true }));
  await waitForNextTick();
};

// æ¨¡æ“¬æª”æ¡ˆä¸Šå‚³
export const createMockFile = (name: string, type: string, size: number = 1024) => {
  const file = new File([''], name, { type });
  Object.defineProperty(file, 'size', { value: size });
  return file;
};
```

### 9.2 å–®å…ƒæ¸¬è©¦è¦ç¯„

#### çµ„ä»¶æ¸¬è©¦ç¯„ä¾‹

```typescript
// src/components/ui/AppButton.test.ts
import { describe, it, expect, vi } from 'vitest';
import { fireEvent } from '@testing-library/vue';
import { renderWithProviders } from '@/test/utils';
import AppButton from './AppButton.vue';

describe('AppButton', () => {
  it('should render with default props', () => {
    const { getByRole } = renderWithProviders(AppButton, {
      slots: {
        default: 'Click me',
      },
    });

    const button = getByRole('button');
    expect(button).toBeInTheDocument();
    expect(button).toHaveTextContent('Click me');
    expect(button).toHaveClass('btn', 'btn-primary');
  });

  it('should render different variants correctly', () => {
    const { getByRole, rerender } = renderWithProviders(AppButton, {
      props: { variant: 'secondary' },
      slots: { default: 'Button' },
    });

    let button = getByRole('button');
    expect(button).toHaveClass('btn-secondary');

    rerender({ variant: 'danger' });
    button = getByRole('button');
    expect(button).toHaveClass('btn-danger');
  });

  it('should handle different sizes', () => {
    const { getByRole } = renderWithProviders(AppButton, {
      props: { size: 'large' },
      slots: { default: 'Large Button' },
    });

    const button = getByRole('button');
    expect(button).toHaveClass('btn-lg');
  });

  it('should be disabled when loading', () => {
    const { getByRole } = renderWithProviders(AppButton, {
      props: { loading: true },
      slots: { default: 'Loading Button' },
    });

    const button = getByRole('button');
    expect(button).toBeDisabled();
    expect(button).toHaveAttribute('aria-busy', 'true');
  });

  it('should emit click event when clicked', async () => {
    const handleClick = vi.fn();
    const { getByRole } = renderWithProviders(AppButton, {
      props: { onClick: handleClick },
      slots: { default: 'Click me' },
    });

    const button = getByRole('button');
    await fireEvent.click(button);

    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('should not emit click when disabled', async () => {
    const handleClick = vi.fn();
    const { getByRole } = renderWithProviders(AppButton, {
      props: { 
        disabled: true,
        onClick: handleClick,
      },
      slots: { default: 'Disabled Button' },
    });

    const button = getByRole('button');
    await fireEvent.click(button);

    expect(handleClick).not.toHaveBeenCalled();
  });

  it('should show loading spinner when loading', () => {
    const { container } = renderWithProviders(AppButton, {
      props: { loading: true },
      slots: { default: 'Loading' },
    });

    const spinner = container.querySelector('.loading-spinner');
    expect(spinner).toBeInTheDocument();
  });

  it('should support different button types', () => {
    const { getByRole } = renderWithProviders(AppButton, {
      props: { type: 'submit' },
      slots: { default: 'Submit' },
    });

    const button = getByRole('button');
    expect(button).toHaveAttribute('type', 'submit');
  });

  it('should handle icon slots correctly', () => {
    const { container } = renderWithProviders(AppButton, {
      slots: {
        default: 'Button with icon',
        'icon-left': '<svg data-testid="left-icon"></svg>',
        'icon-right': '<svg data-testid="right-icon"></svg>',
      },
    });

    expect(container.querySelector('[data-testid="left-icon"]')).toBeInTheDocument();
    expect(container.querySelector('[data-testid="right-icon"]')).toBeInTheDocument();
  });
});
```

#### Store æ¸¬è©¦ç¯„ä¾‹

```typescript
// src/stores/auth.test.ts
import { describe, it, expect, beforeEach, vi } from 'vitest';
import { setActivePinia, createPinia } from 'pinia';
import { useAuthStore } from './auth';
import { authApi } from '@/api/modules/auth';

// Mock API
vi.mock('@/api/modules/auth', () => ({
  authApi: {
    login: vi.fn(),
    logout: vi.fn(),
    refreshToken: vi.fn(),
    updateProfile: vi.fn(),
  },
}));

// Mock router
const mockPush = vi.fn();
vi.mock('@/router', () => ({
  router: {
    push: mockPush,
  },
}));

describe('Auth Store', () => {
  beforeEach(() => {
    setActivePinia(createPinia());
    vi.clearAllMocks();
    localStorage.clear();
  });

  describe('åˆå§‹ç‹€æ…‹', () => {
    it('should have correct initial state', () => {
      const authStore = useAuthStore();

      expect(authStore.user).toBeNull();
      expect(authStore.token).toBeNull();
      expect(authStore.isAuthenticated).toBe(false);
      expect(authStore.permissions).toEqual([]);
      expect(authStore.loading).toBe(false);
      expect(authStore.error).toBeNull();
    });

    it('should load data from localStorage on initialization', () => {
      const mockUser = { id: 1, name: 'Test User', email: 'test@example.com' };
      const mockToken = 'mock-token';

      localStorage.setItem('user_data', JSON.stringify(mockUser));
      localStorage.setItem('auth_token', mockToken);

      const authStore = useAuthStore();

      expect(authStore.user).toEqual(mockUser);
      expect(authStore.token).toBe(mockToken);
      expect(authStore.isAuthenticated).toBe(true);
    });
  });

  describe('ç™»å…¥æµç¨‹', () => {
    it('should login successfully', async () => {
      const mockUser = { id: 1, name: 'Test User', email: 'test@example.com' };
      const mockResponse = {
        data: {
          user: mockUser,
          token: 'access-token',
          refresh_token: 'refresh-token',
          permissions: ['read', 'write'],
        },
      };

      vi.mocked(authApi.login).mockResolvedValue(mockResponse);

      const authStore = useAuthStore();
      const credentials = { email: 'test@example.com', password: 'password' };

      await authStore.login(credentials);

      expect(authStore.user).toEqual(mockUser);
      expect(authStore.token).toBe('access-token');
      expect(authStore.refreshToken).toBe('refresh-token');
      expect(authStore.permissions).toEqual(['read', 'write']);
      expect(authStore.isAuthenticated).toBe(true);
      expect(authStore.loading).toBe(false);
      expect(authStore.error).toBeNull();

      // æª¢æŸ¥ localStorage
      expect(localStorage.getItem('auth_token')).toBe('access-token');
      expect(localStorage.getItem('refresh_token')).toBe('refresh-token');
      expect(localStorage.getItem('user_data')).toBe(JSON.stringify(mockUser));

      // æª¢æŸ¥è·¯ç”±é‡å®šå‘
      expect(mockPush).toHaveBeenCalledWith('/dashboard');
    });

    it('should handle login failure', async () => {
      const error = new Error('Invalid credentials');
      vi.mocked(authApi.login).mockRejectedValue(error);

      const authStore = useAuthStore();
      const credentials = { email: 'test@example.com', password: 'wrong-password' };

      await expect(authStore.login(credentials)).rejects.toThrow('Invalid credentials');

      expect(authStore.user).toBeNull();
      expect(authStore.token).toBeNull();
      expect(authStore.isAuthenticated).toBe(false);
      expect(authStore.loading).toBe(false);
      expect(authStore.error).toBe('Invalid credentials');
    });

    it('should set loading state during login', async () => {
      let resolveLogin: (value: any) => void;
      const loginPromise = new Promise(resolve => {
        resolveLogin = resolve;
      });

      vi.mocked(authApi.login).mockReturnValue(loginPromise);

      const authStore = useAuthStore();
      const credentials = { email: 'test@example.com', password: 'password' };

      const loginCall = authStore.login(credentials);

      // æª¢æŸ¥ loading ç‹€æ…‹
      expect(authStore.loading).toBe(true);

      // å®Œæˆç™»å…¥
      resolveLogin!({
        data: {
          user: { id: 1, name: 'Test User' },
          token: 'token',
          refresh_token: 'refresh',
          permissions: [],
        },
      });

      await loginCall;

      expect(authStore.loading).toBe(false);
    });
  });

  describe('ç™»å‡ºæµç¨‹', () => {
    it('should logout successfully', async () => {
      const authStore = useAuthStore();

      // è¨­å®šåˆå§‹ç™»å…¥ç‹€æ…‹
      authStore.user = { id: 1, name: 'Test User', email: 'test@example.com' };
      authStore.token = 'access-token';
      authStore.refreshToken = 'refresh-token';
      authStore.permissions = ['read', 'write'];

      localStorage.setItem('auth_token', 'access-token');
      localStorage.setItem('refresh_token', 'refresh-token');
      localStorage.setItem('user_data', JSON.stringify(authStore.user));

      vi.mocked(authApi.logout).mockResolvedValue(undefined as any);

      await authStore.logout();

      expect(authStore.user).toBeNull();
      expect(authStore.token).toBeNull();
      expect(authStore.refreshToken).toBeNull();
      expect(authStore.permissions).toEqual([]);
      expect(authStore.isAuthenticated).toBe(false);

      // æª¢æŸ¥ localStorage æ¸…ç†
      expect(localStorage.getItem('auth_token')).toBeNull();
      expect(localStorage.getItem('refresh_token')).toBeNull();
      expect(localStorage.getItem('user_data')).toBeNull();

      // æª¢æŸ¥è·¯ç”±é‡å®šå‘
      expect(mockPush).toHaveBeenCalledWith('/login');
    });

    it('should logout even when API call fails', async () => {
      const authStore = useAuthStore();
      authStore.token = 'access-token';

      vi.mocked(authApi.logout).mockRejectedValue(new Error('API Error'));

      await authStore.logout();

      expect(authStore.user).toBeNull();
      expect(authStore.token).toBeNull();
      expect(authStore.isAuthenticated).toBe(false);
    });
  });

  describe('æ¬Šé™æª¢æŸ¥', () => {
    it('should check permissions correctly', () => {
      const authStore = useAuthStore();
      authStore.permissions = ['read', 'write', 'admin'];

      expect(authStore.checkPermission('read')).toBe(true);
      expect(authStore.checkPermission('delete')).toBe(false);
      expect(authStore.hasAnyPermission(['read', 'delete'])).toBe(true);
      expect(authStore.hasAnyPermission(['delete', 'modify'])).toBe(false);
      expect(authStore.hasAllPermissions(['read', 'write'])).toBe(true);
      expect(authStore.hasAllPermissions(['read', 'delete'])).toBe(false);
    });

    it('should handle wildcard permissions', () => {
      const authStore = useAuthStore();
      authStore.permissions = ['*'];

      expect(authStore.checkPermission('any-permission')).toBe(true);
    });
  });

  describe('Token åˆ·æ–°', () => {
    it('should refresh token successfully', async () => {
      const authStore = useAuthStore();
      authStore.refreshToken = 'refresh-token';

      const mockResponse = {
        data: {
          token: 'new-access-token',
          refresh_token: 'new-refresh-token',
        },
      };

      vi.mocked(authApi.refreshToken).mockResolvedValue(mockResponse);

      const newToken = await authStore.refreshAccessToken();

      expect(newToken).toBe('new-access-token');
      expect(authStore.token).toBe('new-access-token');
      expect(authStore.refreshToken).toBe('new-refresh-token');

      expect(localStorage.getItem('auth_token')).toBe('new-access-token');
      expect(localStorage.getItem('refresh_token')).toBe('new-refresh-token');
    });

    it('should logout when refresh token is invalid', async () => {
      const authStore = useAuthStore();
      authStore.refreshToken = 'invalid-refresh-token';

      vi.mocked(authApi.refreshToken).mockRejectedValue(new Error('Invalid refresh token'));

      await expect(authStore.refreshAccessToken()).rejects.toThrow('ç™»å…¥å·²éæœŸï¼Œè«‹é‡æ–°ç™»å…¥');

      expect(authStore.user).toBeNull();
      expect(authStore.token).toBeNull();
      expect(authStore.isAuthenticated).toBe(false);
    });

    it('should throw error when no refresh token', async () => {
      const authStore = useAuthStore();
      authStore.refreshToken = null;

      await expect(authStore.refreshAccessToken()).rejects.toThrow('æ²’æœ‰ refresh token');
    });
  });
});
```

#### Composable æ¸¬è©¦ç¯„ä¾‹

```typescript
// src/composables/useApi.test.ts
import { describe, it, expect, beforeEach, vi } from 'vitest';
import { ref } from 'vue';
import { useApi } from './useApi';
import { createMockApiResponse, createMockPromise } from '@/test/utils';

describe('useApi', () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it('should initialize with default state', () => {
    const mockApiFunction = vi.fn();
    const { data, loading, error } = useApi(mockApiFunction);

    expect(data.value).toBeNull();
    expect(loading.value).toBe(false);
    expect(error.value).toBeNull();
  });

  it('should execute API function successfully', async () => {
    const mockData = { id: 1, name: 'Test' };
    const mockResponse = createMockApiResponse(mockData);
    const mockApiFunction = vi.fn().mockResolvedValue(mockResponse);

    const { data, loading, error, execute } = useApi(mockApiFunction);

    const result = await execute('test-param');

    expect(mockApiFunction).toHaveBeenCalledWith('test-param');
    expect(data.value).toEqual(mockData);
    expect(loading.value).toBe(false);
    expect(error.value).toBeNull();
    expect(result).toEqual(mockData);
  });

  it('should handle API function errors', async () => {
    const mockError = new Error('API Error');
    const mockApiFunction = vi.fn().mockRejectedValue(mockError);

    const { data, loading, error, execute } = useApi(mockApiFunction);

    await expect(execute()).rejects.toThrow('API Error');

    expect(data.value).toBeNull();
    expect(loading.value).toBe(false);
    expect(error.value).toEqual(mockError);
  });

  it('should set loading state correctly', async () => {
    let resolvePromise: (value: any) => void;
    const mockPromise = new Promise(resolve => {
      resolvePromise = resolve;
    });
    const mockApiFunction = vi.fn().mockReturnValue(mockPromise);

    const { loading, execute } = useApi(mockApiFunction);

    const executePromise = execute();

    expect(loading.value).toBe(true);

    resolvePromise!(createMockApiResponse({ test: 'data' }));
    await executePromise;

    expect(loading.value).toBe(false);
  });

  it('should call onSuccess callback', async () => {
    const mockData = { id: 1, name: 'Test' };
    const mockResponse = createMockApiResponse(mockData);
    const mockApiFunction = vi.fn().mockResolvedValue(mockResponse);
    const onSuccess = vi.fn();

    const { execute } = useApi(mockApiFunction, { onSuccess });

    await execute();

    expect(onSuccess).toHaveBeenCalledWith(mockData);
  });

  it('should call onError callback', async () => {
    const mockError = new Error('API Error');
    const mockApiFunction = vi.fn().mockRejectedValue(mockError);
    const onError = vi.fn();

    const { execute } = useApi(mockApiFunction, { onError });

    await expect(execute()).rejects.toThrow();

    expect(onError).toHaveBeenCalledWith(mockError);
  });

  it('should execute immediately when immediate option is true', async () => {
    const mockData = { id: 1, name: 'Test' };
    const mockResponse = createMockApiResponse(mockData);
    const mockApiFunction = vi.fn().mockResolvedValue(mockResponse);

    useApi(mockApiFunction, { immediate: true });

    // ç­‰å¾… Promise å®Œæˆ
    await new Promise(resolve => setTimeout(resolve, 0));

    expect(mockApiFunction).toHaveBeenCalled();
  });

  it('should refresh with last arguments', async () => {
    const mockData = { id: 1, name: 'Test' };
    const mockResponse = createMockApiResponse(mockData);
    const mockApiFunction = vi.fn().mockResolvedValue(mockResponse);

    const { execute, refresh } = useApi(mockApiFunction);

    await execute('param1', 'param2');
    mockApiFunction.mockClear();

    await refresh();

    expect(mockApiFunction).toHaveBeenCalledWith('param1', 'param2');
  });

  it('should reset state correctly', () => {
    const mockApiFunction = vi.fn();
    const { data, loading, error, reset } = useApi(mockApiFunction, {
      initialData: { test: 'initial' },
    });

    // è¨­å®šä¸€äº›ç‹€æ…‹
    data.value = { test: 'modified' };
    loading.value = true;
    error.value = new Error('Test error');

    reset();

    expect(data.value).toEqual({ test: 'initial' });
    expect(loading.value).toBe(false);
    expect(error.value).toBeNull();
  });
});
```

### 9.3 æ•´åˆæ¸¬è©¦è¦ç¯„

#### çµ„ä»¶æ•´åˆæ¸¬è©¦

```typescript
// src/components/user/UserForm.test.ts
import { describe, it, expect, beforeEach, vi } from 'vitest';
import { fireEvent, waitFor } from '@testing-library/vue';
import { renderWithProviders, simulateUserInput } from '@/test/utils';
import UserForm from './UserForm.vue';
import { userApi } from '@/api/modules/user';

// Mock API
vi.mock('@/api/modules/user', () => ({
  userApi: {
    createUser: vi.fn(),
    updateUser: vi.fn(),
    getUser: vi.fn(),
  },
}));

describe('UserForm Integration', () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  describe('å»ºç«‹æ–°ä½¿ç”¨è€…', () => {
    it('should create user successfully', async () => {
      const mockUser = {
        id: 1,
        name: 'John Doe',
        email: 'john@example.com',
        role: 'user',
      };

      vi.mocked(userApi.createUser).mockResolvedValue({
        data: mockUser,
        message: 'success',
        success: true,
        code: 200,
      });

      const onSuccess = vi.fn();
      const { getByLabelText, getByRole } = renderWithProviders(UserForm, {
        props: {
          mode: 'create',
          onSuccess,
        },
      });

      // å¡«å¯«è¡¨å–®
      const nameInput = getByLabelText('å§“å') as HTMLInputElement;
      const emailInput = getByLabelText('é›»å­éƒµä»¶') as HTMLInputElement;
      const roleSelect = getByLabelText('è§’è‰²') as HTMLSelectElement;

      await simulateUserInput(nameInput, 'John Doe');
      await simulateUserInput(emailInput, 'john@example.com');
      await fireEvent.change(roleSelect, { target: { value: 'user' } });

      // æäº¤è¡¨å–®
      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      await waitFor(() => {
        expect(userApi.createUser).toHaveBeenCalledWith({
          name: 'John Doe',
          email: 'john@example.com',
          role: 'user',
        });
      });

      expect(onSuccess).toHaveBeenCalledWith(mockUser);
    });

    it('should show validation errors for invalid input', async () => {
      const { getByLabelText, getByRole, findByText } = renderWithProviders(UserForm, {
        props: { mode: 'create' },
      });

      // æäº¤ç©ºè¡¨å–®
      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      // æª¢æŸ¥é©—è­‰éŒ¯èª¤
      await findByText('æ­¤æ¬„ä½ç‚ºå¿…å¡«');
      expect(userApi.createUser).not.toHaveBeenCalled();
    });

    it('should handle API errors gracefully', async () => {
      vi.mocked(userApi.createUser).mockRejectedValue(new Error('Server error'));

      const { getByLabelText, getByRole, findByText } = renderWithProviders(UserForm, {
        props: { mode: 'create' },
      });

      // å¡«å¯«è¡¨å–®
      const nameInput = getByLabelText('å§“å') as HTMLInputElement;
      const emailInput = getByLabelText('é›»å­éƒµä»¶') as HTMLInputElement;

      await simulateUserInput(nameInput, 'John Doe');
      await simulateUserInput(emailInput, 'john@example.com');

      // æäº¤è¡¨å–®
      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      // æª¢æŸ¥éŒ¯èª¤è¨Šæ¯
      await findByText('Server error');
    });
  });

  describe('ç·¨è¼¯ç¾æœ‰ä½¿ç”¨è€…', () => {
    it('should load existing user data', async () => {
      const existingUser = {
        id: 1,
        name: 'Jane Doe',
        email: 'jane@example.com',
        role: 'admin',
      };

      vi.mocked(userApi.getUser).mockResolvedValue({
        data: existingUser,
        message: 'success',
        success: true,
        code: 200,
      });

      const { getByDisplayValue } = renderWithProviders(UserForm, {
        props: {
          mode: 'edit',
          userId: 1,
        },
      });

      await waitFor(() => {
        expect(getByDisplayValue('Jane Doe')).toBeInTheDocument();
        expect(getByDisplayValue('jane@example.com')).toBeInTheDocument();
      });

      expect(userApi.getUser).toHaveBeenCalledWith(1);
    });

    it('should update user successfully', async () => {
      const existingUser = {
        id: 1,
        name: 'Jane Doe',
        email: 'jane@example.com',
        role: 'admin',
      };

      const updatedUser = {
        ...existingUser,
        name: 'Jane Smith',
      };

      vi.mocked(userApi.getUser).mockResolvedValue({
        data: existingUser,
        message: 'success',
        success: true,
        code: 200,
      });

      vi.mocked(userApi.updateUser).mockResolvedValue({
        data: updatedUser,
        message: 'success',
        success: true,
        code: 200,
      });

      const onSuccess = vi.fn();
      const { getByDisplayValue, getByRole } = renderWithProviders(UserForm, {
        props: {
          mode: 'edit',
          userId: 1,
          onSuccess,
        },
      });

      // ç­‰å¾…è³‡æ–™è¼‰å…¥
      await waitFor(() => {
        expect(getByDisplayValue('Jane Doe')).toBeInTheDocument();
      });

      // ä¿®æ”¹å§“å
      const nameInput = getByDisplayValue('Jane Doe') as HTMLInputElement;
      await simulateUserInput(nameInput, 'Jane Smith');

      // æäº¤è¡¨å–®
      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      await waitFor(() => {
        expect(userApi.updateUser).toHaveBeenCalledWith(1, {
          name: 'Jane Smith',
          email: 'jane@example.com',
          role: 'admin',
        });
      });

      expect(onSuccess).toHaveBeenCalledWith(updatedUser);
    });
  });

  describe('è¡¨å–®é©—è­‰', () => {
    it('should validate email format', async () => {
      const { getByLabelText, getByRole, findByText } = renderWithProviders(UserForm, {
        props: { mode: 'create' },
      });

      const emailInput = getByLabelText('é›»å­éƒµä»¶') as HTMLInputElement;
      await simulateUserInput(emailInput, 'invalid-email');

      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      await findByText('è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€');
    });

    it('should validate required fields', async () => {
      const { getByLabelText, getByRole, findAllByText } = renderWithProviders(UserForm, {
        props: { mode: 'create' },
      });

      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      const errorMessages = await findAllByText('æ­¤æ¬„ä½ç‚ºå¿…å¡«');
      expect(errorMessages.length).toBeGreaterThan(0);
    });
  });

  describe('è¡¨å–®ç‹€æ…‹ç®¡ç†', () => {
    it('should show loading state during submission', async () => {
      let resolveCreate: (value: any) => void;
      const createPromise = new Promise(resolve => {
        resolveCreate = resolve;
      });

      vi.mocked(userApi.createUser).mockReturnValue(createPromise);

      const { getByLabelText, getByRole, queryByText } = renderWithProviders(UserForm, {
        props: { mode: 'create' },
      });

      // å¡«å¯«è¡¨å–®
      const nameInput = getByLabelText('å§“å') as HTMLInputElement;
      await simulateUserInput(nameInput, 'John Doe');

      const emailInput = getByLabelText('é›»å­éƒµä»¶') as HTMLInputElement;
      await simulateUserInput(emailInput, 'john@example.com');

      // æäº¤è¡¨å–®
      const submitButton = getByRole('button', { name: 'å„²å­˜' });
      await fireEvent.click(submitButton);

      // æª¢æŸ¥è¼‰å…¥ç‹€æ…‹
      expect(queryByText('è¼‰å…¥ä¸­...')).toBeInTheDocument();
      expect(submitButton).toBeDisabled();

      // å®Œæˆè«‹æ±‚
      resolveCreate!({
        data: { id: 1, name: 'John Doe', email: 'john@example.com' },
        message: 'success',
        success: true,
        code: 200,
      });

      await waitFor(() => {
        expect(queryByText('è¼‰å…¥ä¸­...')).not.toBeInTheDocument();
        expect(submitButton).not.toBeDisabled();
      });
    });

    it('should disable form during loading', async () => {
      vi.mocked(userApi.getUser).mockReturnValue(new Promise(() => {})); // æ°¸ä¸è§£æ±ºçš„ Promise

      const { getByLabelText } = renderWithProviders(UserForm, {
        props: {
          mode: 'edit',
          userId: 1,
        },
      });

      // ç­‰å¾…çµ„ä»¶æ¸²æŸ“
      await new Promise(resolve => setTimeout(resolve, 0));

      const nameInput = getByLabelText('å§“å') as HTMLInputElement;
      expect(nameInput).toBeDisabled();
    });
  });
});
```

### 9.4 ç«¯åˆ°ç«¯æ¸¬è©¦è¦ç¯„

#### Cypress è¨­å®š

```typescript
// cypress.config.ts
import { defineConfig } from 'cypress';

export default defineConfig({
  e2e: {
    baseUrl: 'http://localhost:5173',
    viewportWidth: 1280,
    viewportHeight: 720,
    video: true,
    screenshotOnRunFailure: true,
    defaultCommandTimeout: 10000,
    requestTimeout: 15000,
    responseTimeout: 15000,
    supportFile: 'cypress/support/e2e.ts',
    specPattern: 'cypress/e2e/**/*.cy.{js,jsx,ts,tsx}',
    setupNodeEvents(on, config) {
      // é€™è£¡å¯ä»¥åŠ å…¥è‡ªå®šç¾©æ’ä»¶
      return config;
    },
  },
  component: {
    devServer: {
      framework: 'vue',
      bundler: 'vite',
    },
    supportFile: 'cypress/support/component.ts',
    specPattern: 'src/**/*.cy.{js,jsx,ts,tsx}',
  },
});
```

#### Cypress æ”¯æ´æª”æ¡ˆ

```typescript
// cypress/support/e2e.ts
import './commands';

// å…¨åŸŸè¨­å®š
Cypress.on('uncaught:exception', (err, runnable) => {
  // å¿½ç•¥æŸäº›éé—œéµéŒ¯èª¤
  if (err.message.includes('ResizeObserver loop limit exceeded')) {
    return false;
  }
  return true;
});

// åœ¨æ¯å€‹æ¸¬è©¦å‰æ¸…ç†
beforeEach(() => {
  // æ¸…ç† localStorage å’Œ sessionStorage
  cy.clearLocalStorage();
  cy.clearAllSessionStorage();
  
  // æ¸…ç† cookies
  cy.clearCookies();
  
  // é‡è¨­ç¶²è·¯æ””æˆª
  cy.intercept('GET', '**/api/**', { fixture: 'empty.json' }).as('apiCall');
});
```

#### è‡ªå®šç¾© Cypress å‘½ä»¤

```typescript
// cypress/support/commands.ts
declare global {
  namespace Cypress {
    interface Chainable {
      /**
       * ç™»å…¥ç”¨æˆ¶
       */
      login(email?: string, password?: string): Chainable<void>;
      
      /**
       * ç™»å‡ºç”¨æˆ¶
       */
      logout(): Chainable<void>;
      
      /**
       * ç­‰å¾… API è«‹æ±‚å®Œæˆ
       */
      waitForApi(alias?: string): Chainable<void>;
      
      /**
       * å¡«å¯«è¡¨å–®æ¬„ä½
       */
      fillForm(formData: Record<string, string>): Chainable<void>;
      
      /**
       * æª¢æŸ¥é€šçŸ¥è¨Šæ¯
       */
      checkNotification(type: 'success' | 'error' | 'warning' | 'info', message?: string): Chainable<void>;
      
      /**
       * æª¢æŸ¥è¡¨æ ¼å…§å®¹
       */
      checkTableData(selector: string, expectedData: string[][]): Chainable<void>;
      
      /**
       * æ¨¡æ“¬æª”æ¡ˆä¸Šå‚³
       */
      uploadFile(selector: string, fileName: string, fileType?: string): Chainable<void>;
    }
  }
}

Cypress.Commands.add('login', (email = 'admin@example.com', password = 'password123') => {
  cy.intercept('POST', '**/api/auth/login', {
    statusCode: 200,
    body: {
      data: {
        user: {
          id: 1,
          name: 'Admin User',
          email: email,
          role: 'admin',
        },
        token: 'mock-jwt-token',
        refresh_token: 'mock-refresh-token',
        permissions: ['*'],
      },
      message: 'Login successful',
      success: true,
      code: 200,
    },
  }).as('loginRequest');

  cy.visit('/login');
  cy.get('[data-testid="email-input"]').type(email);
  cy.get('[data-testid="password-input"]').type(password);
  cy.get('[data-testid="login-button"]').click();
  
  cy.wait('@loginRequest');
  cy.url().should('include', '/dashboard');
});

Cypress.Commands.add('logout', () => {
  cy.intercept('POST', '**/api/auth/logout', {
    statusCode: 200,
    body: { message: 'Logout successful', success: true },
  }).as('logoutRequest');

  cy.get('[data-testid="user-menu"]').click();
  cy.get('[data-testid="logout-button"]').click();
  
  cy.wait('@logoutRequest');
  cy.url().should('include', '/login');
});

Cypress.Commands.add('waitForApi', (alias = 'apiCall') => {
  cy.wait(`@${alias}`);
});

Cypress.Commands.add('fillForm', (formData: Record<string, string>) => {
  Object.entries(formData).forEach(([field, value]) => {
    cy.get(`[data-testid="${field}-input"]`).clear().type(value);
  });
});

Cypress.Commands.add('checkNotification', (type: string, message?: string) => {
  cy.get(`[data-testid="notification-${type}"]`).should('be.visible');
  if (message) {
    cy.get(`[data-testid="notification-${type}"]`).should('contain.text', message);
  }
});

Cypress.Commands.add('checkTableData', (selector: string, expectedData: string[][]) => {
  cy.get(selector).within(() => {
    expectedData.forEach((rowData, rowIndex) => {
      cy.get('tbody tr').eq(rowIndex).within(() => {
        rowData.forEach((cellData, cellIndex) => {
          cy.get('td').eq(cellIndex).should('contain.text', cellData);
        });
      });
    });
  });
});

Cypress.Commands.add('uploadFile', (selector: string, fileName: string, fileType = 'image/png') => {
  cy.fixture(fileName, 'base64').then(fileContent => {
    cy.get(selector).selectFile({
      contents: Cypress.Buffer.from(fileContent, 'base64'),
      fileName: fileName,
      mimeType: fileType,
    }, { force: true });
  });
});
```

#### E2E æ¸¬è©¦ç¯„ä¾‹

```typescript
// cypress/e2e/user-management.cy.ts
describe('ä½¿ç”¨è€…ç®¡ç†', () => {
  beforeEach(() => {
    // è¨­å®š API æ””æˆª
    cy.intercept('GET', '**/api/users', { fixture: 'users.json' }).as('getUsers');
    cy.intercept('POST', '**/api/users', { fixture: 'user-create.json' }).as('createUser');
    cy.intercept('PUT', '**/api/users/*', { fixture: 'user-update.json' }).as('updateUser');
    cy.intercept('DELETE', '**/api/users/*', { statusCode: 200, body: { success: true } }).as('deleteUser');
    
    cy.login();
  });

  describe('ä½¿ç”¨è€…åˆ—è¡¨é é¢', () => {
    it('æ‡‰è©²é¡¯ç¤ºä½¿ç”¨è€…åˆ—è¡¨', () => {
      cy.visit('/users');
      cy.wait('@getUsers');

      // æª¢æŸ¥é é¢æ¨™é¡Œ
      cy.get('[data-testid="page-title"]').should('contain.text', 'ä½¿ç”¨è€…ç®¡ç†');

      // æª¢æŸ¥è¡¨æ ¼æ¨™é¡Œ
      cy.get('[data-testid="users-table"]').within(() => {
        cy.get('thead tr th').should('contain.text', 'å§“å');
        cy.get('thead tr th').should('contain.text', 'é›»å­éƒµä»¶');
        cy.get('thead tr th').should('contain.text', 'è§’è‰²');
        cy.get('thead tr th').should('contain.text', 'ç‹€æ…‹');
        cy.get('thead tr th').should('contain.text', 'æ“ä½œ');
      });

      // æª¢æŸ¥è¡¨æ ¼è³‡æ–™
      cy.checkTableData('[data-testid="users-table"]', [
        ['John Doe', 'john@example.com', 'ç®¡ç†å“¡', 'å•Ÿç”¨'],
        ['Jane Smith', 'jane@example.com', 'ä½¿ç”¨è€…', 'å•Ÿç”¨'],
      ]);
    });

    it('æ‡‰è©²æ”¯æ´æœå°‹åŠŸèƒ½', () => {
      cy.visit('/users');
      cy.wait('@getUsers');

      // è¼¸å…¥æœå°‹é—œéµå­—
      cy.get('[data-testid="search-input"]').type('John');
      cy.get('[data-testid="search-button"]').click();

      // æª¢æŸ¥æœå°‹çµæœ
      cy.get('[data-testid="users-table"] tbody tr').should('have.length', 1);
      cy.get('[data-testid="users-table"] tbody tr').should('contain.text', 'John Doe');
    });

    it('æ‡‰è©²æ”¯æ´åˆ†é åŠŸèƒ½', () => {
      cy.visit('/users');
      cy.wait('@getUsers');

      // æª¢æŸ¥åˆ†é è³‡è¨Š
      cy.get('[data-testid="pagination-info"]').should('contain.text', 'é¡¯ç¤ºç¬¬ 1 åˆ° 10 ç­†');

      // é»æ“Šä¸‹ä¸€é 
      cy.get('[data-testid="next-page-button"]').click();
      cy.wait('@getUsers');

      // æª¢æŸ¥é ç¢¼è®Šæ›´
      cy.get('[data-testid="current-page"]').should('contain.text', '2');
    });
  });

  describe('æ–°å¢ä½¿ç”¨è€…', () => {
    it('æ‡‰è©²æˆåŠŸå»ºç«‹æ–°ä½¿ç”¨è€…', () => {
      cy.visit('/users');
      cy.get('[data-testid="add-user-button"]').click();

      // æª¢æŸ¥æ˜¯å¦å°å‘æ–°å¢é é¢
      cy.url().should('include', '/users/create');
      cy.get('[data-testid="page-title"]').should('contain.text', 'æ–°å¢ä½¿ç”¨è€…');

      // å¡«å¯«è¡¨å–®
      cy.fillForm({
        name: 'æ–°ä½¿ç”¨è€…',
        email: 'newuser@example.com',
        password: 'password123',
        'confirm-password': 'password123',
      });

      // é¸æ“‡è§’è‰²
      cy.get('[data-testid="role-select"]').select('user');

      // æäº¤è¡¨å–®
      cy.get('[data-testid="submit-button"]').click();
      cy.wait('@createUser');

      // æª¢æŸ¥æˆåŠŸè¨Šæ¯
      cy.checkNotification('success', 'ä½¿ç”¨è€…å»ºç«‹æˆåŠŸ');

      // æª¢æŸ¥æ˜¯å¦å°å›åˆ—è¡¨é 
      cy.url().should('include', '/users');
    });

    it('æ‡‰è©²é©—è­‰è¡¨å–®æ¬„ä½', () => {
      cy.visit('/users/create');

      // æäº¤ç©ºè¡¨å–®
      cy.get('[data-testid="submit-button"]').click();

      // æª¢æŸ¥é©—è­‰éŒ¯èª¤
      cy.get('[data-testid="name-error"]').should('contain.text', 'æ­¤æ¬„ä½ç‚ºå¿…å¡«');
      cy.get('[data-testid="email-error"]').should('contain.text', 'æ­¤æ¬„ä½ç‚ºå¿…å¡«');
      cy.get('[data-testid="password-error"]').should('contain.text', 'æ­¤æ¬„ä½ç‚ºå¿…å¡«');
    });

    it('æ‡‰è©²é©—è­‰é›»å­éƒµä»¶æ ¼å¼', () => {
      cy.visit('/users/create');

      cy.get('[data-testid="email-input"]').type('invalid-email');
      cy.get('[data-testid="submit-button"]').click();

      cy.get('[data-testid="email-error"]').should('contain.text', 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµä»¶åœ°å€');
    });

    it('æ‡‰è©²é©—è­‰å¯†ç¢¼ç¢ºèª', () => {
      cy.visit('/users/create');

      cy.get('[data-testid="password-input"]').type('password123');
      cy.get('[data-testid="confirm-password-input"]').type('different-password');
      cy.get('[data-testid="submit-button"]').click();

      cy.get('[data-testid="confirm-password-error"]').should('contain.text', 'è¼¸å…¥ä¸ä¸€è‡´');
    });
  });

  describe('ç·¨è¼¯ä½¿ç”¨è€…', () => {
    it('æ‡‰è©²è¼‰å…¥ç¾æœ‰ä½¿ç”¨è€…è³‡æ–™', () => {
      cy.intercept('GET', '**/api/users/1', { fixture: 'user-detail.json' }).as('getUser');

      cy.visit('/users');
      cy.get('[data-testid="edit-user-1"]').click();

      cy.wait('@getUser');
      cy.url().should('include', '/users/1/edit');

      // æª¢æŸ¥è¡¨å–®é å¡«è³‡æ–™
      cy.get('[data-testid="name-input"]').should('have.value', 'John Doe');
      cy.get('[data-testid="email-input"]').should('have.value', 'john@example.com');
      cy.get('[data-testid="role-select"]').should('have.value', 'admin');
    });

    it('æ‡‰è©²æˆåŠŸæ›´æ–°ä½¿ç”¨è€…è³‡æ–™', () => {
      cy.intercept('GET', '**/api/users/1', { fixture: 'user-detail.json' }).as('getUser');

      cy.visit('/users/1/edit');
      cy.wait('@getUser');

      // ä¿®æ”¹å§“å
      cy.get('[data-testid="name-input"]').clear().type('Updated Name');

      // æäº¤è¡¨å–®
      cy.get('[data-testid="submit-button"]').click();
      cy.wait('@updateUser');

      // æª¢æŸ¥æˆåŠŸè¨Šæ¯
      cy.checkNotification('success', 'ä½¿ç”¨è€…æ›´æ–°æˆåŠŸ');

      // æª¢æŸ¥æ˜¯å¦å°å›åˆ—è¡¨é 
      cy.url().should('include', '/users');
    });
  });

  describe('åˆªé™¤ä½¿ç”¨è€…', () => {
    it('æ‡‰è©²æˆåŠŸåˆªé™¤ä½¿ç”¨è€…', () => {
      cy.visit('/users');
      cy.wait('@getUsers');

      // é»æ“Šåˆªé™¤æŒ‰éˆ•
      cy.get('[data-testid="delete-user-1"]').click();

      // ç¢ºèªåˆªé™¤
      cy.get('[data-testid="confirm-dialog"]').should('be.visible');
      cy.get('[data-testid="confirm-delete-button"]').click();

      cy.wait('@deleteUser');

      // æª¢æŸ¥æˆåŠŸè¨Šæ¯
      cy.checkNotification('success', 'ä½¿ç”¨è€…åˆªé™¤æˆåŠŸ');

      // æª¢æŸ¥ä½¿ç”¨è€…å¾åˆ—è¡¨ä¸­ç§»é™¤
      cy.get('[data-testid="user-row-1"]').should('not.exist');
    });

    it('æ‡‰è©²å¯ä»¥å–æ¶ˆåˆªé™¤', () => {
      cy.visit('/users');
      cy.wait('@getUsers');

      // é»æ“Šåˆªé™¤æŒ‰éˆ•
      cy.get('[data-testid="delete-user-1"]').click();

      // å–æ¶ˆåˆªé™¤
      cy.get('[data-testid="confirm-dialog"]').should('be.visible');
      cy.get('[data-testid="cancel-delete-button"]').click();

      // æª¢æŸ¥å°è©±æ¡†é—œé–‰
      cy.get('[data-testid="confirm-dialog"]').should('not.exist');

      // æª¢æŸ¥ä½¿ç”¨è€…ä»åœ¨åˆ—è¡¨ä¸­
      cy.get('[data-testid="user-row-1"]').should('exist');
    });
  });

  describe('æ‰¹æ¬¡æ“ä½œ', () => {
    it('æ‡‰è©²æ”¯æ´æ‰¹æ¬¡åˆªé™¤', () => {
      cy.intercept('POST', '**/api/users/batch', { statusCode: 200, body: { success: true } }).as('batchDelete');

      cy.visit('/users');
      cy.wait('@getUsers');

      // é¸æ“‡å¤šå€‹ä½¿ç”¨è€…
      cy.get('[data-testid="select-user-1"]').check();
      cy.get('[data-testid="select-user-2"]').check();

      // æª¢æŸ¥æ‰¹æ¬¡æ“ä½œæŒ‰éˆ•å‡ºç¾
      cy.get('[data-testid="batch-actions"]').should('be.visible');
      cy.get('[data-testid="selected-count"]').should('contain.text', 'å·²é¸æ“‡ 2 ä½ä½¿ç”¨è€…');

      // åŸ·è¡Œæ‰¹æ¬¡åˆªé™¤
      cy.get('[data-testid="batch-delete-button"]').click();
      cy.get('[data-testid="confirm-batch-delete-button"]').click();

      cy.wait('@batchDelete');

      // æª¢æŸ¥æˆåŠŸè¨Šæ¯
      cy.checkNotification('success', 'æ‰¹æ¬¡åˆªé™¤æˆåŠŸ');
    });
  });

  describe('éŸ¿æ‡‰å¼è¨­è¨ˆ', () => {
    it('æ‡‰è©²åœ¨æ‰‹æ©Ÿè£ç½®ä¸Šæ­£å¸¸é‹ä½œ', () => {
      cy.viewport('iphone-x');
      cy.visit('/users');
      cy.wait('@getUsers');

      // æª¢æŸ¥æ‰‹æ©Ÿç‰ˆä½ˆå±€
      cy.get('[data-testid="mobile-menu-button"]').should('be.visible');
      cy.get('[data-testid="desktop-sidebar"]').should('not.be.visible');

      // æª¢æŸ¥è¡¨æ ¼åœ¨æ‰‹æ©Ÿç‰ˆçš„é¡¯ç¤º
      cy.get('[data-testid="users-table"]').should('be.visible');
      cy.get('[data-testid="mobile-user-card"]').should('exist');
    });

    it('æ‡‰è©²åœ¨å¹³æ¿è£ç½®ä¸Šæ­£å¸¸é‹ä½œ', () => {
      cy.viewport('ipad-2');
      cy.visit('/users');
      cy.wait('@getUsers');

      // æª¢æŸ¥å¹³æ¿ç‰ˆä½ˆå±€
      cy.get('[data-testid="tablet-layout"]').should('be.visible');
      cy.get('[data-testid="users-table"]').should('be.visible');
    });
  });
});
```

### 9.5 æ¸¬è©¦æœ€ä½³å¯¦å‹™

#### æ¸¬è©¦è¦†è“‹ç‡è¨­å®š

```typescript
// vitest.config.tsï¼ˆæ“´å±•è¦†è“‹ç‡è¨­å®šï¼‰
export default defineConfig({
  test: {
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html', 'lcov'],
      reportsDirectory: './coverage',
      exclude: [
        'node_modules/',
        'src/test/',
        '**/*.d.ts',
        '**/*.config.{js,ts}',
        '**/index.ts',
        'src/main.ts',
        'src/assets/',
        'src/public/',
        '**/*.stories.{js,ts,vue}',
        '**/*.cy.{js,ts}',
      ],
      include: ['src/**/*.{js,ts,vue}'],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80,
        },
        // ç‰¹å®šæª”æ¡ˆçš„è¦†è“‹ç‡è¦æ±‚
        'src/stores/': {
          branches: 90,
          functions: 90,
          lines: 90,
          statements: 90,
        },
        'src/composables/': {
          branches: 85,
          functions: 85,
          lines: 85,
          statements: 85,
        },
      },
    },
  },
});
```

#### æ¸¬è©¦è³‡æ–™ç®¡ç†

```typescript
// src/test/fixtures/index.ts
export const mockUsers = [
  {
    id: 1,
    name: 'John Doe',
    email: 'john@example.com',
    role: 'admin',
    is_active: true,
    created_at: '2024-01-01T00:00:00Z',
    updated_at: '2024-01-01T00:00:00Z',
  },
  {
    id: 2,
    name: 'Jane Smith',
    email: 'jane@example.com',
    role: 'user',
    is_active: true,
    created_at: '2024-01-02T00:00:00Z',
    updated_at: '2024-01-02T00:00:00Z',
  },
];

export const mockProducts = [
  {
    id: 1,
    name: 'ç”¢å“ A',
    category: 'åˆ†é¡ 1',
    price: 1000,
    stock: 50,
    is_active: true,
    created_at: '2024-01-01T00:00:00Z',
  },
  {
    id: 2,
    name: 'ç”¢å“ B',
    category: 'åˆ†é¡ 2',
    price: 2000,
    stock: 30,
    is_active: true,
    created_at: '2024-01-02T00:00:00Z',
  },
];

export const createMockUser = (overrides: Partial<typeof mockUsers[0]> = {}) => ({
  ...mockUsers[0],
  ...overrides,
});

export const createMockProduct = (overrides: Partial<typeof mockProducts[0]> = {}) => ({
  ...mockProducts[0],
  ...overrides,
});
```

#### æ¸¬è©¦è…³æœ¬è¨­å®š

```json
// package.json
{
  "scripts": {
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:run": "vitest run",
    "test:coverage": "vitest run --coverage",
    "test:watch": "vitest --watch",
    "test:e2e": "cypress run",
    "test:e2e:open": "cypress open",
    "test:e2e:ci": "start-server-and-test dev http://localhost:5173 test:e2e",
    "test:all": "npm run test:run && npm run test:e2e:ci",
    "test:lint": "eslint . --ext .vue,.js,.jsx,.cjs,.mjs,.ts,.tsx,.cts,.mts",
    "test:type": "vue-tsc --noEmit"
  }
}
```

---

## 10. å®‰å…¨è¦ç¯„

### 10.1 èªè­‰èˆ‡æˆæ¬Š

#### JWT Token è™•ç†

```typescript
// src/utils/auth.ts
import { jwtDecode } from 'jwt-decode';

export interface TokenPayload {
  sub: string;
  iat: number;
  exp: number;
  role: string;
  permissions: string[];
}

export class TokenManager {
  private static readonly TOKEN_KEY = 'auth_token';
  private static readonly REFRESH_TOKEN_KEY = 'refresh_token';
  private static readonly TOKEN_EXPIRY_BUFFER = 300; // 5 åˆ†é˜ç·©è¡æ™‚é–“

  /**
   * å„²å­˜ Token
   */
  static setToken(token: string): void {
    // åªåœ¨ HTTPS ç’°å¢ƒä¸‹æˆ–é–‹ç™¼æ¨¡å¼å„²å­˜
    if (this.isSecureContext()) {
      localStorage.setItem(this.TOKEN_KEY, token);
    } else {
      console.warn('Token åªèƒ½åœ¨å®‰å…¨ç’°å¢ƒä¸‹å„²å­˜');
    }
  }

  /**
   * å–å¾— Token
   */
  static getToken(): string | null {
    return localStorage.getItem(this.TOKEN_KEY);
  }

  /**
   * ç§»é™¤ Token
   */
  static removeToken(): void {
    localStorage.removeItem(this.TOKEN_KEY);
    localStorage.removeItem(this.REFRESH_TOKEN_KEY);
  }

  /**
   * é©—è­‰ Token æ ¼å¼
   */
  static validateTokenFormat(token: string): boolean {
    try {
      const parts = token.split('.');
      if (parts.length !== 3) {
        return false;
      }

      // é©—è­‰æ¯å€‹éƒ¨åˆ†éƒ½æ˜¯æœ‰æ•ˆçš„ Base64
      parts.forEach(part => {
        atob(part.replace(/-/g, '+').replace(/_/g, '/'));
      });

      return true;
    } catch {
      return false;
    }
  }

  /**
   * è§£ç¢¼ Token
   */
  static decodeToken(token: string): TokenPayload | null {
    try {
      if (!this.validateTokenFormat(token)) {
        return null;
      }
      return jwtDecode<TokenPayload>(token);
    } catch (error) {
      console.error('Token è§£ç¢¼å¤±æ•—:', error);
      return null;
    }
  }

  /**
   * æª¢æŸ¥ Token æ˜¯å¦éæœŸ
   */
  static isTokenExpired(token: string): boolean {
    const payload = this.decodeToken(token);
    if (!payload) {
      return true;
    }

    const currentTime = Math.floor(Date.now() / 1000);
    return payload.exp <= currentTime;
  }

  /**
   * æª¢æŸ¥ Token æ˜¯å¦å³å°‡éæœŸï¼ˆéœ€è¦åˆ·æ–°ï¼‰
   */
  static shouldRefreshToken(token: string): boolean {
    const payload = this.decodeToken(token);
    if (!payload) {
      return false;
    }

    const currentTime = Math.floor(Date.now() / 1000);
    return payload.exp <= currentTime + this.TOKEN_EXPIRY_BUFFER;
  }

  /**
   * æª¢æŸ¥æ˜¯å¦ç‚ºå®‰å…¨ç’°å¢ƒ
   */
  private static isSecureContext(): boolean {
    return (
      window.location.protocol === 'https:' ||
      window.location.hostname === 'localhost' ||
      window.location.hostname === '127.0.0.1' ||
      import.meta.env.DEV
    );
  }

  /**
   * å–å¾— Token ä¸­çš„ä½¿ç”¨è€…æ¬Šé™
   */
  static getPermissions(token: string): string[] {
    const payload = this.decodeToken(token);
    return payload?.permissions || [];
  }

  /**
   * æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦æœ‰ç‰¹å®šæ¬Šé™
   */
  static hasPermission(token: string, permission: string): boolean {
    const permissions = this.getPermissions(token);
    return permissions.includes('*') || permissions.includes(permission);
  }
}
```

#### è·¯ç”±å®ˆè¡›

```typescript
// src/router/guards.ts
import type { NavigationGuardNext, RouteLocationNormalized } from 'vue-router';
import { useAuthStore } from '@/stores/auth';
import { TokenManager } from '@/utils/auth';

/**
 * èªè­‰å®ˆè¡›
 */
export const authGuard = (
  to: RouteLocationNormalized,
  from: RouteLocationNormalized,
  next: NavigationGuardNext
): void => {
  const authStore = useAuthStore();

  // æª¢æŸ¥æ˜¯å¦éœ€è¦èªè­‰
  if (to.meta.requiresAuth === false) {
    next();
    return;
  }

  // æª¢æŸ¥æ˜¯å¦å·²ç™»å…¥
  if (!authStore.isAuthenticated) {
    next({
      path: '/login',
      query: { redirect: to.fullPath },
    });
    return;
  }

  // æª¢æŸ¥ Token æ˜¯å¦æœ‰æ•ˆ
  const token = authStore.token;
  if (!token || TokenManager.isTokenExpired(token)) {
    authStore.logout();
    next({
      path: '/login',
      query: { redirect: to.fullPath, reason: 'expired' },
    });
    return;
  }

  next();
};

/**
 * æ¬Šé™å®ˆè¡›
 */
export const permissionGuard = (
  to: RouteLocationNormalized,
  from: RouteLocationNormalized,
  next: NavigationGuardNext
): void => {
  const authStore = useAuthStore();
  const requiredPermissions = to.meta.permissions as string[] | undefined;

  // å¦‚æœæ²’æœ‰è¨­å®šæ¬Šé™è¦æ±‚ï¼Œå‰‡å…è¨±é€šé
  if (!requiredPermissions || requiredPermissions.length === 0) {
    next();
    return;
  }

  const token = authStore.token;
  if (!token) {
    next({ path: '/403' });
    return;
  }

  // æª¢æŸ¥æ˜¯å¦æœ‰æ‰€éœ€æ¬Šé™
  const hasPermission = requiredPermissions.some(permission =>
    TokenManager.hasPermission(token, permission)
  );

  if (hasPermission) {
    next();
  } else {
    next({ path: '/403' });
  }
};

/**
 * è§’è‰²å®ˆè¡›
 */
export const roleGuard = (
  to: RouteLocationNormalized,
  from: RouteLocationNormalized,
  next: NavigationGuardNext
): void => {
  const authStore = useAuthStore();
  const requiredRoles = to.meta.roles as string[] | undefined;

  if (!requiredRoles || requiredRoles.length === 0) {
    next();
    return;
  }

  const userRole = authStore.userRole;
  if (!userRole) {
    next({ path: '/403' });
    return;
  }

  if (requiredRoles.includes(userRole)) {
    next();
  } else {
    next({ path: '/403' });
  }
};

/**
 * è¨ªå®¢å®ˆè¡›ï¼ˆåªå…è¨±æœªç™»å…¥ç”¨æˆ¶è¨ªå•ï¼‰
 */
export const guestGuard = (
  to: RouteLocationNormalized,
  from: RouteLocationNormalized,
  next: NavigationGuardNext
): void => {
  const authStore = useAuthStore();

  if (authStore.isAuthenticated) {
    next({ path: '/dashboard' });
  } else {
    next();
  }
};
```

### 10.2 è³‡æ–™é©—è­‰èˆ‡æ¸…ç†

#### è¼¸å…¥é©—è­‰

```typescript
// src/utils/validation.ts
export class InputValidator {
  /**
   * HTML æ¨™ç±¤æ¸…ç†
   */
  static sanitizeHtml(input: string): string {
    const div = document.createElement('div');
    div.textContent = input;
    return div.innerHTML;
  }

  /**
   * SQL æ³¨å…¥é˜²è­·
   */
  static sanitizeSql(input: string): string {
    const sqlKeywords = [
      'SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP', 'CREATE', 'ALTER',
      'UNION', 'EXEC', 'EXECUTE', 'SCRIPT', 'DECLARE', '--', ';', '/*', '*/',
    ];

    let sanitized = input;
    sqlKeywords.forEach(keyword => {
      const regex = new RegExp(keyword, 'gi');
      sanitized = sanitized.replace(regex, '');
    });

    return sanitized.trim();
  }

  /**
   * XSS é˜²è­·
   */
  static sanitizeXss(input: string): string {
    const xssPatterns = [
      /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
      /<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,
      /<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,
      /<embed\b[^<]*>/gi,
      /<link\b[^<]*>/gi,
      /<meta\b[^<]*>/gi,
      /on\w+\s*=\s*"[^"]*"/gi,
      /on\w+\s*=\s*'[^']*'/gi,
      /javascript:/gi,
      /vbscript:/gi,
      /data:text\/html/gi,
    ];

    let sanitized = input;
    xssPatterns.forEach(pattern => {
      sanitized = sanitized.replace(pattern, '');
    });

    return sanitized;
  }

  /**
   * æª”æ¡ˆåç¨±é©—è­‰
   */
  static validateFileName(fileName: string): boolean {
    const invalidChars = /[<>:"/\\|?*]/;
    const reservedNames = [
      'CON', 'PRN', 'AUX', 'NUL',
      'COM1', 'COM2', 'COM3', 'COM4', 'COM5', 'COM6', 'COM7', 'COM8', 'COM9',
      'LPT1', 'LPT2', 'LPT3', 'LPT4', 'LPT5', 'LPT6', 'LPT7', 'LPT8', 'LPT9',
    ];

    if (invalidChars.test(fileName)) {
      return false;
    }

    if (reservedNames.includes(fileName.toUpperCase())) {
      return false;
    }

    return fileName.length > 0 && fileName.length <= 255;
  }

  /**
   * URL é©—è­‰
   */
  static validateUrl(url: string): boolean {
    try {
      const urlObj = new URL(url);
      return ['http:', 'https:'].includes(urlObj.protocol);
    } catch {
      return false;
    }
  }

  /**
   * é›»å­éƒµä»¶é©—è­‰
   */
  static validateEmail(email: string): boolean {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email) && email.length <= 254;
  }

  /**
   * å¯†ç¢¼å¼·åº¦é©—è­‰
   */
  static validatePasswordStrength(password: string): {
    isValid: boolean;
    score: number;
    feedback: string[];
  } {
    const feedback: string[] = [];
    let score = 0;

    // é•·åº¦æª¢æŸ¥
    if (password.length < 8) {
      feedback.push('å¯†ç¢¼é•·åº¦è‡³å°‘éœ€è¦ 8 å€‹å­—å…ƒ');
    } else {
      score += 1;
    }

    // åŒ…å«å¤§å¯«å­—æ¯
    if (!/[A-Z]/.test(password)) {
      feedback.push('å¯†ç¢¼éœ€è¦åŒ…å«è‡³å°‘ä¸€å€‹å¤§å¯«å­—æ¯');
    } else {
      score += 1;
    }

    // åŒ…å«å°å¯«å­—æ¯
    if (!/[a-z]/.test(password)) {
      feedback.push('å¯†ç¢¼éœ€è¦åŒ…å«è‡³å°‘ä¸€å€‹å°å¯«å­—æ¯');
    } else {
      score += 1;
    }

    // åŒ…å«æ•¸å­—
    if (!/\d/.test(password)) {
      feedback.push('å¯†ç¢¼éœ€è¦åŒ…å«è‡³å°‘ä¸€å€‹æ•¸å­—');
    } else {
      score += 1;
    }

    // åŒ…å«ç‰¹æ®Šå­—å…ƒ
    if (!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\?]/.test(password)) {
      feedback.push('å¯†ç¢¼éœ€è¦åŒ…å«è‡³å°‘ä¸€å€‹ç‰¹æ®Šå­—å…ƒ');
    } else {
      score += 1;
    }

    // æª¢æŸ¥å¸¸è¦‹å¯†ç¢¼
    const commonPasswords = [
      '123456', 'password', '123456789', '12345678', '12345',
      '1234567', '1234567890', 'qwerty', 'abc123', 'password123',
    ];

    if (commonPasswords.includes(password.toLowerCase())) {
      feedback.push('è«‹é¿å…ä½¿ç”¨å¸¸è¦‹å¯†ç¢¼');
      score = Math.max(0, score - 2);
    }

    return {
      isValid: score >= 4 && feedback.length === 0,
      score,
      feedback,
    };
  }

  /**
   * æ‰‹æ©Ÿè™Ÿç¢¼é©—è­‰ï¼ˆå°ç£ï¼‰
   */
  static validateTaiwanPhone(phone: string): boolean {
    const phoneRegex = /^09\d{8}$/;
    return phoneRegex.test(phone.replace(/[\s-]/g, ''));
  }

  /**
   * èº«åˆ†è­‰å­—è™Ÿé©—è­‰ï¼ˆå°ç£ï¼‰
   */
  static validateTaiwanId(id: string): boolean {
    const idRegex = /^[A-Z][12]\d{8}$/;
    if (!idRegex.test(id)) {
      return false;
    }

    const letterMap: Record<string, number> = {
      A: 10, B: 11, C: 12, D: 13, E: 14, F: 15, G: 16, H: 17, I: 34, J: 18,
      K: 19, L: 20, M: 21, N: 22, O: 35, P: 23, Q: 24, R: 25, S: 26, T: 27,
      U: 28, V: 29, W: 32, X: 30, Y: 31, Z: 33,
    };

    const letterValue = letterMap[id[0]];
    const digits = id.substring(1).split('').map(Number);

    const checksum = Math.floor(letterValue / 10) +
      (letterValue % 10) * 9 +
      digits[0] * 8 +
      digits[1] * 7 +
      digits[2] * 6 +
      digits[3] * 5 +
      digits[4] * 4 +
      digits[5] * 3 +
      digits[6] * 2 +
      digits[7] * 1 +
      digits[8];

    return checksum % 10 === 0;
  }
}
```

#### Content Security Policy

```typescript
// src/utils/csp.ts
export class CSPManager {
  /**
   * è¨­å®š Content Security Policy
   */
  static setupCSP(): void {
    // å‹•æ…‹è¨­å®š CSP (é€šå¸¸åœ¨ä¼ºæœå™¨ç«¯è¨­å®š)
    const cspDirectives = [
      "default-src 'self'",
      "script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net",
      "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
      "font-src 'self' https://fonts.gstatic.com",
      "img-src 'self' data: https:",
      "connect-src 'self' https://api.example.com",
      "frame-ancestors 'none'",
      "base-uri 'self'",
      "form-action 'self'",
    ];

    const meta = document.createElement('meta');
    meta.httpEquiv = 'Content-Security-Policy';
    meta.content = cspDirectives.join('; ');
    document.head.appendChild(meta);
  }

  /**
   * æª¢æŸ¥æ˜¯å¦é•å CSP
   */
  static monitorCSPViolations(): void {
    document.addEventListener('securitypolicyviolation', (event) => {
      console.error('CSP Violation:', {
        directive: event.violatedDirective,
        blockedURI: event.blockedURI,
        lineNumber: event.lineNumber,
        columnNumber: event.columnNumber,
        sourceFile: event.sourceFile,
      });

      // ç™¼é€åˆ°ç›£æ§æœå‹™
      this.reportCSPViolation(event);
    });
  }

  /**
   * å ±å‘Š CSP é•è¦
   */
  private static reportCSPViolation(event: SecurityPolicyViolationEvent): void {
    fetch('/api/security/csp-report', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        directive: event.violatedDirective,
        blockedURI: event.blockedURI,
        lineNumber: event.lineNumber,
        columnNumber: event.columnNumber,
        sourceFile: event.sourceFile,
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent,
      }),
    }).catch(console.error);
  }
}
```

### 10.3 æª”æ¡ˆä¸Šå‚³å®‰å…¨

#### å®‰å…¨æª”æ¡ˆä¸Šå‚³

```typescript
// src/utils/fileUpload.ts
export interface FileUploadConfig {
  maxSize: number; // bytes
  allowedTypes: string[];
  allowedExtensions: string[];
  scanForMalware?: boolean;
}

export class SecureFileUpload {
  private static readonly DEFAULT_CONFIG: FileUploadConfig = {
    maxSize: 10 * 1024 * 1024, // 10MB
    allowedTypes: [
      'image/jpeg',
      'image/png',
      'image/gif',
      'image/webp',
      'application/pdf',
      'text/plain',
    ],
    allowedExtensions: ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.pdf', '.txt'],
    scanForMalware: true,
  };

  /**
   * é©—è­‰æª”æ¡ˆ
   */
  static async validateFile(
    file: File,
    config: Partial<FileUploadConfig> = {}
  ): Promise<{ isValid: boolean; errors: string[] }> {
    const finalConfig = { ...this.DEFAULT_CONFIG, ...config };
    const errors: string[] = [];

    // æª¢æŸ¥æª”æ¡ˆå¤§å°
    if (file.size > finalConfig.maxSize) {
      errors.push(`æª”æ¡ˆå¤§å°ä¸å¯è¶…é ${this.formatFileSize(finalConfig.maxSize)}`);
    }

    // æª¢æŸ¥æª”æ¡ˆé¡å‹
    if (!finalConfig.allowedTypes.includes(file.type)) {
      errors.push(`ä¸æ”¯æ´çš„æª”æ¡ˆé¡å‹: ${file.type}`);
    }

    // æª¢æŸ¥æª”æ¡ˆå‰¯æª”å
    const extension = this.getFileExtension(file.name);
    if (!finalConfig.allowedExtensions.includes(extension)) {
      errors.push(`ä¸æ”¯æ´çš„æª”æ¡ˆå‰¯æª”å: ${extension}`);
    }

    // æª¢æŸ¥æª”æ¡ˆåç¨±
    if (!InputValidator.validateFileName(file.name)) {
      errors.push('æª”æ¡ˆåç¨±åŒ…å«ç„¡æ•ˆå­—å…ƒ');
    }

    // æª¢æŸ¥æª”æ¡ˆå…§å®¹ï¼ˆé˜²æ­¢æª”æ¡ˆå½é€ ï¼‰
    const isValidContent = await this.validateFileContent(file);
    if (!isValidContent) {
      errors.push('æª”æ¡ˆå…§å®¹èˆ‡å‰¯æª”åä¸ç¬¦');
    }

    // æƒææƒ¡æ„è»Ÿé«”ï¼ˆå¦‚æœå•Ÿç”¨ï¼‰
    if (finalConfig.scanForMalware) {
      const isSafe = await this.scanForMalware(file);
      if (!isSafe) {
        errors.push('æª”æ¡ˆå¯èƒ½åŒ…å«æƒ¡æ„å…§å®¹');
      }
    }

    return {
      isValid: errors.length === 0,
      errors,
    };
  }

  /**
   * å®‰å…¨ä¸Šå‚³æª”æ¡ˆ
   */
  static async uploadFile(
    file: File,
    uploadUrl: string,
    config: Partial<FileUploadConfig> = {}
  ): Promise<{ success: boolean; url?: string; error?: string }> {
    try {
      // é©—è­‰æª”æ¡ˆ
      const validation = await this.validateFile(file, config);
      if (!validation.isValid) {
        return {
          success: false,
          error: validation.errors.join(', '),
        };
      }

      // é‡æ–°å‘½åæª”æ¡ˆï¼ˆé¿å…è·¯å¾‘éæ­·æ”»æ“Šï¼‰
      const safeFileName = this.generateSafeFileName(file.name);

      // å»ºç«‹ FormData
      const formData = new FormData();
      formData.append('file', file, safeFileName);
      formData.append('originalName', file.name);
      formData.append('size', file.size.toString());
      formData.append('type', file.type);

      // ä¸Šå‚³æª”æ¡ˆ
      const response = await fetch(uploadUrl, {
        method: 'POST',
        body: formData,
        headers: {
          'X-Requested-With': 'XMLHttpRequest',
          // ä¸è¨­å®š Content-Typeï¼Œè®“ç€è¦½å™¨è‡ªå‹•è¨­å®š multipart/form-data
        },
      });

      if (!response.ok) {
        throw new Error(`ä¸Šå‚³å¤±æ•—: ${response.status} ${response.statusText}`);
      }

      const result = await response.json();
      return {
        success: true,
        url: result.url,
      };
    } catch (error) {
      return {
        success: false,
        error: error instanceof Error ? error.message : 'ä¸Šå‚³å¤±æ•—',
      };
    }
  }

  /**
   * å–å¾—æª”æ¡ˆå‰¯æª”å
   */
  private static getFileExtension(fileName: string): string {
    const lastDotIndex = fileName.lastIndexOf('.');
    return lastDotIndex >= 0 ? fileName.substring(lastDotIndex).toLowerCase() : '';
  }

  /**
   * æ ¼å¼åŒ–æª”æ¡ˆå¤§å°
   */
  private static formatFileSize(bytes: number): string {
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    if (bytes === 0) return '0 Bytes';
    const i = Math.floor(Math.log(bytes) / Math.log(1024));
    return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
  }

  /**
   * é©—è­‰æª”æ¡ˆå…§å®¹
   */
  private static async validateFileContent(file: File): Promise<boolean> {
    return new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        const arrayBuffer = e.target?.result as ArrayBuffer;
        const bytes = new Uint8Array(arrayBuffer.slice(0, 8));

        // æª¢æŸ¥æª”æ¡ˆç°½åï¼ˆé­”è¡“æ•¸å­—ï¼‰
        const signatures: Record<string, number[][]> = {
          'image/jpeg': [[0xFF, 0xD8, 0xFF]],
          'image/png': [[0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A]],
          'image/gif': [[0x47, 0x49, 0x46, 0x38], [0x47, 0x49, 0x46, 0x39]],
          'application/pdf': [[0x25, 0x50, 0x44, 0x46]],
        };

        const expectedSignatures = signatures[file.type];
        if (!expectedSignatures) {
          resolve(true); // æœªçŸ¥é¡å‹ï¼Œå…è¨±é€šé
          return;
        }

        const isValid = expectedSignatures.some(signature =>
          signature.every((byte, index) => bytes[index] === byte)
        );

        resolve(isValid);
      };

      reader.onerror = () => resolve(false);
      reader.readAsArrayBuffer(file.slice(0, 8));
    });
  }

  /**
   * æƒææƒ¡æ„è»Ÿé«”ï¼ˆæ¨¡æ“¬ï¼‰
   */
  private static async scanForMalware(file: File): Promise<boolean> {
    // é€™è£¡æ‡‰è©²æ•´åˆçœŸå¯¦çš„æƒ¡æ„è»Ÿé«”æƒææœå‹™
    // ä¾‹å¦‚ VirusTotal API æˆ–å…¶ä»–é˜²æ¯’å¼•æ“

    // æ¨¡æ“¬æƒæéç¨‹
    return new Promise((resolve) => {
      setTimeout(() => {
        // ç°¡å–®çš„å•Ÿç™¼å¼æª¢æŸ¥
        const suspiciousPatterns = [
          'eval(',
          'document.write(',
          '<script',
          'javascript:',
          'vbscript:',
        ];

        const reader = new FileReader();
        reader.onload = (e) => {
          const content = e.target?.result as string;
          const isSuspicious = suspiciousPatterns.some(pattern =>
            content.toLowerCase().includes(pattern)
          );
          resolve(!isSuspicious);
        };

        reader.onerror = () => resolve(false);
        reader.readAsText(file);
      }, 1000);
    });
  }

  /**
   * ç”¢ç”Ÿå®‰å…¨çš„æª”æ¡ˆåç¨±
   */
  private static generateSafeFileName(originalName: string): string {
    const extension = this.getFileExtension(originalName);
    const baseName = originalName.substring(0, originalName.lastIndexOf('.')) || originalName;

    // ç§»é™¤å±éšªå­—å…ƒ
    const safeName = baseName
      .replace(/[^a-zA-Z0-9\-_]/g, '_')
      .substring(0, 50); // é™åˆ¶é•·åº¦

    // åŠ å…¥æ™‚é–“æˆ³é¿å…è¡çª
    const timestamp = Date.now();
    const randomId = Math.random().toString(36).substring(2, 8);

    return `${safeName}_${timestamp}_${randomId}${extension}`;
  }
}
```

---

## 11. ç‰ˆæœ¬æ§åˆ¶èˆ‡å”ä½œè¦ç¯„

### 11.1 Git å·¥ä½œæµç¨‹

#### åˆ†æ”¯ç­–ç•¥

```bash
# ä¸»è¦åˆ†æ”¯
main          # ç”Ÿç”¢ç’°å¢ƒåˆ†æ”¯
develop       # é–‹ç™¼ç’°å¢ƒåˆ†æ”¯

# åŠŸèƒ½åˆ†æ”¯
feature/*     # æ–°åŠŸèƒ½é–‹ç™¼
bugfix/*      # éŒ¯èª¤ä¿®å¾©
hotfix/*      # ç·Šæ€¥ä¿®å¾©
release/*     # ç™¼å¸ƒæº–å‚™
```

#### åˆ†æ”¯å‘½åè¦ç¯„

```bash
# åŠŸèƒ½é–‹ç™¼
feature/user-management
feature/payment-integration
feature/dashboard-redesign

# éŒ¯èª¤ä¿®å¾©
bugfix/login-validation
bugfix/table-pagination

# ç·Šæ€¥ä¿®å¾©
hotfix/security-patch
hotfix/payment-gateway-fix

# ç™¼å¸ƒåˆ†æ”¯
release/v1.2.0
release/v2.0.0-beta
```

#### Commit è¨Šæ¯è¦ç¯„

```bash
# æ ¼å¼: <type>(<scope>): <subject>

# é¡å‹ (type)
feat      # æ–°åŠŸèƒ½
fix       # éŒ¯èª¤ä¿®å¾©
docs      # æ–‡ä»¶æ›´æ–°
style     # ä»£ç¢¼æ ¼å¼åŒ–
refactor  # é‡æ§‹
test      # æ¸¬è©¦ç›¸é—œ
chore     # å»ºç½®å·¥å…·ã€è¼”åŠ©å·¥å…·è®Šå‹•

# ç¯„ä¾‹
feat(auth): æ–°å¢ä½¿ç”¨è€…ç™»å…¥åŠŸèƒ½
fix(table): ä¿®å¾©åˆ†é é¡¯ç¤ºéŒ¯èª¤
docs(api): æ›´æ–° API æ–‡ä»¶
style(button): çµ±ä¸€æŒ‰éˆ•æ¨£å¼
refactor(store): é‡æ§‹ä½¿ç”¨è€…ç‹€æ…‹ç®¡ç†
test(user): æ–°å¢ä½¿ç”¨è€…çµ„ä»¶æ¸¬è©¦
chore(deps): å‡ç´š Vue ç‰ˆæœ¬åˆ° 3.4
```

### 11.2 ç¨‹å¼ç¢¼å¯©æŸ¥

#### Pull Request æ¨¡æ¿

```markdown
## è®Šæ›´æè¿°
<!-- ç°¡è¿°é€™æ¬¡è®Šæ›´çš„å…§å®¹ -->

## è®Šæ›´é¡å‹
- [ ] æ–°åŠŸèƒ½ (feature)
- [ ] éŒ¯èª¤ä¿®å¾© (bugfix)
- [ ] é‡æ§‹ (refactor)
- [ ] æ–‡ä»¶æ›´æ–° (docs)
- [ ] æ¨£å¼èª¿æ•´ (style)
- [ ] æ¸¬è©¦ç›¸é—œ (test)
- [ ] å»ºç½®ç›¸é—œ (chore)

## æ¸¬è©¦
- [ ] å–®å…ƒæ¸¬è©¦å·²é€šé
- [ ] æ•´åˆæ¸¬è©¦å·²é€šé
- [ ] E2E æ¸¬è©¦å·²é€šé
- [ ] æ‰‹å‹•æ¸¬è©¦å·²å®Œæˆ

## æª¢æŸ¥æ¸…å–®
- [ ] ç¨‹å¼ç¢¼ç¬¦åˆå°ˆæ¡ˆé¢¨æ ¼æŒ‡å¼•
- [ ] å·²æ–°å¢/æ›´æ–°ç›¸é—œæ¸¬è©¦
- [ ] å·²æ–°å¢/æ›´æ–°ç›¸é—œæ–‡ä»¶
- [ ] ç„¡ console.log æˆ– debugger
- [ ] å·²è™•ç† TypeScript å‹åˆ¥éŒ¯èª¤
- [ ] å·²æª¢æŸ¥å®‰å…¨æ€§å•é¡Œ

## æˆªåœ–/å½±ç‰‡
<!-- å¦‚æœ‰ UI è®Šæ›´ï¼Œè«‹æä¾›æˆªåœ–æˆ–å½±ç‰‡ -->

## ç›¸é—œ Issue
<!-- é—œè¯çš„ Issue ç·¨è™Ÿ -->
Closes #

## é¡å¤–è³‡è¨Š
<!-- å…¶ä»–éœ€è¦èªªæ˜çš„è³‡è¨Š -->
```

#### Code Review æª¢æŸ¥é»

```typescript
// .github/pull_request_template.md
export const CODE_REVIEW_CHECKLIST = {
  åŠŸèƒ½æ€§: [
    'åŠŸèƒ½æ˜¯å¦æŒ‰éœ€æ±‚æ­£ç¢ºå¯¦ä½œ',
    'é‚Šç•Œæ¢ä»¶æ˜¯å¦å¦¥å–„è™•ç†',
    'éŒ¯èª¤è™•ç†æ˜¯å¦å®Œæ•´',
    'æ•ˆèƒ½æ˜¯å¦ç¬¦åˆè¦æ±‚',
  ],
  ç¨‹å¼ç¢¼å“è³ª: [
    'ç¨‹å¼ç¢¼æ˜¯å¦æ˜“è®€æ˜“æ‡‚',
    'è®Šæ•¸å’Œå‡½å¼å‘½åæ˜¯å¦æ¸…æ¥š',
    'æ˜¯å¦æœ‰é‡è¤‡ç¨‹å¼ç¢¼',
    'æ˜¯å¦éµå¾ª SOLID åŸå‰‡',
  ],
  å®‰å…¨æ€§: [
    'æ˜¯å¦æœ‰å®‰å…¨æ¼æ´',
    'è¼¸å…¥é©—è­‰æ˜¯å¦å®Œæ•´',
    'æ•æ„Ÿè³‡æ–™æ˜¯å¦å¦¥å–„è™•ç†',
    'æ¬Šé™æª¢æŸ¥æ˜¯å¦æ­£ç¢º',
  ],
  æ¸¬è©¦: [
    'æ¸¬è©¦è¦†è“‹ç‡æ˜¯å¦è¶³å¤ ',
    'æ¸¬è©¦æ¡ˆä¾‹æ˜¯å¦åˆç†',
    'æ¸¬è©¦æ˜¯å¦èƒ½æ­£ç¢ºåŸ·è¡Œ',
    'æ˜¯å¦åŒ…å«é‚Šç•Œæ¢ä»¶æ¸¬è©¦',
  ],
  æ–‡ä»¶: [
    'JSDoc æ˜¯å¦å®Œæ•´',
    'README æ˜¯å¦éœ€è¦æ›´æ–°',
    'æ˜¯å¦æœ‰ä½¿ç”¨èªªæ˜',
    'CHANGELOG æ˜¯å¦æ›´æ–°',
  ],
};
```

### 11.3 è‡ªå‹•åŒ–å·¥ä½œæµç¨‹

#### GitHub Actions è¨­å®š

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [18, 20]

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run linting
        run: npm run lint

      - name: Run type checking
        run: npm run type-check

      - name: Run unit tests
        run: npm run test:coverage

      - name: Upload coverage reports
        uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info

      - name: Run E2E tests
        run: npm run test:e2e:ci

  security:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run security audit
        run: npm audit --audit-level high

      - name: Run dependency check
        uses: ossf/scorecard-action@v2
        with:
          results_file: results.sarif
          results_format: sarif

  build:
    runs-on: ubuntu-latest
    needs: [test, security]
    if: github.ref == 'refs/heads/main'

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build application
        run: npm run build

      - name: Deploy to staging
        if: github.ref == 'refs/heads/develop'
        run: |
          echo "Deploy to staging environment"
          # éƒ¨ç½²åˆ°æ¸¬è©¦ç’°å¢ƒçš„æŒ‡ä»¤

      - name: Deploy to production
        if: github.ref == 'refs/heads/main'
        run: |
          echo "Deploy to production environment"
          # éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒçš„æŒ‡ä»¤
```

---

## 12. éƒ¨ç½²èˆ‡ç¶­é‹è¦ç¯„

### 12.1 å»ºç½®è¨­å®š

#### Vite ç”Ÿç”¢å»ºç½®è¨­å®š

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
    },
  },
  build: {
    target: 'es2015',
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false, // ç”Ÿç”¢ç’°å¢ƒå»ºè­°é—œé–‰
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true, // ç§»é™¤ console.log
        drop_debugger: true, // ç§»é™¤ debugger
      },
    },
    rollupOptions: {
      output: {
        manualChunks: {
          vue: ['vue', 'vue-router', 'pinia'],
          ui: ['@headlessui/vue', '@heroicons/vue'],
          utils: ['axios', 'dayjs', 'lodash-es'],
        },
      },
    },
    chunkSizeWarningLimit: 1000,
  },
  server: {
    port: 5173,
    host: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
        secure: false,
      },
    },
  },
  preview: {
    port: 4173,
    host: true,
  },
});
```

#### Docker è¨­å®š

```dockerfile
# Dockerfile
# å»ºç½®éšæ®µ
FROM node:20-alpine AS builder

WORKDIR /app

# è¤‡è£½ package files
COPY package*.json ./
RUN npm ci --only=production

# è¤‡è£½åŸå§‹ç¢¼
COPY . .

# å»ºç½®æ‡‰ç”¨ç¨‹å¼
RUN npm run build

# ç”Ÿç”¢éšæ®µ
FROM nginx:alpine

# è¤‡è£½è‡ªå®šç¾© nginx è¨­å®š
COPY nginx.conf /etc/nginx/nginx.conf

# è¤‡è£½å»ºç½®çµæœ
COPY --from=builder /app/dist /usr/share/nginx/html

# æš´éœ²é€£æ¥åŸ 
EXPOSE 80

# å•Ÿå‹• nginx
CMD ["nginx", "-g", "daemon off;"]
```

```nginx
# nginx.conf
user nginx;
worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # æ—¥èªŒæ ¼å¼
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;

    # åŸºæœ¬è¨­å®š
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;

    # Gzip å£“ç¸®
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/atom+xml
        image/svg+xml;

    # å®‰å…¨æ¨™é ­
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Referrer-Policy "strict-origin-when-cross-origin";

    server {
        listen 80;
        server_name _;
        root /usr/share/nginx/html;
        index index.html;

        # SPA è·¯ç”±æ”¯æ´
        location / {
            try_files $uri $uri/ /index.html;
        }

        # API ä»£ç†
        location /api/ {
            proxy_pass http://backend:8080/api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # éœæ…‹è³‡æºå¿«å–
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }

        # å®‰å…¨è¨­å®š
        location ~ /\. {
            deny all;
        }
    }
}
```

### 12.2 ç’°å¢ƒè®Šæ•¸ç®¡ç†

#### ç’°å¢ƒè¨­å®šæª”æ¡ˆ

```bash
# .env.development
VITE_APP_TITLE=é‡‘èç®¡ç†ç³»çµ± (é–‹ç™¼)
VITE_API_BASE_URL=http://localhost:8080/api
VITE_APP_VERSION=1.0.0-dev
VITE_LOG_LEVEL=debug
VITE_ENABLE_MOCK=true

# .env.staging
VITE_APP_TITLE=é‡‘èç®¡ç†ç³»çµ± (æ¸¬è©¦)
VITE_API_BASE_URL=https://api-staging.example.com/api
VITE_APP_VERSION=1.0.0-staging
VITE_LOG_LEVEL=info
VITE_ENABLE_MOCK=false

# .env.production
VITE_APP_TITLE=é‡‘èç®¡ç†ç³»çµ±
VITE_API_BASE_URL=https://api.example.com/api
VITE_APP_VERSION=1.0.0
VITE_LOG_LEVEL=error
VITE_ENABLE_MOCK=false
```

#### ç’°å¢ƒè¨­å®šç®¡ç†

```typescript
// src/config/env.ts
export interface AppConfig {
  app: {
    title: string;
    version: string;
    environment: string;
  };
  api: {
    baseUrl: string;
    timeout: number;
  };
  logging: {
    level: 'debug' | 'info' | 'warn' | 'error';
    enableConsole: boolean;
  };
  features: {
    enableMock: boolean;
    enableAnalytics: boolean;
    enableDebugTools: boolean;
  };
}

const createConfig = (): AppConfig => {
  const env = import.meta.env;

  return {
    app: {
      title: env.VITE_APP_TITLE || 'é‡‘èç®¡ç†ç³»çµ±',
      version: env.VITE_APP_VERSION || '1.0.0',
      environment: env.MODE || 'development',
    },
    api: {
      baseUrl: env.VITE_API_BASE_URL || '/api',
      timeout: Number(env.VITE_API_TIMEOUT) || 30000,
    },
    logging: {
      level: (env.VITE_LOG_LEVEL as AppConfig['logging']['level']) || 'info',
      enableConsole: env.MODE === 'development',
    },
    features: {
      enableMock: env.VITE_ENABLE_MOCK === 'true',
      enableAnalytics: env.VITE_ENABLE_ANALYTICS === 'true',
      enableDebugTools: env.MODE === 'development',
    },
  };
};

export const config = createConfig();

// é©—è­‰å¿…è¦çš„ç’°å¢ƒè®Šæ•¸
const validateConfig = (): void => {
  const requiredVars = ['VITE_API_BASE_URL'];
  
  for (const varName of requiredVars) {
    if (!import.meta.env[varName]) {
      throw new Error(`Missing required environment variable: ${varName}`);
    }
  }
};

validateConfig();
```

### 12.3 ç›£æ§èˆ‡æ—¥èªŒ

#### å‰ç«¯ç›£æ§è¨­å®š

```typescript
// src/utils/monitoring.ts
interface ErrorInfo {
  message: string;
  stack?: string;
  url: string;
  line?: number;
  column?: number;
  timestamp: string;
  userAgent: string;
  userId?: string;
  sessionId: string;
}

class MonitoringService {
  private sessionId: string;
  private userId?: string;

  constructor() {
    this.sessionId = this.generateSessionId();
    this.setupErrorHandling();
    this.setupPerformanceMonitoring();
  }

  private generateSessionId(): string {
    return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }

  private setupErrorHandling(): void {
    // å…¨åŸŸéŒ¯èª¤è™•ç†
    window.addEventListener('error', (event) => {
      this.reportError({
        message: event.message,
        stack: event.error?.stack,
        url: event.filename,
        line: event.lineno,
        column: event.colno,
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent,
        userId: this.userId,
        sessionId: this.sessionId,
      });
    });

    // Promise éŒ¯èª¤è™•ç†
    window.addEventListener('unhandledrejection', (event) => {
      this.reportError({
        message: `Unhandled Promise Rejection: ${event.reason}`,
        stack: event.reason?.stack,
        url: window.location.href,
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent,
        userId: this.userId,
        sessionId: this.sessionId,
      });
    });
  }

  private setupPerformanceMonitoring(): void {
    // é é¢è¼‰å…¥æ•ˆèƒ½
    window.addEventListener('load', () => {
      setTimeout(() => {
        const perfData = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;
        this.reportPerformance({
          type: 'page_load',
          loadTime: perfData.loadEventEnd - perfData.fetchStart,
          domReady: perfData.domContentLoadedEventEnd - perfData.fetchStart,
          firstByte: perfData.responseStart - perfData.fetchStart,
          url: window.location.href,
          timestamp: new Date().toISOString(),
        });
      }, 1000);
    });

    // Core Web Vitals
    this.observeCoreWebVitals();
  }

  private observeCoreWebVitals(): void {
    // é€™è£¡å¯ä»¥ä½¿ç”¨ web-vitals åº«
    // import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';
  }

  reportError(error: ErrorInfo): void {
    if (config.logging.level === 'error' || config.logging.enableConsole) {
      console.error('Error reported:', error);
    }

    // ç™¼é€åˆ°ç›£æ§æœå‹™
    fetch('/api/monitoring/errors', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(error),
    }).catch(console.error);
  }

  reportPerformance(data: any): void {
    fetch('/api/monitoring/performance', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    }).catch(console.error);
  }

  setUserId(userId: string): void {
    this.userId = userId;
  }
}

export const monitoring = new MonitoringService();
```

---

## 13. ç¨‹å¼ç¢¼å¯©æŸ¥è¦ç¯„

### 13.1 å¯©æŸ¥æµç¨‹

#### å¯©æŸ¥å‰æª¢æŸ¥æ¸…å–®

```typescript
// é–‹ç™¼è€…è‡ªæª¢æ¸…å–®
export const DEVELOPER_CHECKLIST = {
  åŠŸèƒ½å®Œæ•´æ€§: [
    'åŠŸèƒ½æŒ‰ç…§éœ€æ±‚æ–‡ä»¶å¯¦ä½œå®Œæˆ',
    'æ‰€æœ‰é‚Šç•Œæ¢ä»¶éƒ½æœ‰è™•ç†',
    'éŒ¯èª¤è™•ç†æ©Ÿåˆ¶å®Œæ•´',
    'ä½¿ç”¨è€…é«”é©—æµæš¢',
  ],
  ç¨‹å¼ç¢¼å“è³ª: [
    'éµå¾ªå°ˆæ¡ˆç·¨ç¢¼è¦ç¯„',
    'ç„¡ TypeScript ç·¨è­¯éŒ¯èª¤',
    'ç„¡ ESLint è­¦å‘Šæˆ–éŒ¯èª¤',
    'ç¨‹å¼ç¢¼å¯è®€æ€§è‰¯å¥½',
  ],
  æ¸¬è©¦å®Œæ•´æ€§: [
    'å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡é”æ¨™',
    'æ•´åˆæ¸¬è©¦é€šé',
    'E2E æ¸¬è©¦å ´æ™¯è¦†è“‹',
    'æ‰‹å‹•æ¸¬è©¦å®Œæˆ',
  ],
  å®‰å…¨æ€§æª¢æŸ¥: [
    'è¼¸å…¥é©—è­‰å®Œæ•´',
    'ç„¡å®‰å…¨æ¼æ´',
    'æ•æ„Ÿè³‡æ–™è™•ç†å¾—ç•¶',
    'æ¬Šé™æ§åˆ¶æ­£ç¢º',
  ],
  æ•ˆèƒ½å„ªåŒ–: [
    'è¼‰å…¥é€Ÿåº¦æœ€ä½³åŒ–',
    'è¨˜æ†¶é«”ä½¿ç”¨åˆç†',
    'ç„¡æ•ˆèƒ½ç“¶é ¸',
    'éŸ¿æ‡‰å¼è¨­è¨ˆé©é…',
  ],
};
```

#### å¯©æŸ¥è€…æª¢æŸ¥é‡é»

```typescript
// ç¨‹å¼ç¢¼å¯©æŸ¥é‡é»
export const REVIEW_GUIDELINES = {
  æ¶æ§‹è¨­è¨ˆ: {
    çµ„ä»¶æ‹†åˆ†: 'çµ„ä»¶è·è²¬å–®ä¸€ï¼Œå¯é‡ç”¨æ€§é«˜',
    ç‹€æ…‹ç®¡ç†: 'Store è¨­è¨ˆåˆç†ï¼Œè³‡æ–™æµæ¸…æ™°',
    è·¯ç”±è¨­è¨ˆ: 'è·¯ç”±çµæ§‹æ¸…æ¥šï¼Œæ¬Šé™æ§åˆ¶å®Œæ•´',
    APIè¨­è¨ˆ: 'API å‘¼å«é‚è¼¯åˆç†ï¼ŒéŒ¯èª¤è™•ç†å®Œå–„',
  },
  
  ç¨‹å¼ç¢¼é¢¨æ ¼: {
    å‘½åè¦ç¯„: 'è®Šæ•¸ã€å‡½å¼ã€é¡åˆ¥å‘½åæ¸…æ¥šæœ‰æ„ç¾©',
    è¨»è§£æ–‡ä»¶: 'JSDoc è¨»è§£å®Œæ•´ï¼Œè¤‡é›œé‚è¼¯æœ‰èªªæ˜',
    ç¨‹å¼çµæ§‹: 'ç¨‹å¼ç¢¼çµæ§‹æ¸…æ™°ï¼Œæ˜“æ–¼ç†è§£',
    é‡è¤‡ä»£ç¢¼: 'é¿å…é‡è¤‡ç¨‹å¼ç¢¼ï¼Œé©ç•¶æŠ½è±¡åŒ–',
  },
  
  æ•ˆèƒ½è€ƒé‡: {
    æ¸²æŸ“æ•ˆèƒ½: 'é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“',
    è¨˜æ†¶é«”ç®¡ç†: 'é©ç•¶æ¸…ç†äº‹ä»¶ç›£è½å™¨å’Œå®šæ™‚å™¨',
    è³‡æºè¼‰å…¥: 'åœ–ç‰‡å’Œè³‡æºè¼‰å…¥æœ€ä½³åŒ–',
    ç¨‹å¼ç¢¼åˆ†å‰²: 'é©ç•¶çš„ç¨‹å¼ç¢¼åˆ†å‰²å’Œæ‡¶è¼‰å…¥',
  },
  
  ä½¿ç”¨è€…é«”é©—: {
    äº’å‹•å›é¥‹: 'è¼‰å…¥ç‹€æ…‹å’ŒéŒ¯èª¤æç¤ºå®Œæ•´',
    éŸ¿æ‡‰å¼è¨­è¨ˆ: 'å„è¢å¹•å°ºå¯¸é©é…è‰¯å¥½',
    ç„¡éšœç¤™æ”¯æ´: 'éµç›¤æ“ä½œå’Œè¢å¹•é–±è®€å™¨æ”¯æ´',
    åœ‹éš›åŒ–: 'å¤šèªç³»æ”¯æ´å®Œæ•´',
  },
};
```

### 13.2 å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### æ•ˆèƒ½å•é¡Œ

```typescript
// âŒ å•é¡Œï¼šåœ¨ computed ä¸­é€²è¡Œè¤‡é›œè¨ˆç®—
const computedValue = computed(() => {
  return expensiveCalculation(props.data); // æ¯æ¬¡é‡æ–°è¨ˆç®—
});

// âœ… è§£æ±ºï¼šä½¿ç”¨ memo å„ªåŒ–
const computedValue = computed(() => {
  return useMemo(() => expensiveCalculation(props.data), [props.data]);
});

// âŒ å•é¡Œï¼šä¸å¿…è¦çš„éŸ¿æ‡‰å¼ç‰©ä»¶
const state = reactive({
  largeArray: [], // å¤§å‹é™£åˆ—æœƒå½±éŸ¿æ•ˆèƒ½
  config: {},
});

// âœ… è§£æ±ºï¼šåªå°éœ€è¦éŸ¿æ‡‰å¼çš„è³‡æ–™ä½¿ç”¨ reactive
const largeArray = ref([]); // åªæœ‰é™£åˆ—æœ¬èº«éŸ¿æ‡‰å¼
const state = reactive({
  config: {},
});
```

#### å‹åˆ¥å®‰å…¨å•é¡Œ

```typescript
// âŒ å•é¡Œï¼šä½¿ç”¨ any é¡å‹
const processData = (data: any) => {
  return data.someProperty; // æ²’æœ‰å‹åˆ¥æª¢æŸ¥
};

// âœ… è§£æ±ºï¼šå®šç¾©å…·é«”å‹åˆ¥
interface DataType {
  someProperty: string;
  otherProperty?: number;
}

const processData = (data: DataType): string => {
  return data.someProperty; // æœ‰å‹åˆ¥æª¢æŸ¥
};

// âŒ å•é¡Œï¼šå¿½ç•¥ null/undefined æª¢æŸ¥
const getUserName = (user: User) => {
  return user.profile.name; // å¯èƒ½å‡ºéŒ¯
};

// âœ… è§£æ±ºï¼šå®‰å…¨çš„å±¬æ€§å­˜å–
const getUserName = (user: User): string => {
  return user.profile?.name ?? 'æœªè¨­å®š';
};
```

#### è¨˜æ†¶é«”æ´©æ¼å•é¡Œ

```typescript
// âŒ å•é¡Œï¼šæœªæ¸…ç†äº‹ä»¶ç›£è½å™¨
onMounted(() => {
  window.addEventListener('resize', handleResize);
});

// âœ… è§£æ±ºï¼šåœ¨ unmounted æ™‚æ¸…ç†
onMounted(() => {
  window.addEventListener('resize', handleResize);
});

onUnmounted(() => {
  window.removeEventListener('resize', handleResize);
});

// âŒ å•é¡Œï¼šæœªæ¸…ç†å®šæ™‚å™¨
const timer = setInterval(() => {
  // ä¸€äº›æ“ä½œ
}, 1000);

// âœ… è§£æ±ºï¼šæ¸…ç†å®šæ™‚å™¨
const timer = setInterval(() => {
  // ä¸€äº›æ“ä½œ
}, 1000);

onUnmounted(() => {
  clearInterval(timer);
});
```

---

## 14. é™¤éŒ¯èˆ‡æ•ˆèƒ½å„ªåŒ–è¦ç¯„

### 14.1 é™¤éŒ¯å·¥å…·èˆ‡æŠ€å·§

#### Vue DevTools ä½¿ç”¨

```typescript
// é–‹ç™¼ç’°å¢ƒé™¤éŒ¯è¨­å®š
if (import.meta.env.DEV) {
  // å•Ÿç”¨ Vue DevTools
  window.__VUE_DEVTOOLS_GLOBAL_HOOK__ = window.__VUE_DEVTOOLS_GLOBAL_HOOK__ || {};
  
  // æ•ˆèƒ½è¿½è¹¤
  app.config.performance = true;
}
```

#### ç€è¦½å™¨é™¤éŒ¯æŠ€å·§

```typescript
// é™¤éŒ¯å·¥å…·å‡½å¼
export const debugUtils = {
  // çµ„ä»¶ç‹€æ…‹å¿«ç…§
  takeSnapshot: (componentRef: any) => {
    if (import.meta.env.DEV) {
      console.log('Component Snapshot:', {
        props: componentRef.props,
        data: componentRef.data,
        computed: componentRef.computed,
      });
    }
  },

  // æ•ˆèƒ½æ¸¬é‡
  measurePerformance: (label: string, fn: () => void) => {
    if (import.meta.env.DEV) {
      console.time(label);
      fn();
      console.timeEnd(label);
    } else {
      fn();
    }
  },

  // è¨˜æ†¶é«”ä½¿ç”¨ç›£æ§
  logMemoryUsage: () => {
    if (import.meta.env.DEV && 'memory' in performance) {
      const memory = (performance as any).memory;
      console.log('Memory Usage:', {
        used: `${Math.round(memory.usedJSHeapSize / 1048576)} MB`,
        total: `${Math.round(memory.totalJSHeapSize / 1048576)} MB`,
        limit: `${Math.round(memory.jsHeapSizeLimit / 1048576)} MB`,
      });
    }
  },
};
```

### 14.2 æ•ˆèƒ½å„ªåŒ–ç­–ç•¥

#### è¼‰å…¥æ•ˆèƒ½å„ªåŒ–

```typescript
// è·¯ç”±æ‡¶è¼‰å…¥
const routes = [
  {
    path: '/dashboard',
    component: () => import('@/views/Dashboard.vue'),
  },
  {
    path: '/users',
    component: () => import('@/views/Users/UserList.vue'),
  },
];

// çµ„ä»¶æ‡¶è¼‰å…¥
export default defineAsyncComponent({
  loader: () => import('./HeavyComponent.vue'),
  loadingComponent: LoadingSpinner,
  errorComponent: ErrorDisplay,
  delay: 200,
  timeout: 3000,
});
```

#### æ¸²æŸ“æ•ˆèƒ½å„ªåŒ–

```vue
<!-- ä½¿ç”¨ v-memo å„ªåŒ–åˆ—è¡¨æ¸²æŸ“ -->
<template>
  <div v-for="item in list" :key="item.id" v-memo="[item.id, item.name]">
    <UserCard :user="item" />
  </div>
</template>

<!-- ä½¿ç”¨ KeepAlive å¿«å–çµ„ä»¶ -->
<template>
  <KeepAlive :max="10">
    <component :is="currentComponent" />
  </KeepAlive>
</template>
```

#### è³‡æºå„ªåŒ–

```typescript
// åœ–ç‰‡æ‡¶è¼‰å…¥
export const useImageLazyLoad = () => {
  const imageRef = ref<HTMLImageElement>();
  
  onMounted(() => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting && imageRef.value) {
          const img = imageRef.value;
          img.src = img.dataset.src!;
          observer.unobserve(img);
        }
      });
    });
    
    if (imageRef.value) {
      observer.observe(imageRef.value);
    }
  });
  
  return { imageRef };
};
```

---

## ç¸½çµ

æœ¬å‰ç«¯é–‹ç™¼æŒ‡å¼•æ¶µè“‹äº† Vue 3.x + TypeScript + Tailwind CSS æŠ€è¡“æ£§çš„å®Œæ•´é–‹ç™¼æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

### æ ¸å¿ƒå…§å®¹
1. **å°ˆæ¡ˆçµæ§‹** - æ¨¡çµ„åŒ–çš„ç›®éŒ„çµ„ç¹”å’Œæª”æ¡ˆå‘½åè¦ç¯„
2. **å‘½åè¦ç¯„** - çµ±ä¸€çš„å‘½åæ…£ä¾‹ï¼Œæå‡ç¨‹å¼ç¢¼å¯è®€æ€§
3. **ç¨‹å¼ç¢¼é¢¨æ ¼** - ESLint + Prettier è‡ªå‹•åŒ–ç¨‹å¼ç¢¼å“è³ªæ§åˆ¶
4. **çµ„ä»¶é–‹ç™¼** - Vue 3 SFC çµ„ä»¶è¨­è¨ˆæ¨¡å¼å’Œæœ€ä½³å¯¦å‹™
5. **æ¨£å¼æŒ‡å¼•** - Tailwind CSS ä½¿ç”¨è¦ç¯„å’ŒéŸ¿æ‡‰å¼è¨­è¨ˆ
6. **API æ•´åˆ** - Axios è¨­å®šã€éŒ¯èª¤è™•ç†å’Œè³‡æ–™ç®¡ç†
7. **ç‹€æ…‹ç®¡ç†** - Pinia Store æ¶æ§‹è¨­è¨ˆå’Œæ¨¡çµ„åŒ–ç®¡ç†
8. **å¤šèªç³»** - Vue I18n å®Œæ•´åœ‹éš›åŒ–è§£æ±ºæ–¹æ¡ˆ

### å“è³ªä¿è­‰
9. **æ¸¬è©¦è¦ç¯„** - å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ã€E2E æ¸¬è©¦å®Œæ•´è¦†è“‹
10. **å®‰å…¨è¦ç¯„** - å‰ç«¯å®‰å…¨æœ€ä½³å¯¦å‹™å’Œé˜²è­·æªæ–½
11. **æ•ˆèƒ½å„ªåŒ–** - ç¨‹å¼ç¢¼åˆ†å‰²ã€æ‡¶è¼‰å…¥å’Œå¿«å–ç­–ç•¥
12. **ç„¡éšœç¤™è¨­è¨ˆ** - WCAG æ¨™æº–éµå¾ªå’ŒåŒ…å®¹æ€§è¨­è¨ˆåŸå‰‡

### é–‹ç™¼æµç¨‹
13. **ç‰ˆæœ¬æ§åˆ¶** - Git å·¥ä½œæµç¨‹å’Œç¨‹å¼ç¢¼å¯©æŸ¥è¦ç¯„
14. **å»ºç½®éƒ¨ç½²** - è‡ªå‹•åŒ–å»ºç½®ã€æ¸¬è©¦å’Œéƒ¨ç½²ç®¡é“
15. **ç¨‹å¼ç¢¼å¯©æŸ¥** - å¯©æŸ¥æµç¨‹å’Œå“è³ªæª¢æŸ¥æ¨™æº–
16. **é™¤éŒ¯å„ªåŒ–** - æ•ˆèƒ½ç›£æ§ã€éŒ¯èª¤è¿½è¹¤å’Œé™¤éŒ¯æŠ€å·§

### åœ˜éšŠå”ä½œ
17. **é–‹ç™¼å·¥å…·** - çµ±ä¸€çš„é–‹ç™¼ç’°å¢ƒå’Œå·¥å…·éˆè¨­å®š
18. **åœ˜éšŠæºé€š** - å”ä½œæµç¨‹ã€æ–‡ä»¶æ’°å¯«å’ŒçŸ¥è­˜åˆ†äº«

### æ‡‰ç”¨å»ºè­°
- å°ˆæ¡ˆå•Ÿå‹•æ™‚åƒè€ƒ **å°ˆæ¡ˆçµæ§‹** å’Œ **å‘½åè¦ç¯„**
- é–‹ç™¼éç¨‹ä¸­éµå¾ª **ç¨‹å¼ç¢¼é¢¨æ ¼** å’Œ **çµ„ä»¶é–‹ç™¼** æŒ‡å¼•
- ç¢ºä¿ **å®‰å…¨æ€§** å’Œ **ç„¡éšœç¤™æ€§** è¦æ±‚
- æŒçºŒé€²è¡Œ **æ•ˆèƒ½å„ªåŒ–** å’Œ **æ¸¬è©¦è¦†è“‹**
- åœ˜éšŠå”ä½œæ¡ç”¨ **ç‰ˆæœ¬æ§åˆ¶** å’Œ **ç¨‹å¼ç¢¼å¯©æŸ¥** æµç¨‹

æœ¬æŒ‡å¼•å°‡éš¨è‘—æŠ€è¡“ç™¼å±•å’Œå°ˆæ¡ˆéœ€æ±‚æŒçºŒæ›´æ–°ï¼Œç¢ºä¿é–‹ç™¼åœ˜éšŠå§‹çµ‚æ¡ç”¨æœ€ä½³å¯¦å‹™é€²è¡Œå‰ç«¯é–‹ç™¼ã€‚

---

## é™„éŒ„

### A. å¸¸ç”¨ VSCode æ“´å……å¥—ä»¶æ¨è–¦

```json
{
  "recommendations": [
    // Vue ç›¸é—œ
    "vue.volar",
    "vue.vscode-typescript-vue-plugin",
    
    // TypeScript
    "ms-typescript.vscode-typescript",
    
    // ç¨‹å¼ç¢¼å“è³ª
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "ms-vscode.vscode-eslint",
    
    // æ¨£å¼ç›¸é—œ
    "bradlc.vscode-tailwindcss",
    "stylelint.vscode-stylelint",
    
    // Git
    "eamodio.gitlens",
    "mhutchie.git-graph",
    
    // æ¸¬è©¦
    "ms-vscode.test-adapter-converter",
    "hbenl.vscode-test-explorer",
    
    // é–‹ç™¼å·¥å…·
    "ms-vscode.vscode-json",
    "redhat.vscode-yaml",
    "ms-vscode.live-server",
    
    // ç„¡éšœç¤™æ€§
    "deque-systems.vscode-axe-linter",
    
    // å…¶ä»–å¯¦ç”¨å·¥å…·
    "christian-kohler.path-intellisense",
    "formulahendry.auto-rename-tag",
    "ms-vscode.bracket-pair-colorizer"
  ]
}
```

### B. æ•ˆèƒ½å„ªåŒ–æª¢æŸ¥æ¸…å–®

#### ğŸš€ è¼‰å…¥æ•ˆèƒ½
- [ ] ä½¿ç”¨ç¨‹å¼ç¢¼åˆ†å‰² (Code Splitting)
- [ ] å¯¦ä½œè·¯ç”±æ‡¶è¼‰å…¥
- [ ] å„ªåŒ–åœ–ç‰‡æ ¼å¼å’Œå¤§å°
- [ ] å•Ÿç”¨ Gzip/Brotli å£“ç¸®
- [ ] ä½¿ç”¨ CDN åŠ é€Ÿéœæ…‹è³‡æº
- [ ] æœ€å°åŒ– JavaScript å’Œ CSS æª”æ¡ˆ
- [ ] ç§»é™¤æœªä½¿ç”¨çš„ç¨‹å¼ç¢¼

#### âš¡ åŸ·è¡Œæ•ˆèƒ½
- [ ] é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
- [ ] ä½¿ç”¨ v-memo å„ªåŒ–åˆ—è¡¨
- [ ] å¯¦ä½œè™›æ“¬æ»¾å‹• (å¤§æ•¸æ“šåˆ—è¡¨)
- [ ] ä½¿ç”¨ Web Workers è™•ç†å¯†é›†é‹ç®—
- [ ] å„ªåŒ–ç‹€æ…‹ç®¡ç†çµæ§‹
- [ ] æ¸›å°‘ DOM æ“ä½œæ¬¡æ•¸

#### ğŸ¯ ä½¿ç”¨è€…é«”é©—
- [ ] å¯¦ä½œè¼‰å…¥æŒ‡ç¤ºå™¨
- [ ] æä¾›é›¢ç·šæ”¯æ´ (PWA)
- [ ] å„ªåŒ–é¦–å±è¼‰å…¥æ™‚é–“
- [ ] å¯¦ä½œé è¼‰å…¥ç­–ç•¥
- [ ] æä¾›é©ç•¶çš„éŒ¯èª¤è™•ç†
- [ ] æ”¯æ´éµç›¤å°èˆª

### C. å®‰å…¨æª¢æŸ¥æ¸…å–®

#### ğŸ”’ è¼¸å…¥å®‰å…¨
- [ ] æ‰€æœ‰ä½¿ç”¨è€…è¼¸å…¥éƒ½ç¶“éé©—è­‰
- [ ] å¯¦ä½œ XSS é˜²è­·
- [ ] é¿å… innerHTML ç›´æ¥è³¦å€¼
- [ ] ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢é˜²æ­¢æ³¨å…¥
- [ ] æª”æ¡ˆä¸Šå‚³é¡å‹é™åˆ¶
- [ ] å¯¦ä½œ CSRF ä¿è­·

#### ğŸ›¡ï¸ è³‡æ–™ä¿è­·
- [ ] æ•æ„Ÿè³‡æ–™åŠ å¯†å„²å­˜
- [ ] ä½¿ç”¨ HTTPS å‚³è¼¸
- [ ] å¯¦ä½œé©ç•¶çš„èªè­‰æ©Ÿåˆ¶
- [ ] Token éæœŸè™•ç†
- [ ] è¨˜éŒ„å®‰å…¨äº‹ä»¶
- [ ] å®šæœŸå®‰å…¨æƒæ

#### ğŸ” å­˜å–æ§åˆ¶
- [ ] å¯¦ä½œè§’è‰²æ¬Šé™ç®¡ç†
- [ ] è·¯ç”±æ¬Šé™æª¢æŸ¥
- [ ] API æ¬Šé™é©—è­‰
- [ ] æœƒè©±ç®¡ç†å®‰å…¨
- [ ] æœ€å°æ¬Šé™åŸå‰‡
- [ ] å®šæœŸæ¬Šé™å¯©æŸ¥

### D. ç„¡éšœç¤™æª¢æŸ¥æ¸…å–®

#### â™¿ WCAG 2.1 AA åˆè¦
- [ ] æ‰€æœ‰åœ–ç‰‡éƒ½æœ‰é©ç•¶çš„ alt æ–‡å­—
- [ ] è¡¨å–®æ¬„ä½éƒ½æœ‰æ¨™ç±¤
- [ ] è‰²å½©å°æ¯”åº¦ç¬¦åˆ 4.5:1 è¦æ±‚
- [ ] æ”¯æ´éµç›¤å°èˆª
- [ ] æä¾›ç„¦é»æŒ‡ç¤ºå™¨
- [ ] ä½¿ç”¨èªæ„åŒ– HTML æ¨™ç±¤

#### ğŸ¯ ä½¿ç”¨è€…é«”é©—
- [ ] æ”¯æ´è¢å¹•é–±è®€å™¨
- [ ] æä¾›è·³éé€£çµ
- [ ] éŒ¯èª¤è¨Šæ¯æ¸…æ¥šæ˜ç¢º
- [ ] æ”¯æ´ç¸®æ”¾è‡³ 200%
- [ ] å‹•ä½œä¸ä¾è³´é¡è‰²
- [ ] æä¾›æ›¿ä»£è¼¸å…¥æ–¹å¼

### E. ç–‘é›£æ’è§£æŒ‡å—

#### å¸¸è¦‹ç·¨è­¯éŒ¯èª¤
1. **TypeScript å‹åˆ¥éŒ¯èª¤**
   - æª¢æŸ¥å‹åˆ¥å®šç¾©æª”æ¡ˆ
   - ç¢ºèª import/export èªæ³•
   - æ›´æ–° @types å¥—ä»¶

2. **Vue çµ„ä»¶æ¸²æŸ“å•é¡Œ**
   - æª¢æŸ¥éŸ¿æ‡‰å¼è³‡æ–™è¨­å®š
   - ç¢ºèªç”Ÿå‘½é€±æœŸä½¿ç”¨
   - æª¢æŸ¥ props å‹åˆ¥å®šç¾©

3. **æ¨£å¼è¼‰å…¥å•é¡Œ**
   - ç¢ºèª CSS æª”æ¡ˆè·¯å¾‘
   - æª¢æŸ¥ Tailwind è¨­å®š
   - é©—è­‰ scoped æ¨£å¼èªæ³•

#### æ•ˆèƒ½å•é¡Œè¨ºæ–·
1. **è¼‰å…¥ç·©æ…¢**
   - ä½¿ç”¨ Lighthouse åˆ†æ
   - æª¢æŸ¥ bundle å¤§å°
   - åˆ†æç¶²è·¯è«‹æ±‚

2. **è¨˜æ†¶é«”æ´©æ¼**
   - æª¢æŸ¥äº‹ä»¶ç›£è½å™¨æ¸…ç†
   - ç¢ºèªå®šæ™‚å™¨æ¸…é™¤
   - ç›£æ§çµ„ä»¶éŠ·æ¯€

3. **æ¸²æŸ“æ•ˆèƒ½å·®**
   - ä½¿ç”¨ Vue DevTools åˆ†æ
   - æª¢æŸ¥ä¸å¿…è¦çš„é‡æ¸²æŸ“
   - å„ªåŒ–è¨ˆç®—å±¬æ€§

---

## æ–‡ä»¶è®Šæ›´è¨˜éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | è®Šæ›´å…§å®¹ | ä½œè€… |
|------|------|----------|------|
| 1.0.0 | 2025-08-11 | åˆå§‹ç‰ˆæœ¬å»ºç«‹ | é–‹ç™¼åœ˜éšŠ |
| 1.1.0 | 2025-08-29 | æ–°å¢å®‰å…¨æ€§ã€æ•ˆèƒ½å„ªåŒ–ã€ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„ | é–‹ç™¼åœ˜éšŠ |
| 1.1.1 | 2025-08-29 | è£œå……ç‰ˆæœ¬æ§åˆ¶ã€å·¥å…·è¨­å®šã€åœ˜éšŠå”ä½œè¦ç¯„ | é–‹ç™¼åœ˜éšŠ |

---

**ç‰ˆæ¬Šè²æ˜**: æœ¬æ–‡ä»¶ç‚ºå…§éƒ¨é–‹ç™¼æŒ‡å¼•ï¼Œåƒ…ä¾›åœ˜éšŠæˆå“¡åƒè€ƒä½¿ç”¨ã€‚

å¦‚æœ‰ä»»ä½•ç–‘å•æˆ–å»ºè­°ï¼Œè«‹èˆ‡æŠ€è¡“æ¶æ§‹åœ˜éšŠè¯ç¹«ã€‚

---
